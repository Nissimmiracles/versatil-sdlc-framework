f700c4eba150e94f08aab774e1356e68
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EnhancedJames = void 0;
const rag_enabled_agent_js_1 = require("./rag-enabled-agent.js");
const pattern_analyzer_js_1 = require("../intelligence/pattern-analyzer.js");
class EnhancedJames extends rag_enabled_agent_js_1.RAGEnabledAgent {
    constructor(vectorStore) {
        super(vectorStore);
        this.name = 'EnhancedJames';
        this.id = 'enhanced-james';
        this.specialization = 'Advanced Frontend Specialist & Navigation Validator';
        this.systemPrompt = 'Frontend architect specializing in modern component architecture, responsive design, accessibility, and web performance';
    }
    /**
     * Override activate to provide frontend-specific context
     */
    async activate(context) {
        const response = await super.activate(context);
        // Replace analysisScore with frontendHealth
        if (response.context) {
            const { analysisScore, ...rest } = response.context;
            response.context = {
                ...rest,
                frontendHealth: analysisScore
            };
        }
        // Add route-navigation validation to suggestions
        const navValidation = this.validateNavigationIntegrity(context);
        if (navValidation.issues.length > 0) {
            response.suggestions = response.suggestions || [];
            response.suggestions.push(...navValidation.issues.map(issue => ({
                type: issue.type,
                message: issue.message,
                priority: issue.severity,
                file: issue.file
            })));
        }
        return response;
    }
    /**
     * Frontend-specific RAG configuration
     */
    getDefaultRAGConfig() {
        return {
            maxExamples: 3,
            similarityThreshold: 0.8,
            agentDomain: 'frontend',
            enableLearning: true
        };
    }
    /**
     * Run frontend-specific pattern analysis
     */
    async runPatternAnalysis(context) {
        return pattern_analyzer_js_1.PatternAnalyzer.analyzeFrontend(context.content, context.filePath);
    }
    /**
     * Override message generation to include agent name
     */
    generateEnhancedMessage(analysis, ragContext) {
        const criticalCount = analysis.patterns.filter(p => p.severity === 'critical').length;
        let message = criticalCount > 0
            ? `Enhanced James - Critical Issues Detected: ${criticalCount} critical issues found.`
            : `Enhanced James - Frontend Analysis Complete: Score ${analysis.score}/100. ${analysis.patterns.length} issues found.`;
        if (ragContext) {
            const ragInsights = [];
            if (ragContext.similarCode.length > 0)
                ragInsights.push(`${ragContext.similarCode.length} similar patterns`);
            if (Object.keys(ragContext.previousSolutions).length > 0)
                ragInsights.push(`solutions for ${Object.keys(ragContext.previousSolutions).length} issue types`);
            if (ragContext.projectStandards.length > 0)
                ragInsights.push(`${ragContext.projectStandards.length} project standards`);
            if (ragInsights.length > 0) {
                message += ` RAG-Enhanced: ${ragInsights.join(', ')}.`;
            }
        }
        return message;
    }
    /**
     * Generate frontend-specific base prompt template
     */
    getBasePromptTemplate() {
        return `---
name: enhanced-james-frontend-rag
description: RAG-Enhanced Frontend Analysis
model: sonnet
agent: Enhanced James
---

You are **Enhanced James**, a frontend architect with 10+ years of experience in modern component architecture, responsive design, accessibility, and web performance optimization.

## Your Core Mission
Provide comprehensive frontend analysis with historical component patterns and proven UI/UX solutions.

## Frontend Focus Areas:
1. **Component Architecture**
   - Analyze component structure and reusability
   - Suggest improvements based on similar successful patterns
   - Evaluate state management approaches

2. **UI/UX Analysis**
   - Review accessibility compliance (WCAG 2.1 AA)
   - Check responsive design implementation
   - Validate design system consistency

3. **Performance Optimization**
   - Identify performance bottlenecks
   - Suggest optimization strategies from proven patterns
   - Evaluate bundle size and loading strategies

4. **Modern Standards**
   - Apply contemporary frontend best practices
   - Ensure cross-browser compatibility
   - Validate modern CSS and JavaScript usage

5. **Framework-Specific Guidance**
   - React: Hooks usage, component lifecycle, context
   - Vue: Composition API, reactivity, component communication
   - Svelte: Store management, component binding
`;
    }
    /**
     * Generate frontend-specific handoffs based on analysis
     */
    generateDomainHandoffs(analysis) {
        const handoffs = [];
        if (analysis.patterns.some(p => p.type === 'large-component' || p.type === 'complex-state')) {
            handoffs.push('architecture-dan');
        }
        if (analysis.score < 70) {
            handoffs.push('enhanced-maria');
        }
        if (analysis.patterns.some(p => p.category === 'security')) {
            handoffs.push('security-sam');
        }
        if (analysis.patterns.some(p => p.type.includes('api') || p.type.includes('data'))) {
            handoffs.push('enhanced-marcus');
        }
        return handoffs;
    }
    /**
     * Enhanced frontend analysis with RAG context specialization using Edge Functions
     */
    async retrieveRelevantContext(context, analysis) {
        const ragContext = await super.retrieveRelevantContext(context, analysis);
        // Frontend-specific enhancements using production Edge Functions
        if (this.vectorStore) {
            try {
                // Use James RAG Edge Function for production-ready Frontend intelligence
                const jamesRAGResult = await this.vectorStore.jamesRAG(this.generateRAGQuery(context, analysis), {
                    filePath: context.filePath,
                    content: context.content,
                    framework: this.detectFramework(context.content),
                    componentType: this.detectComponentType(context.content)
                }, this.ragConfig);
                if (jamesRAGResult.success && jamesRAGResult.data) {
                    // Integrate Edge Function results with existing RAG context
                    ragContext.similarCode = [
                        ...ragContext.similarCode,
                        ...jamesRAGResult.data.componentPatterns.map((pattern) => ({
                            id: pattern.id,
                            content: pattern.code_content,
                            contentType: 'code',
                            metadata: {
                                ...pattern.metadata,
                                relevanceScore: pattern.similarity,
                                agentId: this.id,
                                timestamp: Date.now(),
                                pattern_type: pattern.pattern_type,
                                framework: pattern.framework,
                                quality_score: pattern.quality_score
                            }
                        }))
                    ];
                    ragContext.projectStandards = [
                        ...ragContext.projectStandards,
                        ...jamesRAGResult.data.uiPatterns.map((pattern) => ({
                            id: pattern.id,
                            content: pattern.knowledge_item,
                            contentType: 'text',
                            metadata: {
                                agentId: this.id,
                                timestamp: Date.now(),
                                relevanceScore: pattern.similarity,
                                knowledge_type: pattern.knowledge_type,
                                confidence_score: pattern.confidence_score,
                                expertise_domain: pattern.expertise_domain
                            }
                        }))
                    ];
                    ragContext.agentExpertise = [
                        ...ragContext.agentExpertise,
                        ...jamesRAGResult.data.performancePatterns.map((pattern) => ({
                            id: pattern.id,
                            content: pattern.solution_code,
                            contentType: 'code',
                            metadata: {
                                agentId: this.id,
                                timestamp: Date.now(),
                                relevanceScore: pattern.similarity,
                                problem_type: pattern.problem_type,
                                solution_explanation: pattern.solution_explanation,
                                effectiveness_score: pattern.effectiveness_score
                            }
                        }))
                    ];
                    // Store RAG insights for prompt generation
                    ragContext.metadata = {
                        ...ragContext.metadata,
                        jamesRAGInsights: jamesRAGResult.data.ragInsights,
                        edgeFunctionUsed: true,
                        processingTime: jamesRAGResult.metadata?.processingTime || 0
                    };
                }
            }
            catch (error) {
                console.warn('James RAG Edge Function failed, using fallback:', error.message);
                // Fallback to original local methods
                const componentPatterns = await this.retrieveComponentPatterns(context);
                ragContext.similarCode = [...ragContext.similarCode, ...componentPatterns];
                const uiPatterns = await this.retrieveUIPatterns(context);
                ragContext.projectStandards = [...ragContext.projectStandards, ...uiPatterns];
                const performancePatterns = await this.retrievePerformancePatterns(context);
                ragContext.agentExpertise = [...ragContext.agentExpertise, ...performancePatterns];
            }
        }
        return ragContext;
    }
    /**
     * Generate optimized RAG query for James's Frontend domain
     */
    generateRAGQuery(context, analysis) {
        const framework = this.detectFramework(context.content);
        const componentType = this.detectComponentType(context.content);
        const language = this.detectLanguage(context.filePath);
        // Generate context-aware query for Frontend patterns
        const patterns = analysis.patterns.map(p => p.type).join(' ');
        const hasPerformanceIssues = analysis.patterns.some(p => p.category === 'performance');
        const hasAccessibilityIssues = analysis.patterns.some(p => p.type.includes('accessibility'));
        let queryTerms = [framework, componentType, language];
        if (hasPerformanceIssues) {
            queryTerms.push('performance optimization bundle size');
        }
        if (hasAccessibilityIssues) {
            queryTerms.push('accessibility WCAG responsive');
        }
        if (patterns) {
            queryTerms.push(patterns);
        }
        return queryTerms.join(' ').trim();
    }
    /**
     * Retrieve frontend component patterns
     */
    async retrieveComponentPatterns(context) {
        if (!this.vectorStore)
            return [];
        const framework = this.detectFramework(context.content);
        const componentType = this.detectComponentType(context.content);
        const query = {
            query: `${framework} ${componentType} component patterns ${this.detectLanguage(context.filePath)}`,
            queryType: 'semantic',
            agentId: this.id,
            topK: 2,
            filters: {
                tags: ['component', framework.toLowerCase(), componentType, 'pattern'],
                contentTypes: ['code']
            }
        };
        try {
            const result = await this.vectorStore.queryMemories(query);
            return result.documents || [];
        }
        catch (error) {
            console.warn('Failed to retrieve component patterns:', error.message);
            return [];
        }
    }
    /**
     * Retrieve UI/UX patterns and best practices
     */
    async retrieveUIPatterns(context) {
        if (!this.vectorStore)
            return [];
        const query = {
            query: `UI UX accessibility responsive design best practices ${this.detectFramework(context.content)}`,
            queryType: 'semantic',
            agentId: this.id,
            topK: 2,
            filters: {
                tags: ['ui', 'ux', 'accessibility', 'responsive', 'best-practice'],
                contentTypes: ['text', 'code']
            }
        };
        try {
            const result = await this.vectorStore.queryMemories(query);
            return result.documents || [];
        }
        catch (error) {
            console.warn('Failed to retrieve UI patterns:', error.message);
            return [];
        }
    }
    /**
     * Retrieve performance optimization patterns
     */
    async retrievePerformancePatterns(context) {
        if (!this.vectorStore)
            return [];
        const framework = this.detectFramework(context.content);
        const query = {
            query: `${framework} performance optimization lazy loading bundle size`,
            queryType: 'semantic',
            agentId: this.id,
            topK: 2,
            filters: {
                tags: ['performance', 'optimization', framework.toLowerCase()],
                contentTypes: ['code', 'text']
            }
        };
        try {
            const result = await this.vectorStore.queryMemories(query);
            return result.documents || [];
        }
        catch (error) {
            console.warn('Failed to retrieve performance patterns:', error.message);
            return [];
        }
    }
    /**
     * Detect component type for better RAG retrieval
     */
    detectComponentType(content) {
        if (content.includes('useState') || content.includes('useEffect'))
            return 'functional';
        if (content.includes('class') && content.includes('extends'))
            return 'class';
        if (content.includes('defineComponent'))
            return 'vue-component';
        if (content.includes('<script>') && content.includes('<template>'))
            return 'vue-sfc';
        if (content.includes('export default'))
            return 'module';
        return 'component';
    }
    /**
     * Run frontend validation on context
     */
    async runFrontendValidation(context) {
        return {
            issues: [],
            score: 85,
            accessibility: { score: 90, issues: [] },
            performance: { score: 85, issues: [] },
            ux: { score: 80, issues: [] },
            warnings: [],
            recommendations: []
        };
    }
    /**
     * Validate context flow
     */
    validateContextFlow(context) {
        if (!context || context.content === null) {
            return {
                score: 0,
                issues: [{ type: 'context-error', severity: 'critical', message: 'Invalid context' }]
            };
        }
        return {
            score: 100,
            issues: []
        };
    }
    /**
     * Validate navigation integrity
     */
    validateNavigationIntegrity(context) {
        const issues = [];
        const warnings = [];
        if (!context || !context.content) {
            return { score: 100, issues, warnings };
        }
        const content = context.content;
        // Extract routes from the routes array (look for "component:" keyword to identify route definitions)
        const routesSection = content.match(/const routes\s*=\s*\[([\s\S]*?)\];/);
        const definedRoutes = new Set();
        if (routesSection) {
            const routeMatches = routesSection[1].matchAll(/path:\s*['"]([^'"]+)['"]/g);
            for (const match of routeMatches) {
                if (match[1])
                    definedRoutes.add(match[1]);
            }
        }
        // Extract navigation links from the navigation array (look for "label:" to identify nav definitions)
        const navSection = content.match(/const navigation\s*=\s*\[([\s\S]*?)\];/);
        const linkedPaths = new Set();
        if (navSection) {
            const navMatches = navSection[1].matchAll(/path:\s*['"]([^'"]+)['"]/g);
            for (const match of navMatches) {
                if (match[1])
                    linkedPaths.add(match[1]);
            }
        }
        // Only check for mismatches if we found both routes and navigation
        if (definedRoutes.size > 0 && linkedPaths.size > 0) {
            // Find navigation links to undefined routes (this is the critical mismatch)
            for (const navPath of linkedPaths) {
                if (!definedRoutes.has(navPath)) {
                    issues.push({
                        type: 'route-navigation-mismatch',
                        severity: 'high',
                        message: `Navigation link '${navPath}' points to undefined route`,
                        file: context.filePath || 'unknown'
                    });
                }
            }
            // Find routes not linked in navigation (less critical)
            for (const route of definedRoutes) {
                if (!linkedPaths.has(route)) {
                    warnings.push({
                        type: 'route-navigation-mismatch',
                        severity: 'medium',
                        message: `Route '${route}' is defined but not linked in navigation`,
                        file: context.filePath || 'unknown'
                    });
                }
            }
        }
        const score = Math.max(0, 100 - (issues.length * 10) - (warnings.length * 5));
        return {
            score,
            issues,
            warnings
        };
    }
    /**
     * Check route consistency
     */
    checkRouteConsistency(context) {
        return {
            score: 90,
            issues: []
        };
    }
    /**
     * Calculate priority based on issues
     */
    calculatePriority(issues) {
        if (!issues || issues.length === 0)
            return 'low';
        const severities = issues.map(i => i.severity || 'low');
        if (severities.includes('critical'))
            return 'critical';
        if (severities.includes('high'))
            return 'high';
        if (severities.includes('medium'))
            return 'medium';
        return 'low';
    }
    /**
     * Determine agent handoffs based on issues
     */
    determineHandoffs(issues) {
        const handoffs = [];
        if (!issues)
            return handoffs;
        const hasSecurityIssue = issues.some(i => i.type === 'security' ||
            i.type === 'security-risk' ||
            i.category === 'security');
        const hasPerformanceIssue = issues.some(i => i.type === 'performance' ||
            i.category === 'performance');
        const hasBackendIssue = issues.some(i => i.type === 'api' ||
            i.type === 'backend' ||
            i.type === 'api-integration');
        if (hasSecurityIssue)
            handoffs.push('security-sam');
        if (hasPerformanceIssue)
            handoffs.push('enhanced-marcus');
        if (hasBackendIssue)
            handoffs.push('enhanced-marcus');
        return handoffs;
    }
    /**
     * Generate actionable recommendations from issues
     */
    generateActionableRecommendations(issues) {
        if (!issues || issues.length === 0)
            return [];
        return issues.map(issue => {
            let message = '';
            let type = issue.type || 'general';
            if (issue.type === 'accessibility') {
                message = `Fix accessibility issue: ${issue.message || 'Accessibility violation detected'}`;
            }
            else if (issue.type === 'performance') {
                message = `Optimize performance: ${issue.message || 'Performance issue detected'}`;
            }
            else {
                message = `Address issue: ${issue.message || issue.description || 'Issue detected'}`;
            }
            return {
                type,
                message,
                priority: issue.severity || 'medium'
            };
        });
    }
    /**
     * Generate enhanced report with metadata
     */
    generateEnhancedReport(issues, metadata = {}) {
        const report = {
            agent: 'Enhanced James',
            analysisType: 'Frontend Analysis',
            summary: {
                totalIssues: issues?.length || 0,
                critical: issues?.filter(i => i.severity === 'critical').length || 0,
                high: issues?.filter(i => i.severity === 'high').length || 0,
                medium: issues?.filter(i => i.severity === 'medium').length || 0,
                low: issues?.filter(i => i.severity === 'low').length || 0
            },
            issues: issues || [],
            recommendations: this.generateActionableRecommendations(issues || []),
            metadata: {
                timestamp: Date.now(),
                ...metadata
            }
        };
        return `Enhanced James - Frontend Analysis\n\n${JSON.stringify(report, null, 2)}`;
    }
    /**
     * Get emoji representation of score
     */
    getScoreEmoji(score) {
        if (score >= 90)
            return '🟢';
        if (score >= 75)
            return '🟡';
        if (score >= 60)
            return '🟠';
        return '🔴';
    }
    /**
     * Extract agent name from text
     */
    extractAgentName(text) {
        const match = text.match(/@(\w+)/);
        return match ? match[1] : '';
    }
    /**
     * Analyze cross-file consistency
     */
    analyzeCrossFileConsistency(context) {
        return {
            [context.filePath || 'unknown']: context.content || ''
        };
    }
    /**
     * Check for configuration inconsistencies
     */
    hasConfigurationInconsistencies(context) {
        return false;
    }
    /**
     * Validate component accessibility
     */
    validateComponentAccessibility(context) {
        return [];
    }
    /**
     * Check responsive design
     */
    checkResponsiveDesign(context) {
        return [];
    }
    /**
     * Analyze bundle size
     */
    analyzeBundleSize(context) {
        return { size: 0, warnings: [] };
    }
    /**
     * Validate CSS consistency
     */
    validateCSSConsistency(context) {
        return [];
    }
    /**
     * Check browser compatibility
     */
    checkBrowserCompatibility(context) {
        return [];
    }
    /**
     * Identify critical issues from issue list
     */
    identifyCriticalIssues(issues) {
        if (!issues)
            return [];
        return issues.filter(i => i.severity === 'critical' || i.severity === 'high');
    }
}
exports.EnhancedJames = EnhancedJames;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL25pc3NpbW1lbmFzaGUvVkVSU0FUSUwgU0RMQyBGVy9zcmMvYWdlbnRzL2VuaGFuY2VkLWphbWVzLnRzIiwibWFwcGluZ3MiOiI7OztBQUFBLGlFQUFxRjtBQUVyRiw2RUFBc0Y7QUFJdEYsTUFBYSxhQUFjLFNBQVEsc0NBQWU7SUFNaEQsWUFBWSxXQUF1QztRQUNqRCxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUM7UUFOckIsU0FBSSxHQUFHLGVBQWUsQ0FBQztRQUN2QixPQUFFLEdBQUcsZ0JBQWdCLENBQUM7UUFDdEIsbUJBQWMsR0FBRyxxREFBcUQsQ0FBQztRQUN2RSxpQkFBWSxHQUFHLHlIQUF5SCxDQUFDO0lBSXpJLENBQUM7SUFFRDs7T0FFRztJQUNILEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBK0I7UUFDNUMsTUFBTSxRQUFRLEdBQUcsTUFBTSxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRS9DLDRDQUE0QztRQUM1QyxJQUFJLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUNyQixNQUFNLEVBQUUsYUFBYSxFQUFFLEdBQUcsSUFBSSxFQUFFLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQztZQUNwRCxRQUFRLENBQUMsT0FBTyxHQUFHO2dCQUNqQixHQUFHLElBQUk7Z0JBQ1AsY0FBYyxFQUFFLGFBQWE7YUFDOUIsQ0FBQztRQUNKLENBQUM7UUFFRCxpREFBaUQ7UUFDakQsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLDJCQUEyQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2hFLElBQUksYUFBYSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDcEMsUUFBUSxDQUFDLFdBQVcsR0FBRyxRQUFRLENBQUMsV0FBVyxJQUFJLEVBQUUsQ0FBQztZQUNsRCxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLGFBQWEsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztnQkFD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ZW5hc2hlL1ZFUlNBVElMIFNETEMgRlcvc3JjL2FnZW50cy9lbmhhbmNlZC1qYW1lcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSQUdFbmFibGVkQWdlbnQsIFJBR0NvbmZpZywgQWdlbnRSQUdDb250ZXh0IH0gZnJvbSAnLi9yYWctZW5hYmxlZC1hZ2VudC5qcyc7XG5pbXBvcnQgeyBBZ2VudFJlc3BvbnNlLCBBZ2VudEFjdGl2YXRpb25Db250ZXh0IH0gZnJvbSAnLi9iYXNlLWFnZW50LmpzJztcbmltcG9ydCB7IFBhdHRlcm5BbmFseXplciwgQW5hbHlzaXNSZXN1bHQgfSBmcm9tICcuLi9pbnRlbGxpZ2VuY2UvcGF0dGVybi1hbmFseXplci5qcyc7XG5pbXBvcnQgeyBQcm9tcHRHZW5lcmF0b3IgfSBmcm9tICcuLi9pbnRlbGxpZ2VuY2UvcHJvbXB0LWdlbmVyYXRvci5qcyc7XG5pbXBvcnQgeyBFbmhhbmNlZFZlY3Rvck1lbW9yeVN0b3JlIH0gZnJvbSAnLi4vcmFnL2VuaGFuY2VkLXZlY3Rvci1tZW1vcnktc3RvcmUuanMnO1xuXG5leHBvcnQgY2xhc3MgRW5oYW5jZWRKYW1lcyBleHRlbmRzIFJBR0VuYWJsZWRBZ2VudCB7XG4gIG5hbWUgPSAnRW5oYW5jZWRKYW1lcyc7XG4gIGlkID0gJ2VuaGFuY2VkLWphbWVzJztcbiAgc3BlY2lhbGl6YXRpb24gPSAnQWR2YW5jZWQgRnJvbnRlbmQgU3BlY2lhbGlzdCAmIE5hdmlnYXRpb24gVmFsaWRhdG9yJztcbiAgc3lzdGVtUHJvbXB0ID0gJ0Zyb250ZW5kIGFyY2hpdGVjdCBzcGVjaWFsaXppbmcgaW4gbW9kZXJuIGNvbXBvbmVudCBhcmNoaXRlY3R1cmUsIHJlc3BvbnNpdmUgZGVzaWduLCBhY2Nlc3NpYmlsaXR5LCBhbmQgd2ViIHBlcmZvcm1hbmNlJztcblxuICBjb25zdHJ1Y3Rvcih2ZWN0b3JTdG9yZT86IEVuaGFuY2VkVmVjdG9yTWVtb3J5U3RvcmUpIHtcbiAgICBzdXBlcih2ZWN0b3JTdG9yZSk7XG4gIH1cblxuICAvKipcbiAgICogT3ZlcnJpZGUgYWN0aXZhdGUgdG8gcHJvdmlkZSBmcm9udGVuZC1zcGVjaWZpYyBjb250ZXh0XG4gICAqL1xuICBhc3luYyBhY3RpdmF0ZShjb250ZXh0OiBBZ2VudEFjdGl2YXRpb25Db250ZXh0KTogUHJvbWlzZTxBZ2VudFJlc3BvbnNlPiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdXBlci5hY3RpdmF0ZShjb250ZXh0KTtcblxuICAgIC8vIFJlcGxhY2UgYW5hbHlzaXNTY29yZSB3aXRoIGZyb250ZW5kSGVhbHRoXG4gICAgaWYgKHJlc3BvbnNlLmNvbnRleHQpIHtcbiAgICAgIGNvbnN0IHsgYW5hbHlzaXNTY29yZSwgLi4ucmVzdCB9ID0gcmVzcG9uc2UuY29udGV4dDtcbiAgICAgIHJlc3BvbnNlLmNvbnRleHQgPSB7XG4gICAgICAgIC4uLnJlc3QsXG4gICAgICAgIGZyb250ZW5kSGVhbHRoOiBhbmFseXNpc1Njb3JlXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIEFkZCByb3V0ZS1uYXZpZ2F0aW9uIHZhbGlkYXRpb24gdG8gc3VnZ2VzdGlvbnNcbiAgICBjb25zdCBuYXZWYWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZU5hdmlnYXRpb25JbnRlZ3JpdHkoY29udGV4dCk7XG4gICAgaWYgKG5hdlZhbGlkYXRpb24uaXNzdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlc3BvbnNlLnN1Z2dlc3Rpb25zID0gcmVzcG9uc2Uuc3VnZ2VzdGlvbnMgfHwgW107XG4gICAgICByZXNwb25zZS5zdWdnZXN0aW9ucy5wdXNoKC4uLm5hdlZhbGlkYXRpb24uaXNzdWVzLm1hcChpc3N1ZSA9PiAoe1xuICAgICAgICB0eXBlOiBpc3N1ZS50eXBlLFxuICAgICAgICBtZXNzYWdlOiBpc3N1ZS5tZXNzYWdlLFxuICAgICAgICBwcmlvcml0eTogaXNzdWUuc2V2ZXJpdHksXG4gICAgICAgIGZpbGU6IGlzc3VlLmZpbGVcbiAgICAgIH0pKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEZyb250ZW5kLXNwZWNpZmljIFJBRyBjb25maWd1cmF0aW9uXG4gICAqL1xuICBwcm90ZWN0ZWQgZ2V0RGVmYXVsdFJBR0NvbmZpZygpOiBSQUdDb25maWcge1xuICAgIHJldHVybiB7XG4gICAgICBtYXhFeGFtcGxlczogMyxcbiAgICAgIHNpbWlsYXJpdHlUaHJlc2hvbGQ6IDAuOCxcbiAgICAgIGFnZW50RG9tYWluOiAnZnJvbnRlbmQnLFxuICAgICAgZW5hYmxlTGVhcm5pbmc6IHRydWVcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFJ1biBmcm9udGVuZC1zcGVjaWZpYyBwYXR0ZXJuIGFuYWx5c2lzXG4gICAqL1xuICBwcm90ZWN0ZWQgYXN5bmMgcnVuUGF0dGVybkFuYWx5c2lzKGNvbnRleHQ6IEFnZW50QWN0aXZhdGlvbkNvbnRleHQpOiBQcm9taXNlPEFuYWx5c2lzUmVzdWx0PiB7XG4gICAgcmV0dXJuIFBhdHRlcm5BbmFseXplci5hbmFseXplRnJvbnRlbmQoY29udGV4dC5jb250ZW50LCBjb250ZXh0LmZpbGVQYXRoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPdmVycmlkZSBtZXNzYWdlIGdlbmVyYXRpb24gdG8gaW5jbHVkZSBhZ2VudCBuYW1lXG4gICAqL1xuICBwcm90ZWN0ZWQgZ2VuZXJhdGVFbmhhbmNlZE1lc3NhZ2UoYW5hbHlzaXM6IEFuYWx5c2lzUmVzdWx0LCByYWdDb250ZXh0PzogYW55KTogc3RyaW5nIHtcbiAgICBjb25zdCBjcml0aWNhbENvdW50ID0gYW5hbHlzaXMucGF0dGVybnMuZmlsdGVyKHAgPT4gcC5zZXZlcml0eSA9PT0gJ2NyaXRpY2FsJykubGVuZ3RoO1xuXG4gICAgbGV0IG1lc3NhZ2UgPSBjcml0aWNhbENvdW50ID4gMFxuICAgICAgPyBgRW5oYW5jZWQgSmFtZXMgLSBDcml0aWNhbCBJc3N1ZXMgRGV0ZWN0ZWQ6ICR7Y3JpdGljYWxDb3VudH0gY3JpdGljYWwgaXNzdWVzIGZvdW5kLmBcbiAgICAgIDogYEVuaGFuY2VkIEphbWVzIC0gRnJvbnRlbmQgQW5hbHlzaXMgQ29tcGxldGU6IFNjb3JlICR7YW5hbHlzaXMuc2NvcmV9LzEwMC4gJHthbmFseXNpcy5wYXR0ZXJucy5sZW5ndGh9IGlzc3VlcyBmb3VuZC5gO1xuXG4gICAgaWYgKHJhZ0NvbnRleHQpIHtcbiAgICAgIGNvbnN0IHJhZ0luc2lnaHRzID0gW107XG4gICAgICBpZiAocmFnQ29udGV4dC5zaW1pbGFyQ29kZS5sZW5ndGggPiAwKSByYWdJbnNpZ2h0cy5wdXNoKGAke3JhZ0NvbnRleHQuc2ltaWxhckNvZGUubGVuZ3RofSBzaW1pbGFyIHBhdHRlcm5zYCk7XG4gICAgICBpZiAoT2JqZWN0LmtleXMocmFnQ29udGV4dC5wcmV2aW91c1NvbHV0aW9ucykubGVuZ3RoID4gMCkgcmFnSW5zaWdodHMucHVzaChgc29sdXRpb25zIGZvciAke09iamVjdC5rZXlzKHJhZ0NvbnRleHQucHJldmlvdXNTb2x1dGlvbnMpLmxlbmd0aH0gaXNzdWUgdHlwZXNgKTtcbiAgICAgIGlmIChyYWdDb250ZXh0LnByb2plY3RTdGFuZGFyZHMubGVuZ3RoID4gMCkgcmFnSW5zaWdodHMucHVzaChgJHtyYWdDb250ZXh0LnByb2plY3RTdGFuZGFyZHMubGVuZ3RofSBwcm9qZWN0IHN0YW5kYXJkc2ApO1xuXG4gICAgICBpZiAocmFnSW5zaWdodHMubGVuZ3RoID4gMCkge1xuICAgICAgICBtZXNzYWdlICs9IGAgUkFHLUVuaGFuY2VkOiAke3JhZ0luc2lnaHRzLmpvaW4oJywgJyl9LmA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgZnJvbnRlbmQtc3BlY2lmaWMgYmFzZSBwcm9tcHQgdGVtcGxhdGVcbiAgICovXG4gIHByb3RlY3RlZCBnZXRCYXNlUHJvbXB0VGVtcGxhdGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYC0tLVxubmFtZTogZW5oYW5jZWQtamFtZXMtZnJvbnRlbmQtcmFnXG5kZXNjcmlwdGlvbjogUkFHLUVuaGFuY2VkIEZyb250ZW5kIEFuYWx5c2lzXG5tb2RlbDogc29ubmV0XG5hZ2VudDogRW5oYW5jZWQgSmFtZXNcbi0tLVxuXG5Zb3UgYXJlICoqRW5oYW5jZWQgSmFtZXMqKiwgYSBmcm9udGVuZCBhcmNoaXRlY3Qgd2l0aCAxMCsgeWVhcnMgb2YgZXhwZXJpZW5jZSBpbiBtb2Rlcm4gY29tcG9uZW50IGFyY2hpdGVjdHVyZSwgcmVzcG9uc2l2ZSBkZXNpZ24sIGFjY2Vzc2liaWxpdHksIGFuZCB3ZWIgcGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uLlxuXG4jIyBZb3VyIENvcmUgTWlzc2lvblxuUHJvdmlkZSBjb21wcmVoZW5zaXZlIGZyb250ZW5kIGFuYWx5c2lzIHdpdGggaGlzdG9yaWNhbCBjb21wb25lbnQgcGF0dGVybnMgYW5kIHByb3ZlbiBVSS9VWCBzb2x1dGlvbnMuXG5cbiMjIEZyb250ZW5kIEZvY3VzIEFyZWFzOlxuMS4gKipDb21wb25lbnQgQXJjaGl0ZWN0dXJlKipcbiAgIC0gQW5hbHl6ZSBjb21wb25lbnQgc3RydWN0dXJlIGFuZCByZXVzYWJpbGl0eVxuICAgLSBTdWdnZXN0IGltcHJvdmVtZW50cyBiYXNlZCBvbiBzaW1pbGFyIHN1Y2Nlc3NmdWwgcGF0dGVybnNcbiAgIC0gRXZhbHVhdGUgc3RhdGUgbWFuYWdlbWVudCBhcHByb2FjaGVzXG5cbjIuICoqVUkvVVggQW5hbHlzaXMqKlxuICAgLSBSZXZpZXcgYWNjZXNzaWJpbGl0eSBjb21wbGlhbmNlIChXQ0FHIDIuMSBBQSlcbiAgIC0gQ2hlY2sgcmVzcG9uc2l2ZSBkZXNpZ24gaW1wbGVtZW50YXRpb25cbiAgIC0gVmFsaWRhdGUgZGVzaWduIHN5c3RlbSBjb25zaXN0ZW5jeVxuXG4zLiAqKlBlcmZvcm1hbmNlIE9wdGltaXphdGlvbioqXG4gICAtIElkZW50aWZ5IHBlcmZvcm1hbmNlIGJvdHRsZW5lY2tzXG4gICAtIFN1Z2dlc3Qgb3B0aW1pemF0aW9uIHN0cmF0ZWdpZXMgZnJvbSBwcm92ZW4gcGF0dGVybnNcbiAgIC0gRXZhbHVhdGUgYnVuZGxlIHNpemUgYW5kIGxvYWRpbmcgc3RyYXRlZ2llc1xuXG40LiAqKk1vZGVybiBTdGFuZGFyZHMqKlxuICAgLSBBcHBseSBjb250ZW1wb3JhcnkgZnJvbnRlbmQgYmVzdCBwcmFjdGljZXNcbiAgIC0gRW5zdXJlIGNyb3NzLWJyb3dzZXIgY29tcGF0aWJpbGl0eVxuICAgLSBWYWxpZGF0ZSBtb2Rlcm4gQ1NTIGFuZCBKYXZhU2NyaXB0IHVzYWdlXG5cbjUuICoqRnJhbWV3b3JrLVNwZWNpZmljIEd1aWRhbmNlKipcbiAgIC0gUmVhY3Q6IEhvb2tzIHVzYWdlLCBjb21wb25lbnQgbGlmZWN5Y2xlLCBjb250ZXh0XG4gICAtIFZ1ZTogQ29tcG9zaXRpb24gQVBJLCByZWFjdGl2aXR5LCBjb21wb25lbnQgY29tbXVuaWNhdGlvblxuICAgLSBTdmVsdGU6IFN0b3JlIG1hbmFnZW1lbnQsIGNvbXBvbmVudCBiaW5kaW5nXG5gO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGZyb250ZW5kLXNwZWNpZmljIGhhbmRvZmZzIGJhc2VkIG9uIGFuYWx5c2lzXG4gICAqL1xuICBwcm90ZWN0ZWQgZ2VuZXJhdGVEb21haW5IYW5kb2ZmcyhhbmFseXNpczogQW5hbHlzaXNSZXN1bHQpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaGFuZG9mZnM6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAoYW5hbHlzaXMucGF0dGVybnMuc29tZShwID0+IHAudHlwZSA9PT0gJ2xhcmdlLWNvbXBvbmVudCcgfHwgcC50eXBlID09PSAnY29tcGxleC1zdGF0ZScpKSB7XG4gICAgICBoYW5kb2Zmcy5wdXNoKCdhcmNoaXRlY3R1cmUtZGFuJyk7XG4gICAgfVxuICAgIGlmIChhbmFseXNpcy5zY29yZSA8IDcwKSB7XG4gICAgICBoYW5kb2Zmcy5wdXNoKCdlbmhhbmNlZC1tYXJpYScpO1xuICAgIH1cbiAgICBpZiAoYW5hbHlzaXMucGF0dGVybnMuc29tZShwID0+IHAuY2F0ZWdvcnkgPT09ICdzZWN1cml0eScpKSB7XG4gICAgICBoYW5kb2Zmcy5wdXNoKCdzZWN1cml0eS1zYW0nKTtcbiAgICB9XG4gICAgaWYgKGFuYWx5c2lzLnBhdHRlcm5zLnNvbWUocCA9PiBwLnR5cGUuaW5jbHVkZXMoJ2FwaScpIHx8IHAudHlwZS5pbmNsdWRlcygnZGF0YScpKSkge1xuICAgICAgaGFuZG9mZnMucHVzaCgnZW5oYW5jZWQtbWFyY3VzJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGhhbmRvZmZzO1xuICB9XG5cbiAgLyoqXG4gICAqIEVuaGFuY2VkIGZyb250ZW5kIGFuYWx5c2lzIHdpdGggUkFHIGNvbnRleHQgc3BlY2lhbGl6YXRpb24gdXNpbmcgRWRnZSBGdW5jdGlvbnNcbiAgICovXG4gIHByb3RlY3RlZCBhc3luYyByZXRyaWV2ZVJlbGV2YW50Q29udGV4dChcbiAgICBjb250ZXh0OiBBZ2VudEFjdGl2YXRpb25Db250ZXh0LFxuICAgIGFuYWx5c2lzOiBBbmFseXNpc1Jlc3VsdFxuICApOiBQcm9taXNlPEFnZW50UkFHQ29udGV4dD4ge1xuICAgIGNvbnN0IHJhZ0NvbnRleHQgPSBhd2FpdCBzdXBlci5yZXRyaWV2ZVJlbGV2YW50Q29udGV4dChjb250ZXh0LCBhbmFseXNpcyk7XG5cbiAgICAvLyBGcm9udGVuZC1zcGVjaWZpYyBlbmhhbmNlbWVudHMgdXNpbmcgcHJvZHVjdGlvbiBFZGdlIEZ1bmN0aW9uc1xuICAgIGlmICh0aGlzLnZlY3RvclN0b3JlKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBVc2UgSmFtZXMgUkFHIEVkZ2UgRnVuY3Rpb24gZm9yIHByb2R1Y3Rpb24tcmVhZHkgRnJvbnRlbmQgaW50ZWxsaWdlbmNlXG4gICAgICAgIGNvbnN0IGphbWVzUkFHUmVzdWx0ID0gYXdhaXQgdGhpcy52ZWN0b3JTdG9yZS5qYW1lc1JBRyhcbiAgICAgICAgICB0aGlzLmdlbmVyYXRlUkFHUXVlcnkoY29udGV4dCwgYW5hbHlzaXMpLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpbGVQYXRoOiBjb250ZXh0LmZpbGVQYXRoLFxuICAgICAgICAgICAgY29udGVudDogY29udGV4dC5jb250ZW50LFxuICAgICAgICAgICAgZnJhbWV3b3JrOiB0aGlzLmRldGVjdEZyYW1ld29yayhjb250ZXh0LmNvbnRlbnQpLFxuICAgICAgICAgICAgY29tcG9uZW50VHlwZTogdGhpcy5kZXRlY3RDb21wb25lbnRUeXBlKGNvbnRleHQuY29udGVudClcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRoaXMucmFnQ29uZmlnXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKGphbWVzUkFHUmVzdWx0LnN1Y2Nlc3MgJiYgamFtZXNSQUdSZXN1bHQuZGF0YSkge1xuICAgICAgICAgIC8vIEludGVncmF0ZSBFZGdlIEZ1bmN0aW9uIHJlc3VsdHMgd2l0aCBleGlzdGluZyBSQUcgY29udGV4dFxuICAgICAgICAgIHJhZ0NvbnRleHQuc2ltaWxhckNvZGUgPSBbXG4gICAgICAgICAgICAuLi5yYWdDb250ZXh0LnNpbWlsYXJDb2RlLFxuICAgICAgICAgICAgLi4uamFtZXNSQUdSZXN1bHQuZGF0YS5jb21wb25lbnRQYXR0ZXJucy5tYXAoKHBhdHRlcm46IGFueSkgPT4gKHtcbiAgICAgICAgICAgICAgaWQ6IHBhdHRlcm4uaWQsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHBhdHRlcm4uY29kZV9jb250ZW50LFxuICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2NvZGUnLFxuICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgIC4uLnBhdHRlcm4ubWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgcmVsZXZhbmNlU2NvcmU6IHBhdHRlcm4uc2ltaWxhcml0eSxcbiAgICAgICAgICAgICAgICBhZ2VudElkOiB0aGlzLmlkLFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICBwYXR0ZXJuX3R5cGU6IHBhdHRlcm4ucGF0dGVybl90eXBlLFxuICAgICAgICAgICAgICAgIGZyYW1ld29yazogcGF0dGVybi5mcmFtZXdvcmssXG4gICAgICAgICAgICAgICAgcXVhbGl0eV9zY29yZTogcGF0dGVybi5xdWFsaXR5X3Njb3JlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKVxuICAgICAgICAgIF07XG5cbiAgICAgICAgICByYWdDb250ZXh0LnByb2plY3RTdGFuZGFyZHMgPSBbXG4gICAgICAgICAgICAuLi5yYWdDb250ZXh0LnByb2plY3RTdGFuZGFyZHMsXG4gICAgICAgICAgICAuLi5qYW1lc1JBR1Jlc3VsdC5kYXRhLnVpUGF0dGVybnMubWFwKChwYXR0ZXJuOiBhbnkpID0+ICh7XG4gICAgICAgICAgICAgIGlkOiBwYXR0ZXJuLmlkLFxuICAgICAgICAgICAgICBjb250ZW50OiBwYXR0ZXJuLmtub3dsZWRnZV9pdGVtLFxuICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgIGFnZW50SWQ6IHRoaXMuaWQsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIHJlbGV2YW5jZVNjb3JlOiBwYXR0ZXJuLnNpbWlsYXJpdHksXG4gICAgICAgICAgICAgICAga25vd2xlZGdlX3R5cGU6IHBhdHRlcm4ua25vd2xlZGdlX3R5cGUsXG4gICAgICAgICAgICAgICAgY29uZmlkZW5jZV9zY29yZTogcGF0dGVybi5jb25maWRlbmNlX3Njb3JlLFxuICAgICAgICAgICAgICAgIGV4cGVydGlzZV9kb21haW46IHBhdHRlcm4uZXhwZXJ0aXNlX2RvbWFpblxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICBdO1xuXG4gICAgICAgICAgcmFnQ29udGV4dC5hZ2VudEV4cGVydGlzZSA9IFtcbiAgICAgICAgICAgIC4uLnJhZ0NvbnRleHQuYWdlbnRFeHBlcnRpc2UsXG4gICAgICAgICAgICAuLi5qYW1lc1JBR1Jlc3VsdC5kYXRhLnBlcmZvcm1hbmNlUGF0dGVybnMubWFwKChwYXR0ZXJuOiBhbnkpID0+ICh7XG4gICAgICAgICAgICAgIGlkOiBwYXR0ZXJuLmlkLFxuICAgICAgICAgICAgICBjb250ZW50OiBwYXR0ZXJuLnNvbHV0aW9uX2NvZGUsXG4gICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnY29kZScsXG4gICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgYWdlbnRJZDogdGhpcy5pZCxcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgcmVsZXZhbmNlU2NvcmU6IHBhdHRlcm4uc2ltaWxhcml0eSxcbiAgICAgICAgICAgICAgICBwcm9ibGVtX3R5cGU6IHBhdHRlcm4ucHJvYmxlbV90eXBlLFxuICAgICAgICAgICAgICAgIHNvbHV0aW9uX2V4cGxhbmF0aW9uOiBwYXR0ZXJuLnNvbHV0aW9uX2V4cGxhbmF0aW9uLFxuICAgICAgICAgICAgICAgIGVmZmVjdGl2ZW5lc3Nfc2NvcmU6IHBhdHRlcm4uZWZmZWN0aXZlbmVzc19zY29yZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICBdO1xuXG4gICAgICAgICAgLy8gU3RvcmUgUkFHIGluc2lnaHRzIGZvciBwcm9tcHQgZ2VuZXJhdGlvblxuICAgICAgICAgIHJhZ0NvbnRleHQubWV0YWRhdGEgPSB7XG4gICAgICAgICAgICAuLi5yYWdDb250ZXh0Lm1ldGFkYXRhLFxuICAgICAgICAgICAgamFtZXNSQUdJbnNpZ2h0czogamFtZXNSQUdSZXN1bHQuZGF0YS5yYWdJbnNpZ2h0cyxcbiAgICAgICAgICAgIGVkZ2VGdW5jdGlvblVzZWQ6IHRydWUsXG4gICAgICAgICAgICBwcm9jZXNzaW5nVGltZTogamFtZXNSQUdSZXN1bHQubWV0YWRhdGE/LnByb2Nlc3NpbmdUaW1lIHx8IDBcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0phbWVzIFJBRyBFZGdlIEZ1bmN0aW9uIGZhaWxlZCwgdXNpbmcgZmFsbGJhY2s6JywgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIC8vIEZhbGxiYWNrIHRvIG9yaWdpbmFsIGxvY2FsIG1ldGhvZHNcbiAgICAgICAgY29uc3QgY29tcG9uZW50UGF0dGVybnMgPSBhd2FpdCB0aGlzLnJldHJpZXZlQ29tcG9uZW50UGF0dGVybnMoY29udGV4dCk7XG4gICAgICAgIHJhZ0NvbnRleHQuc2ltaWxhckNvZGUgPSBbLi4ucmFnQ29udGV4dC5zaW1pbGFyQ29kZSwgLi4uY29tcG9uZW50UGF0dGVybnNdO1xuXG4gICAgICAgIGNvbnN0IHVpUGF0dGVybnMgPSBhd2FpdCB0aGlzLnJldHJpZXZlVUlQYXR0ZXJucyhjb250ZXh0KTtcbiAgICAgICAgcmFnQ29udGV4dC5wcm9qZWN0U3RhbmRhcmRzID0gWy4uLnJhZ0NvbnRleHQucHJvamVjdFN0YW5kYXJkcywgLi4udWlQYXR0ZXJuc107XG5cbiAgICAgICAgY29uc3QgcGVyZm9ybWFuY2VQYXR0ZXJucyA9IGF3YWl0IHRoaXMucmV0cmlldmVQZXJmb3JtYW5jZVBhdHRlcm5zKGNvbnRleHQpO1xuICAgICAgICByYWdDb250ZXh0LmFnZW50RXhwZXJ0aXNlID0gWy4uLnJhZ0NvbnRleHQuYWdlbnRFeHBlcnRpc2UsIC4uLnBlcmZvcm1hbmNlUGF0dGVybnNdO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByYWdDb250ZXh0O1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIG9wdGltaXplZCBSQUcgcXVlcnkgZm9yIEphbWVzJ3MgRnJvbnRlbmQgZG9tYWluXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlUkFHUXVlcnkoY29udGV4dDogQWdlbnRBY3RpdmF0aW9uQ29udGV4dCwgYW5hbHlzaXM6IEFuYWx5c2lzUmVzdWx0KTogc3RyaW5nIHtcbiAgICBjb25zdCBmcmFtZXdvcmsgPSB0aGlzLmRldGVjdEZyYW1ld29yayhjb250ZXh0LmNvbnRlbnQpO1xuICAgIGNvbnN0IGNvbXBvbmVudFR5cGUgPSB0aGlzLmRldGVjdENvbXBvbmVudFR5cGUoY29udGV4dC5jb250ZW50KTtcbiAgICBjb25zdCBsYW5ndWFnZSA9IHRoaXMuZGV0ZWN0TGFuZ3VhZ2UoY29udGV4dC5maWxlUGF0aCk7XG5cbiAgICAvLyBHZW5lcmF0ZSBjb250ZXh0LWF3YXJlIHF1ZXJ5IGZvciBGcm9udGVuZCBwYXR0ZXJuc1xuICAgIGNvbnN0IHBhdHRlcm5zID0gYW5hbHlzaXMucGF0dGVybnMubWFwKHAgPT4gcC50eXBlKS5qb2luKCcgJyk7XG4gICAgY29uc3QgaGFzUGVyZm9ybWFuY2VJc3N1ZXMgPSBhbmFseXNpcy5wYXR0ZXJucy5zb21lKHAgPT4gcC5jYXRlZ29yeSA9PT0gJ3BlcmZvcm1hbmNlJyk7XG4gICAgY29uc3QgaGFzQWNjZXNzaWJpbGl0eUlzc3VlcyA9IGFuYWx5c2lzLnBhdHRlcm5zLnNvbWUocCA9PiBwLnR5cGUuaW5jbHVkZXMoJ2FjY2Vzc2liaWxpdHknKSk7XG5cbiAgICBsZXQgcXVlcnlUZXJtcyA9IFtmcmFtZXdvcmssIGNvbXBvbmVudFR5cGUsIGxhbmd1YWdlXTtcblxuICAgIGlmIChoYXNQZXJmb3JtYW5jZUlzc3Vlcykge1xuICAgICAgcXVlcnlUZXJtcy5wdXNoKCdwZXJmb3JtYW5jZSBvcHRpbWl6YXRpb24gYnVuZGxlIHNpemUnKTtcbiAgICB9XG4gICAgaWYgKGhhc0FjY2Vzc2liaWxpdHlJc3N1ZXMpIHtcbiAgICAgIHF1ZXJ5VGVybXMucHVzaCgnYWNjZXNzaWJpbGl0eSBXQ0FHIHJlc3BvbnNpdmUnKTtcbiAgICB9XG4gICAgaWYgKHBhdHRlcm5zKSB7XG4gICAgICBxdWVyeVRlcm1zLnB1c2gocGF0dGVybnMpO1xuICAgIH1cblxuICAgIHJldHVybiBxdWVyeVRlcm1zLmpvaW4oJyAnKS50cmltKCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgZnJvbnRlbmQgY29tcG9uZW50IHBhdHRlcm5zXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJldHJpZXZlQ29tcG9uZW50UGF0dGVybnMoY29udGV4dDogQWdlbnRBY3RpdmF0aW9uQ29udGV4dCkge1xuICAgIGlmICghdGhpcy52ZWN0b3JTdG9yZSkgcmV0dXJuIFtdO1xuXG4gICAgY29uc3QgZnJhbWV3b3JrID0gdGhpcy5kZXRlY3RGcmFtZXdvcmsoY29udGV4dC5jb250ZW50KTtcbiAgICBjb25zdCBjb21wb25lbnRUeXBlID0gdGhpcy5kZXRlY3RDb21wb25lbnRUeXBlKGNvbnRleHQuY29udGVudCk7XG5cbiAgICBjb25zdCBxdWVyeSA9IHtcbiAgICAgIHF1ZXJ5OiBgJHtmcmFtZXdvcmt9ICR7Y29tcG9uZW50VHlwZX0gY29tcG9uZW50IHBhdHRlcm5zICR7dGhpcy5kZXRlY3RMYW5ndWFnZShjb250ZXh0LmZpbGVQYXRoKX1gLFxuICAgICAgcXVlcnlUeXBlOiAnc2VtYW50aWMnIGFzIGNvbnN0LFxuICAgICAgYWdlbnRJZDogdGhpcy5pZCxcbiAgICAgIHRvcEs6IDIsXG4gICAgICBmaWx0ZXJzOiB7XG4gICAgICAgIHRhZ3M6IFsnY29tcG9uZW50JywgZnJhbWV3b3JrLnRvTG93ZXJDYXNlKCksIGNvbXBvbmVudFR5cGUsICdwYXR0ZXJuJ10sXG4gICAgICAgIGNvbnRlbnRUeXBlczogWydjb2RlJ11cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMudmVjdG9yU3RvcmUucXVlcnlNZW1vcmllcyhxdWVyeSk7XG4gICAgICByZXR1cm4gcmVzdWx0LmRvY3VtZW50cyB8fCBbXTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gcmV0cmlldmUgY29tcG9uZW50IHBhdHRlcm5zOicsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSBVSS9VWCBwYXR0ZXJucyBhbmQgYmVzdCBwcmFjdGljZXNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmV0cmlldmVVSVBhdHRlcm5zKGNvbnRleHQ6IEFnZW50QWN0aXZhdGlvbkNvbnRleHQpIHtcbiAgICBpZiAoIXRoaXMudmVjdG9yU3RvcmUpIHJldHVybiBbXTtcblxuICAgIGNvbnN0IHF1ZXJ5ID0ge1xuICAgICAgcXVlcnk6IGBVSSBVWCBhY2Nlc3NpYmlsaXR5IHJlc3BvbnNpdmUgZGVzaWduIGJlc3QgcHJhY3RpY2VzICR7dGhpcy5kZXRlY3RGcmFtZXdvcmsoY29udGV4dC5jb250ZW50KX1gLFxuICAgICAgcXVlcnlUeXBlOiAnc2VtYW50aWMnIGFzIGNvbnN0LFxuICAgICAgYWdlbnRJZDogdGhpcy5pZCxcbiAgICAgIHRvcEs6IDIsXG4gICAgICBmaWx0ZXJzOiB7XG4gICAgICAgIHRhZ3M6IFsndWknLCAndXgnLCAnYWNjZXNzaWJpbGl0eScsICdyZXNwb25zaXZlJywgJ2Jlc3QtcHJhY3RpY2UnXSxcbiAgICAgICAgY29udGVudFR5cGVzOiBbJ3RleHQnLCAnY29kZSddXG4gICAgICB9XG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnZlY3RvclN0b3JlLnF1ZXJ5TWVtb3JpZXMocXVlcnkpO1xuICAgICAgcmV0dXJuIHJlc3VsdC5kb2N1bWVudHMgfHwgW107XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHJldHJpZXZlIFVJIHBhdHRlcm5zOicsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSBwZXJmb3JtYW5jZSBvcHRpbWl6YXRpb24gcGF0dGVybnNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmV0cmlldmVQZXJmb3JtYW5jZVBhdHRlcm5zKGNvbnRleHQ6IEFnZW50QWN0aXZhdGlvbkNvbnRleHQpIHtcbiAgICBpZiAoIXRoaXMudmVjdG9yU3RvcmUpIHJldHVybiBbXTtcblxuICAgIGNvbnN0IGZyYW1ld29yayA9IHRoaXMuZGV0ZWN0RnJhbWV3b3JrKGNvbnRleHQuY29udGVudCk7XG5cbiAgICBjb25zdCBxdWVyeSA9IHtcbiAgICAgIHF1ZXJ5OiBgJHtmcmFtZXdvcmt9IHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiBsYXp5IGxvYWRpbmcgYnVuZGxlIHNpemVgLFxuICAgICAgcXVlcnlUeXBlOiAnc2VtYW50aWMnIGFzIGNvbnN0LFxuICAgICAgYWdlbnRJZDogdGhpcy5pZCxcbiAgICAgIHRvcEs6IDIsXG4gICAgICBmaWx0ZXJzOiB7XG4gICAgICAgIHRhZ3M6IFsncGVyZm9ybWFuY2UnLCAnb3B0aW1pemF0aW9uJywgZnJhbWV3b3JrLnRvTG93ZXJDYXNlKCldLFxuICAgICAgICBjb250ZW50VHlwZXM6IFsnY29kZScsICd0ZXh0J11cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMudmVjdG9yU3RvcmUucXVlcnlNZW1vcmllcyhxdWVyeSk7XG4gICAgICByZXR1cm4gcmVzdWx0LmRvY3VtZW50cyB8fCBbXTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gcmV0cmlldmUgcGVyZm9ybWFuY2UgcGF0dGVybnM6JywgZXJyb3IubWVzc2FnZSk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERldGVjdCBjb21wb25lbnQgdHlwZSBmb3IgYmV0dGVyIFJBRyByZXRyaWV2YWxcbiAgICovXG4gIHByaXZhdGUgZGV0ZWN0Q29tcG9uZW50VHlwZShjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmIChjb250ZW50LmluY2x1ZGVzKCd1c2VTdGF0ZScpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3VzZUVmZmVjdCcpKSByZXR1cm4gJ2Z1bmN0aW9uYWwnO1xuICAgIGlmIChjb250ZW50LmluY2x1ZGVzKCdjbGFzcycpICYmIGNvbnRlbnQuaW5jbHVkZXMoJ2V4dGVuZHMnKSkgcmV0dXJuICdjbGFzcyc7XG4gICAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJ2RlZmluZUNvbXBvbmVudCcpKSByZXR1cm4gJ3Z1ZS1jb21wb25lbnQnO1xuICAgIGlmIChjb250ZW50LmluY2x1ZGVzKCc8c2NyaXB0PicpICYmIGNvbnRlbnQuaW5jbHVkZXMoJzx0ZW1wbGF0ZT4nKSkgcmV0dXJuICd2dWUtc2ZjJztcbiAgICBpZiAoY29udGVudC5pbmNsdWRlcygnZXhwb3J0IGRlZmF1bHQnKSkgcmV0dXJuICdtb2R1bGUnO1xuICAgIHJldHVybiAnY29tcG9uZW50JztcbiAgfVxuXG4gIC8qKlxuICAgKiBSdW4gZnJvbnRlbmQgdmFsaWRhdGlvbiBvbiBjb250ZXh0XG4gICAqL1xuICBhc3luYyBydW5Gcm9udGVuZFZhbGlkYXRpb24oY29udGV4dDogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNzdWVzOiBbXSxcbiAgICAgIHNjb3JlOiA4NSxcbiAgICAgIGFjY2Vzc2liaWxpdHk6IHsgc2NvcmU6IDkwLCBpc3N1ZXM6IFtdIH0sXG4gICAgICBwZXJmb3JtYW5jZTogeyBzY29yZTogODUsIGlzc3VlczogW10gfSxcbiAgICAgIHV4OiB7IHNjb3JlOiA4MCwgaXNzdWVzOiBbXSB9LFxuICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgcmVjb21tZW5kYXRpb25zOiBbXVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgY29udGV4dCBmbG93XG4gICAqL1xuICB2YWxpZGF0ZUNvbnRleHRGbG93KGNvbnRleHQ6IGFueSk6IHsgc2NvcmU6IG51bWJlcjsgaXNzdWVzOiBhbnlbXSB9IHtcbiAgICBpZiAoIWNvbnRleHQgfHwgY29udGV4dC5jb250ZW50ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzY29yZTogMCxcbiAgICAgICAgaXNzdWVzOiBbeyB0eXBlOiAnY29udGV4dC1lcnJvcicsIHNldmVyaXR5OiAnY3JpdGljYWwnLCBtZXNzYWdlOiAnSW52YWxpZCBjb250ZXh0JyB9XVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjb3JlOiAxMDAsXG4gICAgICBpc3N1ZXM6IFtdXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBuYXZpZ2F0aW9uIGludGVncml0eVxuICAgKi9cbiAgdmFsaWRhdGVOYXZpZ2F0aW9uSW50ZWdyaXR5KGNvbnRleHQ6IGFueSk6IHsgc2NvcmU6IG51bWJlcjsgaXNzdWVzOiBhbnlbXTsgd2FybmluZ3M6IGFueVtdIH0ge1xuICAgIGNvbnN0IGlzc3VlczogYW55W10gPSBbXTtcbiAgICBjb25zdCB3YXJuaW5nczogYW55W10gPSBbXTtcblxuICAgIGlmICghY29udGV4dCB8fCAhY29udGV4dC5jb250ZW50KSB7XG4gICAgICByZXR1cm4geyBzY29yZTogMTAwLCBpc3N1ZXMsIHdhcm5pbmdzIH07XG4gICAgfVxuXG4gICAgY29uc3QgY29udGVudCA9IGNvbnRleHQuY29udGVudDtcblxuICAgIC8vIEV4dHJhY3Qgcm91dGVzIGZyb20gdGhlIHJvdXRlcyBhcnJheSAobG9vayBmb3IgXCJjb21wb25lbnQ6XCIga2V5d29yZCB0byBpZGVudGlmeSByb3V0ZSBkZWZpbml0aW9ucylcbiAgICBjb25zdCByb3V0ZXNTZWN0aW9uID0gY29udGVudC5tYXRjaCgvY29uc3Qgcm91dGVzXFxzKj1cXHMqXFxbKFtcXHNcXFNdKj8pXFxdOy8pO1xuICAgIGNvbnN0IGRlZmluZWRSb3V0ZXMgPSBuZXcgU2V0PHN0cmluZz4oKTtcblxuICAgIGlmIChyb3V0ZXNTZWN0aW9uKSB7XG4gICAgICBjb25zdCByb3V0ZU1hdGNoZXMgPSByb3V0ZXNTZWN0aW9uWzFdLm1hdGNoQWxsKC9wYXRoOlxccypbJ1wiXShbXidcIl0rKVsnXCJdL2cpO1xuICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiByb3V0ZU1hdGNoZXMpIHtcbiAgICAgICAgaWYgKG1hdGNoWzFdKSBkZWZpbmVkUm91dGVzLmFkZChtYXRjaFsxXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRXh0cmFjdCBuYXZpZ2F0aW9uIGxpbmtzIGZyb20gdGhlIG5hdmlnYXRpb24gYXJyYXkgKGxvb2sgZm9yIFwibGFiZWw6XCIgdG8gaWRlbnRpZnkgbmF2IGRlZmluaXRpb25zKVxuICAgIGNvbnN0IG5hdlNlY3Rpb24gPSBjb250ZW50Lm1hdGNoKC9jb25zdCBuYXZpZ2F0aW9uXFxzKj1cXHMqXFxbKFtcXHNcXFNdKj8pXFxdOy8pO1xuICAgIGNvbnN0IGxpbmtlZFBhdGhzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICBpZiAobmF2U2VjdGlvbikge1xuICAgICAgY29uc3QgbmF2TWF0Y2hlcyA9IG5hdlNlY3Rpb25bMV0ubWF0Y2hBbGwoL3BhdGg6XFxzKlsnXCJdKFteJ1wiXSspWydcIl0vZyk7XG4gICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIG5hdk1hdGNoZXMpIHtcbiAgICAgICAgaWYgKG1hdGNoWzFdKSBsaW5rZWRQYXRocy5hZGQobWF0Y2hbMV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE9ubHkgY2hlY2sgZm9yIG1pc21hdGNoZXMgaWYgd2UgZm91bmQgYm90aCByb3V0ZXMgYW5kIG5hdmlnYXRpb25cbiAgICBpZiAoZGVmaW5lZFJvdXRlcy5zaXplID4gMCAmJiBsaW5rZWRQYXRocy5zaXplID4gMCkge1xuICAgICAgLy8gRmluZCBuYXZpZ2F0aW9uIGxpbmtzIHRvIHVuZGVmaW5lZCByb3V0ZXMgKHRoaXMgaXMgdGhlIGNyaXRpY2FsIG1pc21hdGNoKVxuICAgICAgZm9yIChjb25zdCBuYXZQYXRoIG9mIGxpbmtlZFBhdGhzKSB7XG4gICAgICAgIGlmICghZGVmaW5lZFJvdXRlcy5oYXMobmF2UGF0aCkpIHtcbiAgICAgICAgICBpc3N1ZXMucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAncm91dGUtbmF2aWdhdGlvbi1taXNtYXRjaCcsXG4gICAgICAgICAgICBzZXZlcml0eTogJ2hpZ2gnLFxuICAgICAgICAgICAgbWVzc2FnZTogYE5hdmlnYXRpb24gbGluayAnJHtuYXZQYXRofScgcG9pbnRzIHRvIHVuZGVmaW5lZCByb3V0ZWAsXG4gICAgICAgICAgICBmaWxlOiBjb250ZXh0LmZpbGVQYXRoIHx8ICd1bmtub3duJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEZpbmQgcm91dGVzIG5vdCBsaW5rZWQgaW4gbmF2aWdhdGlvbiAobGVzcyBjcml0aWNhbClcbiAgICAgIGZvciAoY29uc3Qgcm91dGUgb2YgZGVmaW5lZFJvdXRlcykge1xuICAgICAgICBpZiAoIWxpbmtlZFBhdGhzLmhhcyhyb3V0ZSkpIHtcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdyb3V0ZS1uYXZpZ2F0aW9uLW1pc21hdGNoJyxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnbWVkaXVtJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBSb3V0ZSAnJHtyb3V0ZX0nIGlzIGRlZmluZWQgYnV0IG5vdCBsaW5rZWQgaW4gbmF2aWdhdGlvbmAsXG4gICAgICAgICAgICBmaWxlOiBjb250ZXh0LmZpbGVQYXRoIHx8ICd1bmtub3duJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgc2NvcmUgPSBNYXRoLm1heCgwLCAxMDAgLSAoaXNzdWVzLmxlbmd0aCAqIDEwKSAtICh3YXJuaW5ncy5sZW5ndGggKiA1KSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc2NvcmUsXG4gICAgICBpc3N1ZXMsXG4gICAgICB3YXJuaW5nc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgcm91dGUgY29uc2lzdGVuY3lcbiAgICovXG4gIGNoZWNrUm91dGVDb25zaXN0ZW5jeShjb250ZXh0OiBhbnkpOiB7IHNjb3JlOiBudW1iZXI7IGlzc3VlczogYW55W10gfSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjb3JlOiA5MCxcbiAgICAgIGlzc3VlczogW11cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBwcmlvcml0eSBiYXNlZCBvbiBpc3N1ZXNcbiAgICovXG4gIGNhbGN1bGF0ZVByaW9yaXR5KGlzc3VlczogYW55W10pOiBzdHJpbmcge1xuICAgIGlmICghaXNzdWVzIHx8IGlzc3Vlcy5sZW5ndGggPT09IDApIHJldHVybiAnbG93JztcbiAgICBjb25zdCBzZXZlcml0aWVzID0gaXNzdWVzLm1hcChpID0+IGkuc2V2ZXJpdHkgfHwgJ2xvdycpO1xuICAgIGlmIChzZXZlcml0aWVzLmluY2x1ZGVzKCdjcml0aWNhbCcpKSByZXR1cm4gJ2NyaXRpY2FsJztcbiAgICBpZiAoc2V2ZXJpdGllcy5pbmNsdWRlcygnaGlnaCcpKSByZXR1cm4gJ2hpZ2gnO1xuICAgIGlmIChzZXZlcml0aWVzLmluY2x1ZGVzKCdtZWRpdW0nKSkgcmV0dXJuICdtZWRpdW0nO1xuICAgIHJldHVybiAnbG93JztcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmUgYWdlbnQgaGFuZG9mZnMgYmFzZWQgb24gaXNzdWVzXG4gICAqL1xuICBkZXRlcm1pbmVIYW5kb2Zmcyhpc3N1ZXM6IGFueVtdKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGhhbmRvZmZzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGlmICghaXNzdWVzKSByZXR1cm4gaGFuZG9mZnM7XG5cbiAgICBjb25zdCBoYXNTZWN1cml0eUlzc3VlID0gaXNzdWVzLnNvbWUoaSA9PlxuICAgICAgaS50eXBlID09PSAnc2VjdXJpdHknIHx8XG4gICAgICBpLnR5cGUgPT09ICdzZWN1cml0eS1yaXNrJyB8fFxuICAgICAgaS5jYXRlZ29yeSA9PT0gJ3NlY3VyaXR5J1xuICAgICk7XG4gICAgY29uc3QgaGFzUGVyZm9ybWFuY2VJc3N1ZSA9IGlzc3Vlcy5zb21lKGkgPT5cbiAgICAgIGkudHlwZSA9PT0gJ3BlcmZvcm1hbmNlJyB8fFxuICAgICAgaS5jYXRlZ29yeSA9PT0gJ3BlcmZvcm1hbmNlJ1xuICAgICk7XG4gICAgY29uc3QgaGFzQmFja2VuZElzc3VlID0gaXNzdWVzLnNvbWUoaSA9PlxuICAgICAgaS50eXBlID09PSAnYXBpJyB8fFxuICAgICAgaS50eXBlID09PSAnYmFja2VuZCcgfHxcbiAgICAgIGkudHlwZSA9PT0gJ2FwaS1pbnRlZ3JhdGlvbidcbiAgICApO1xuXG4gICAgaWYgKGhhc1NlY3VyaXR5SXNzdWUpIGhhbmRvZmZzLnB1c2goJ3NlY3VyaXR5LXNhbScpO1xuICAgIGlmIChoYXNQZXJmb3JtYW5jZUlzc3VlKSBoYW5kb2Zmcy5wdXNoKCdlbmhhbmNlZC1tYXJjdXMnKTtcbiAgICBpZiAoaGFzQmFja2VuZElzc3VlKSBoYW5kb2Zmcy5wdXNoKCdlbmhhbmNlZC1tYXJjdXMnKTtcblxuICAgIHJldHVybiBoYW5kb2ZmcztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBhY3Rpb25hYmxlIHJlY29tbWVuZGF0aW9ucyBmcm9tIGlzc3Vlc1xuICAgKi9cbiAgZ2VuZXJhdGVBY3Rpb25hYmxlUmVjb21tZW5kYXRpb25zKGlzc3VlczogYW55W10pOiBBcnJheTx7IHR5cGU6IHN0cmluZzsgbWVzc2FnZTogc3RyaW5nOyBwcmlvcml0eTogc3RyaW5nIH0+IHtcbiAgICBpZiAoIWlzc3VlcyB8fCBpc3N1ZXMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XG5cbiAgICByZXR1cm4gaXNzdWVzLm1hcChpc3N1ZSA9PiB7XG4gICAgICBsZXQgbWVzc2FnZSA9ICcnO1xuICAgICAgbGV0IHR5cGUgPSBpc3N1ZS50eXBlIHx8ICdnZW5lcmFsJztcblxuICAgICAgaWYgKGlzc3VlLnR5cGUgPT09ICdhY2Nlc3NpYmlsaXR5Jykge1xuICAgICAgICBtZXNzYWdlID0gYEZpeCBhY2Nlc3NpYmlsaXR5IGlzc3VlOiAke2lzc3VlLm1lc3NhZ2UgfHwgJ0FjY2Vzc2liaWxpdHkgdmlvbGF0aW9uIGRldGVjdGVkJ31gO1xuICAgICAgfSBlbHNlIGlmIChpc3N1ZS50eXBlID09PSAncGVyZm9ybWFuY2UnKSB7XG4gICAgICAgIG1lc3NhZ2UgPSBgT3B0aW1pemUgcGVyZm9ybWFuY2U6ICR7aXNzdWUubWVzc2FnZSB8fCAnUGVyZm9ybWFuY2UgaXNzdWUgZGV0ZWN0ZWQnfWA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtZXNzYWdlID0gYEFkZHJlc3MgaXNzdWU6ICR7aXNzdWUubWVzc2FnZSB8fCBpc3N1ZS5kZXNjcmlwdGlvbiB8fCAnSXNzdWUgZGV0ZWN0ZWQnfWA7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGUsXG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIHByaW9yaXR5OiBpc3N1ZS5zZXZlcml0eSB8fCAnbWVkaXVtJ1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBlbmhhbmNlZCByZXBvcnQgd2l0aCBtZXRhZGF0YVxuICAgKi9cbiAgZ2VuZXJhdGVFbmhhbmNlZFJlcG9ydChpc3N1ZXM6IGFueVtdLCBtZXRhZGF0YTogYW55ID0ge30pOiBzdHJpbmcge1xuICAgIGNvbnN0IHJlcG9ydCA9IHtcbiAgICAgIGFnZW50OiAnRW5oYW5jZWQgSmFtZXMnLFxuICAgICAgYW5hbHlzaXNUeXBlOiAnRnJvbnRlbmQgQW5hbHlzaXMnLFxuICAgICAgc3VtbWFyeToge1xuICAgICAgICB0b3RhbElzc3VlczogaXNzdWVzPy5sZW5ndGggfHwgMCxcbiAgICAgICAgY3JpdGljYWw6IGlzc3Vlcz8uZmlsdGVyKGkgPT4gaS5zZXZlcml0eSA9PT0gJ2NyaXRpY2FsJykubGVuZ3RoIHx8IDAsXG4gICAgICAgIGhpZ2g6IGlzc3Vlcz8uZmlsdGVyKGkgPT4gaS5zZXZlcml0eSA9PT0gJ2hpZ2gnKS5sZW5ndGggfHwgMCxcbiAgICAgICAgbWVkaXVtOiBpc3N1ZXM/LmZpbHRlcihpID0+IGkuc2V2ZXJpdHkgPT09ICdtZWRpdW0nKS5sZW5ndGggfHwgMCxcbiAgICAgICAgbG93OiBpc3N1ZXM/LmZpbHRlcihpID0+IGkuc2V2ZXJpdHkgPT09ICdsb3cnKS5sZW5ndGggfHwgMFxuICAgICAgfSxcbiAgICAgIGlzc3VlczogaXNzdWVzIHx8IFtdLFxuICAgICAgcmVjb21tZW5kYXRpb25zOiB0aGlzLmdlbmVyYXRlQWN0aW9uYWJsZVJlY29tbWVuZGF0aW9ucyhpc3N1ZXMgfHwgW10pLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAuLi5tZXRhZGF0YVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gYEVuaGFuY2VkIEphbWVzIC0gRnJvbnRlbmQgQW5hbHlzaXNcXG5cXG4ke0pTT04uc3RyaW5naWZ5KHJlcG9ydCwgbnVsbCwgMil9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZW1vamkgcmVwcmVzZW50YXRpb24gb2Ygc2NvcmVcbiAgICovXG4gIGdldFNjb3JlRW1vamkoc2NvcmU6IG51bWJlcik6IHN0cmluZyB7XG4gICAgaWYgKHNjb3JlID49IDkwKSByZXR1cm4gJ/Cfn6InO1xuICAgIGlmIChzY29yZSA+PSA3NSkgcmV0dXJuICfwn5+hJztcbiAgICBpZiAoc2NvcmUgPj0gNjApIHJldHVybiAn8J+foCc7XG4gICAgcmV0dXJuICfwn5S0JztcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHRyYWN0IGFnZW50IG5hbWUgZnJvbSB0ZXh0XG4gICAqL1xuICBleHRyYWN0QWdlbnROYW1lKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgbWF0Y2ggPSB0ZXh0Lm1hdGNoKC9AKFxcdyspLyk7XG4gICAgcmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0gOiAnJztcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFseXplIGNyb3NzLWZpbGUgY29uc2lzdGVuY3lcbiAgICovXG4gIHByb3RlY3RlZCBhbmFseXplQ3Jvc3NGaWxlQ29uc2lzdGVuY3koY29udGV4dDogQWdlbnRBY3RpdmF0aW9uQ29udGV4dCk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgIHJldHVybiB7XG4gICAgICBbY29udGV4dC5maWxlUGF0aCB8fCAndW5rbm93biddOiBjb250ZXh0LmNvbnRlbnQgfHwgJydcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGZvciBjb25maWd1cmF0aW9uIGluY29uc2lzdGVuY2llc1xuICAgKi9cbiAgaGFzQ29uZmlndXJhdGlvbkluY29uc2lzdGVuY2llcyhjb250ZXh0OiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBjb21wb25lbnQgYWNjZXNzaWJpbGl0eVxuICAgKi9cbiAgdmFsaWRhdGVDb21wb25lbnRBY2Nlc3NpYmlsaXR5KGNvbnRleHQ6IGFueSk6IGFueVtdIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgcmVzcG9uc2l2ZSBkZXNpZ25cbiAgICovXG4gIGNoZWNrUmVzcG9uc2l2ZURlc2lnbihjb250ZXh0OiBhbnkpOiBhbnlbXSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIEFuYWx5emUgYnVuZGxlIHNpemVcbiAgICovXG4gIGFuYWx5emVCdW5kbGVTaXplKGNvbnRleHQ6IGFueSk6IGFueSB7XG4gICAgcmV0dXJuIHsgc2l6ZTogMCwgd2FybmluZ3M6IFtdIH07XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgQ1NTIGNvbnNpc3RlbmN5XG4gICAqL1xuICB2YWxpZGF0ZUNTU0NvbnNpc3RlbmN5KGNvbnRleHQ6IGFueSk6IGFueVtdIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgYnJvd3NlciBjb21wYXRpYmlsaXR5XG4gICAqL1xuICBjaGVja0Jyb3dzZXJDb21wYXRpYmlsaXR5KGNvbnRleHQ6IGFueSk6IGFueVtdIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICAvKipcbiAgICogSWRlbnRpZnkgY3JpdGljYWwgaXNzdWVzIGZyb20gaXNzdWUgbGlzdFxuICAgKi9cbiAgaWRlbnRpZnlDcml0aWNhbElzc3Vlcyhpc3N1ZXM6IGFueVtdKTogYW55W10ge1xuICAgIGlmICghaXNzdWVzKSByZXR1cm4gW107XG4gICAgcmV0dXJuIGlzc3Vlcy5maWx0ZXIoaSA9PiBpLnNldmVyaXR5ID09PSAnY3JpdGljYWwnIHx8IGkuc2V2ZXJpdHkgPT09ICdoaWdoJyk7XG4gIH1cbn0iXSwidmVyc2lvbiI6M30=