e5ed55bdbc0759792cfafac81513d9a1
"use strict";
/**
 * VERSATIL SDLC Framework - Performance Monitoring & Analytics System
 *
 * Real-time performance monitoring for Enhanced OPERA agents with
 * comprehensive analytics, metrics collection, and alerting capabilities.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.performanceMonitor = exports.PerformanceMonitor = void 0;
const events_1 = require("events");
const fs = __importStar(require("fs"));
const path = __importStar(require("path"));
class PerformanceMonitor extends events_1.EventEmitter {
    constructor() {
        super();
        this.metrics = new Map();
        this.agentPerformance = new Map();
        this.alerts = [];
        this.isMonitoring = false;
        this.alertThresholds = new Map();
        this.metricsStorePath = path.join(process.cwd(), '.versatil', 'analytics');
        this.initializeThresholds();
        this.ensureStorageDirectory();
        this.loadHistoricalData();
    }
    initializeThresholds() {
        this.alertThresholds.set('execution_time', 5000); // 5 seconds
        this.alertThresholds.set('memory_usage', 100); // 100MB
        this.alertThresholds.set('cpu_usage', 80); // 80%
        this.alertThresholds.set('quality_score', 70); // 70% minimum
        this.alertThresholds.set('issue_detection', 10); // 10+ issues per execution
    }
    ensureStorageDirectory() {
        if (!fs.existsSync(this.metricsStorePath)) {
            fs.mkdirSync(this.metricsStorePath, { recursive: true });
        }
    }
    loadHistoricalData() {
        try {
            const metricsFile = path.join(this.metricsStorePath, 'metrics.json');
            if (fs.existsSync(metricsFile)) {
                const data = JSON.parse(fs.readFileSync(metricsFile, 'utf8'));
                this.metrics = new Map(Object.entries(data.metrics || {}));
                this.agentPerformance = new Map(Object.entries(data.agentPerformance || {}));
            }
        }
        catch (error) {
            console.warn('Could not load historical performance data:', error instanceof Error ? error.message : String(error));
        }
    }
    /**
     * Start performance monitoring
     */
    startMonitoring() {
        if (this.isMonitoring)
            return;
        this.isMonitoring = true;
        console.log('ðŸ” Performance monitoring started');
        // Collect system metrics every 30 seconds
        setInterval(() => {
            this.collectSystemMetrics();
        }, 30000);
        // Save metrics every 5 minutes
        setInterval(() => {
            this.saveMetrics();
        }, 300000);
        // Cleanup old metrics every hour
        setInterval(() => {
            this.cleanupOldMetrics();
        }, 3600000);
        this.emit('monitoring-started');
    }
    /**
     * Stop performance monitoring
     */
    stopMonitoring() {
        this.isMonitoring = false;
        this.saveMetrics();
        console.log('ðŸ›‘ Performance monitoring stopped');
        this.emit('monitoring-stopped');
    }
    /**
     * Record agent execution performance
     */
    recordAgentExecution(agentId, executionTime, issuesDetected, qualityScore, success, context) {
        const timestamp = Date.now();
        // Record execution time metric
        const execMetric = {
            id: `${agentId}-exec-${timestamp}`,
            timestamp,
            agentId,
            metricType: 'execution_time',
            value: executionTime,
            status: this.getMetricStatus('execution_time', executionTime)
        };
        if (context)
            execMetric.context = context;
        const execThreshold = this.alertThresholds.get('execution_time');
        if (execThreshold !== undefined)
            execMetric.threshold = execThreshold;
        this.recordMetric(execMetric);
        // Record issues detected metric
        const issuesMetric = {
            id: `${agentId}-issues-${timestamp}`,
            timestamp,
            agentId,
            metricType: 'issue_detection',
            value: issuesDetected,
            status: this.getMetricStatus('issue_detection', issuesDetected)
        };
        if (context)
            issuesMetric.context = context;
        const issuesThreshold = this.alertThresholds.get('issue_detection');
        if (issuesThreshold !== undefined)
            issuesMetric.threshold = issuesThreshold;
        this.recordMetric(issuesMetric);
        // Record quality score metric
        const qualityMetric = {
            id: `${agentId}-quality-${timestamp}`,
            timestamp,
            agentId,
            metricType: 'quality_score',
            value: qualityScore,
            status: this.getMetricStatus('quality_score', qualityScore)
        };
        if (context)
            qualityMetric.context = context;
        const qualityThreshold = this.alertThresholds.get('quality_score');
        if (qualityThreshold !== undefined)
            qualityMetric.threshold = qualityThreshold;
        this.recordMetric(qualityMetric);
        // Update agent performance data
        this.updateAgentPerformance(agentId, executionTime, issuesDetected, qualityScore, success);
        // Check for alerts
        this.checkAlerts(agentId, executionTime, issuesDetected, qualityScore);
        this.emit('agent-execution-recorded', { agentId, executionTime, issuesDetected, qualityScore, success });
    }
    /**
     * Record system resource metrics
     */
    collectSystemMetrics() {
        const timestamp = Date.now();
        // Get memory usage
        const memoryUsage = process.memoryUsage();
        const memoryValue = memoryUsage.heapUsed / 1024 / 1024; // MB
        const memoryMetric = {
            id: `system-memory-${timestamp}`,
            timestamp,
            agentId: 'system',
            metricType: 'memory_usage',
            value: memoryValue,
            status: this.getMetricStatus('memory_usage', memoryValue)
        };
        const memoryThreshold = this.alertThresholds.get('memory_usage');
        if (memoryThreshold !== undefined)
            memoryMetric.threshold = memoryThreshold;
        this.recordMetric(memoryMetric);
        // Get CPU usage (approximation)
        const cpuUsage = process.cpuUsage();
        const cpuPercent = (cpuUsage.user + cpuUsage.system) / 1000000; // Convert to percentage
        const cpuMetric = {
            id: `system-cpu-${timestamp}`,
            timestamp,
            agentId: 'system',
            metricType: 'cpu_usage',
            value: cpuPercent,
            status: this.getMetricStatus('cpu_usage', cpuPercent)
        };
        const cpuThreshold = this.alertThresholds.get('cpu_usage');
        if (cpuThreshold !== undefined)
            cpuMetric.threshold = cpuThreshold;
        this.recordMetric(cpuMetric);
    }
    /**
     * Record a performance metric
     */
    recordMetric(metric) {
        if (!this.metrics.has(metric.agentId)) {
            this.metrics.set(metric.agentId, []);
        }
        this.metrics.get(metric.agentId).push(metric);
        // Emit metric recorded event
        this.emit('metric-recorded', metric);
        // Log critical metrics
        if (metric.status === 'critical') {
            console.warn(`ðŸš¨ Critical metric: ${metric.agentId} ${metric.metricType} = ${metric.value}`);
        }
    }
    /**
     * Update agent performance data
     */
    updateAgentPerformance(agentId, executionTime, issuesDetected, qualityScore, success) {
        let performance = this.agentPerformance.get(agentId);
        if (!performance) {
            performance = {
                agentId,
                totalExecutions: 0,
                averageExecutionTime: 0,
                maxExecutionTime: 0,
                minExecutionTime: Infinity,
                successRate: 0,
                issuesDetected: 0,
                averageQualityScore: 0,
                memoryUsage: 0,
                cpuUsage: 0,
                lastExecution: 0,
                trend: 'stable'
            };
        }
        // Update execution statistics
        performance.totalExecutions++;
        performance.averageExecutionTime =
            (performance.averageExecutionTime * (performance.totalExecutions - 1) + executionTime) / performance.totalExecutions;
        performance.maxExecutionTime = Math.max(performance.maxExecutionTime, executionTime);
        performance.minExecutionTime = Math.min(performance.minExecutionTime, executionTime);
        performance.issuesDetected += issuesDetected;
        performance.averageQualityScore =
            (performance.averageQualityScore * (performance.totalExecutions - 1) + qualityScore) / performance.totalExecutions;
        performance.lastExecution = Date.now();
        // Calculate success rate
        const successCount = success ? 1 : 0;
        performance.successRate =
            (performance.successRate * (performance.totalExecutions - 1) + successCount) / performance.totalExecutions;
        // Determine trend
        performance.trend = this.calculateTrend(agentId, performance);
        this.agentPerformance.set(agentId, performance);
    }
    /**
     * Calculate performance trend
     */
    calculateTrend(agentId, current) {
        const recentMetrics = this.getRecentMetrics(agentId, 10);
        if (recentMetrics.length < 5)
            return 'stable';
        const recentExecutionTimes = recentMetrics
            .filter(m => m.metricType === 'execution_time')
            .map(m => m.value);
        const recentQualityScores = recentMetrics
            .filter(m => m.metricType === 'quality_score')
            .map(m => m.value);
        if (recentExecutionTimes.length < 3 || recentQualityScores.length < 3)
            return 'stable';
        // Check execution time trend (lower is better)
        const avgRecentExecTime = recentExecutionTimes.slice(-3).reduce((a, b) => a + b, 0) / 3;
        const avgOlderExecTime = recentExecutionTimes.slice(0, 3).reduce((a, b) => a + b, 0) / 3;
        // Check quality score trend (higher is better)
        const avgRecentQuality = recentQualityScores.slice(-3).reduce((a, b) => a + b, 0) / 3;
        const avgOlderQuality = recentQualityScores.slice(0, 3).reduce((a, b) => a + b, 0) / 3;
        const execTimeImproving = avgRecentExecTime < avgOlderExecTime * 0.95;
        const qualityImproving = avgRecentQuality > avgOlderQuality * 1.05;
        const execTimeDeclining = avgRecentExecTime > avgOlderExecTime * 1.05;
        const qualityDeclining = avgRecentQuality < avgOlderQuality * 0.95;
        if (execTimeImproving || qualityImproving)
            return 'improving';
        if (execTimeDeclining || qualityDeclining)
            return 'declining';
        return 'stable';
    }
    /**
     * Check for performance alerts
     */
    checkAlerts(agentId, executionTime, issuesDetected, qualityScore) {
        const timestamp = Date.now();
        // Execution time alert
        const execThreshold = this.alertThresholds.get('execution_time');
        if (executionTime > execThreshold) {
            this.createAlert({
                id: `exec-alert-${agentId}-${timestamp}`,
                timestamp,
                severity: executionTime > execThreshold * 2 ? 'critical' : 'warning',
                agentId,
                message: `Agent ${agentId} execution time exceeded threshold`,
                metric: 'execution_time',
                value: executionTime,
                threshold: execThreshold,
                action: 'Review agent implementation for performance bottlenecks'
            });
        }
        // Quality score alert
        const qualityThreshold = this.alertThresholds.get('quality_score');
        if (qualityScore < qualityThreshold) {
            this.createAlert({
                id: `quality-alert-${agentId}-${timestamp}`,
                timestamp,
                severity: qualityScore < qualityThreshold * 0.5 ? 'critical' : 'warning',
                agentId,
                message: `Agent ${agentId} quality score below threshold`,
                metric: 'quality_score',
                value: qualityScore,
                threshold: qualityThreshold,
                action: 'Review agent validation logic and enhance detection capabilities'
            });
        }
        // Issues detected alert
        const issuesThreshold = this.alertThresholds.get('issue_detection');
        if (issuesDetected > issuesThreshold) {
            this.createAlert({
                id: `issues-alert-${agentId}-${timestamp}`,
                timestamp,
                severity: 'info',
                agentId,
                message: `Agent ${agentId} detected high number of issues`,
                metric: 'issue_detection',
                value: issuesDetected,
                threshold: issuesThreshold,
                action: 'Review codebase quality and address detected issues'
            });
        }
    }
    /**
     * Create performance alert
     */
    createAlert(alert) {
        this.alerts.push(alert);
        // Keep only last 1000 alerts
        if (this.alerts.length > 1000) {
            this.alerts = this.alerts.slice(-1000);
        }
        console.log(`ðŸš¨ Alert: ${alert.severity.toUpperCase()} - ${alert.message}`);
        this.emit('alert-created', alert);
    }
    /**
     * Get metric status based on thresholds
     */
    getMetricStatus(metricType, value) {
        const threshold = this.alertThresholds.get(metricType);
        if (!threshold)
            return 'normal';
        switch (metricType) {
            case 'execution_time':
            case 'memory_usage':
            case 'cpu_usage':
            case 'issue_detection':
                if (value > threshold * 2)
                    return 'critical';
                if (value > threshold)
                    return 'warning';
                return 'normal';
            case 'quality_score':
                if (value < threshold * 0.5)
                    return 'critical';
                if (value < threshold)
                    return 'warning';
                return 'normal';
            default:
                return 'normal';
        }
    }
    /**
     * Get recent metrics for an agent
     */
    getRecentMetrics(agentId, count) {
        const agentMetrics = this.metrics.get(agentId) || [];
        return agentMetrics
            .sort((a, b) => b.timestamp - a.timestamp)
            .slice(0, count);
    }
    /**
     * Get performance dashboard data
     */
    getPerformanceDashboard() {
        const systemData = this.getSystemPerformanceData();
        const agentData = Array.from(this.agentPerformance.values());
        const recentAlerts = this.alerts.slice(-20);
        const trends = this.calculateSystemTrends();
        return {
            system: systemData,
            agents: agentData,
            recentAlerts,
            trends
        };
    }
    /**
     * Get system performance data
     */
    getSystemPerformanceData() {
        const timestamp = Date.now();
        const allAgents = Array.from(this.agentPerformance.values());
        const totalExecutions = allAgents.reduce((sum, agent) => sum + agent.totalExecutions, 0);
        const averageResponseTime = allAgents.reduce((sum, agent) => sum + agent.averageExecutionTime, 0) / allAgents.length || 0;
        const overallQuality = allAgents.reduce((sum, agent) => sum + agent.averageQualityScore, 0) / allAgents.length || 100;
        const recentAlerts = this.alerts.filter(alert => timestamp - alert.timestamp < 3600000); // Last hour
        const criticalIssues = recentAlerts.filter(alert => alert.severity === 'critical').length;
        const highPriorityIssues = recentAlerts.filter(alert => alert.severity === 'warning').length;
        // Get latest system metrics
        const systemMetrics = this.metrics.get('system') || [];
        const latestMemory = systemMetrics
            .filter(m => m.metricType === 'memory_usage')
            .sort((a, b) => b.timestamp - a.timestamp)[0]?.value || 0;
        return {
            timestamp,
            overallHealth: Math.min(100, overallQuality - (criticalIssues * 10) - (highPriorityIssues * 5)),
            totalAgentExecutions: totalExecutions,
            averageResponseTime,
            systemLoad: averageResponseTime > 2000 ? (averageResponseTime / 1000) * 10 : 10,
            memoryUsage: latestMemory,
            activeAgents: allAgents.length,
            criticalIssues,
            highPriorityIssues,
            qualityGateStatus: criticalIssues > 0 ? 'failing' : highPriorityIssues > 5 ? 'warning' : 'passing'
        };
    }
    /**
     * Calculate system trends
     */
    calculateSystemTrends() {
        const trends = {};
        // Calculate trends for each agent
        for (const [agentId, performance] of this.agentPerformance) {
            trends[agentId] = {
                performance: performance.trend,
                executionTime: this.calculateMetricTrend(agentId, 'execution_time'),
                qualityScore: this.calculateMetricTrend(agentId, 'quality_score'),
                issuesDetected: this.calculateMetricTrend(agentId, 'issue_detection')
            };
        }
        return trends;
    }
    /**
     * Calculate trend for specific metric
     */
    calculateMetricTrend(agentId, metricType) {
        const recentMetrics = this.getRecentMetrics(agentId, 20)
            .filter(m => m.metricType === metricType);
        if (recentMetrics.length < 10)
            return 'stable';
        const firstHalf = recentMetrics.slice(0, 10);
        const secondHalf = recentMetrics.slice(10);
        const firstAvg = firstHalf.reduce((sum, m) => sum + m.value, 0) / firstHalf.length;
        const secondAvg = secondHalf.reduce((sum, m) => sum + m.value, 0) / secondHalf.length;
        const threshold = 0.05; // 5% change threshold
        if (metricType === 'quality_score') {
            // For quality score, higher is better
            if (secondAvg > firstAvg * (1 + threshold))
                return 'improving';
            if (secondAvg < firstAvg * (1 - threshold))
                return 'declining';
        }
        else {
            // For execution time and issues, lower is better
            if (secondAvg < firstAvg * (1 - threshold))
                return 'improving';
            if (secondAvg > firstAvg * (1 + threshold))
                return 'declining';
        }
        return 'stable';
    }
    /**
     * Save metrics to disk
     */
    saveMetrics() {
        try {
            const data = {
                metrics: Object.fromEntries(this.metrics),
                agentPerformance: Object.fromEntries(this.agentPerformance),
                alerts: this.alerts.slice(-1000), // Keep last 1000 alerts
                lastSaved: Date.now()
            };
            const metricsFile = path.join(this.metricsStorePath, 'metrics.json');
            fs.writeFileSync(metricsFile, JSON.stringify(data, null, 2));
        }
        catch (error) {
            console.error('Failed to save performance metrics:', error instanceof Error ? error.message : String(error));
        }
    }
    /**
     * Cleanup old metrics (keep last 7 days)
     */
    cleanupOldMetrics() {
        const cutoffTime = Date.now() - (7 * 24 * 60 * 60 * 1000); // 7 days
        for (const [agentId, metrics] of this.metrics) {
            const filteredMetrics = metrics.filter(metric => metric.timestamp > cutoffTime);
            this.metrics.set(agentId, filteredMetrics);
        }
        // Cleanup old alerts
        this.alerts = this.alerts.filter(alert => alert.timestamp > cutoffTime);
    }
    /**
     * Export performance report
     */
    exportReport(format = 'json') {
        const dashboard = this.getPerformanceDashboard();
        if (format === 'json') {
            return JSON.stringify(dashboard, null, 2);
        }
        // CSV format
        let csv = 'Agent,Total Executions,Avg Execution Time,Max Execution Time,Success Rate,Avg Quality Score,Issues Detected,Trend\n';
        dashboard.agents.forEach(agent => {
            csv += `${agent.agentId},${agent.totalExecutions},${agent.averageExecutionTime.toFixed(2)},${agent.maxExecutionTime},${(agent.successRate * 100).toFixed(1)}%,${agent.averageQualityScore.toFixed(1)},${agent.issuesDetected},${agent.trend}\n`;
        });
        return csv;
    }
    /**
     * Get agent performance summary
     */
    getAgentSummary(agentId) {
        return this.agentPerformance.get(agentId) || null;
    }
    /**
     * Get system health score
     */
    getSystemHealthScore() {
        return this.getSystemPerformanceData().overallHealth;
    }
    /**
     * Get active alerts
     */
    getActiveAlerts() {
        const oneHourAgo = Date.now() - 3600000;
        return this.alerts.filter(alert => alert.timestamp > oneHourAgo);
    }
    /**
     * Start monitoring (for server integration)
     */
    start() {
        if (!this.isMonitoring) {
            this.startMonitoring();
        }
    }
    /**
     * Get Prometheus-compatible metrics
     */
    getPrometheusMetrics() {
        const dashboard = this.getPerformanceDashboard();
        let metrics = '';
        // System metrics
        metrics += `# HELP versatil_system_health Overall system health score\n`;
        metrics += `# TYPE versatil_system_health gauge\n`;
        metrics += `versatil_system_health ${dashboard.system.overallHealth}\n\n`;
        metrics += `# HELP versatil_total_executions Total agent executions\n`;
        metrics += `# TYPE versatil_total_executions counter\n`;
        metrics += `versatil_total_executions ${dashboard.system.totalAgentExecutions}\n\n`;
        metrics += `# HELP versatil_response_time_avg Average response time\n`;
        metrics += `# TYPE versatil_response_time_avg gauge\n`;
        metrics += `versatil_response_time_avg ${dashboard.system.averageResponseTime}\n\n`;
        // Agent-specific metrics
        dashboard.agents.forEach(agent => {
            metrics += `# HELP versatil_agent_executions Agent execution count\n`;
            metrics += `# TYPE versatil_agent_executions counter\n`;
            metrics += `versatil_agent_executions{agent="${agent.agentId}"} ${agent.totalExecutions}\n\n`;
            metrics += `# HELP versatil_agent_quality_score Agent quality score\n`;
            metrics += `# TYPE versatil_agent_quality_score gauge\n`;
            metrics += `versatil_agent_quality_score{agent="${agent.agentId}"} ${agent.averageQualityScore}\n\n`;
            metrics += `# HELP versatil_agent_issues_detected Issues detected by agent\n`;
            metrics += `# TYPE versatil_agent_issues_detected counter\n`;
            metrics += `versatil_agent_issues_detected{agent="${agent.agentId}"} ${agent.issuesDetected}\n\n`;
        });
        return metrics;
    }
    getMetrics() {
        return this.getPerformanceDashboard();
    }
    getAdaptiveInsights() {
        return {
            trends: this.calculateSystemTrends(),
            health: this.getSystemHealthScore(),
            recommendations: []
        };
    }
    isHealthy() {
        return this.getSystemHealthScore() >= 70;
    }
}
exports.PerformanceMonitor = PerformanceMonitor;
// Export singleton instance
exports.performanceMonitor = new PerformanceMonitor();
exports.default = exports.performanceMonitor;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL25pc3NpbW1lbmFzaGUvVkVSU0FUSUwgU0RMQyBGVy9zcmMvYW5hbHl0aWNzL3BlcmZvcm1hbmNlLW1vbml0b3IudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCxtQ0FBc0M7QUFDdEMsdUNBQXlCO0FBQ3pCLDJDQUE2QjtBQXFEN0IsTUFBYSxrQkFBbUIsU0FBUSxxQkFBWTtJQVFsRDtRQUNFLEtBQUssRUFBRSxDQUFDO1FBUkYsWUFBTyxHQUFxQyxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBQ3RELHFCQUFnQixHQUFzQyxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBQ2hFLFdBQU0sR0FBdUIsRUFBRSxDQUFDO1FBQ2hDLGlCQUFZLEdBQVksS0FBSyxDQUFDO1FBRTlCLG9CQUFlLEdBQXdCLElBQUksR0FBRyxFQUFFLENBQUM7UUFJdkQsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxFQUFFLFdBQVcsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUMzRSxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztRQUM1QixJQUFJLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztRQUM5QixJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztJQUM1QixDQUFDO0lBRU8sb0JBQW9CO1FBQzFCLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLGdCQUFnQixFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsWUFBWTtRQUM5RCxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxRQUFRO1FBQ3ZELElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU07UUFDakQsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFFLEVBQUUsQ0FBQyxD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Q0FBQyxPQUFPLE1BQU0sS0FBSyxDQUFDLGVBQWUsTUFBTSxDQUFDO1lBRTlGLE9BQU8sSUFBSSwyREFBMkQsQ0FBQztZQUN2RSxPQUFPLElBQUksNkNBQTZDLENBQUM7WUFDekQsT0FBTyxJQUFJLHVDQUF1QyxLQUFLLENBQUMsT0FBTyxNQUFNLEtBQUssQ0FBQyxtQkFBbUIsTUFBTSxDQUFDO1lBRXJHLE9BQU8sSUFBSSxrRUFBa0UsQ0FBQztZQUM5RSxPQUFPLElBQUksaURBQWlELENBQUM7WUFDN0QsT0FBTyxJQUFJLHlDQUF5QyxLQUFLLENBQUMsT0FBTyxNQUFNLEtBQUssQ0FBQyxjQUFjLE1BQU0sQ0FBQztRQUNwRyxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxVQUFVO1FBQ1IsT0FBTyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQztJQUN4QyxDQUFDO0lBRUQsbUJBQW1CO1FBQ2pCLE9BQU87WUFDTCxNQUFNLEVBQUUsSUFBSSxDQUFDLHFCQUFxQixFQUFFO1lBQ3BDLE1BQU0sRUFBRSxJQUFJLENBQUMsb0JBQW9CLEVBQUU7WUFDbkMsZUFBZSxFQUFFLEVBQUU7U0FDcEIsQ0FBQztJQUNKLENBQUM7SUFFRCxTQUFTO1FBQ1AsT0FBTyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDM0MsQ0FBQztDQUNGO0FBN25CRCxnREE2bkJDO0FBRUQsNEJBQTRCO0FBQ2YsUUFBQSxrQkFBa0IsR0FBRyxJQUFJLGtCQUFrQixFQUFFLENBQUM7QUFDM0Qsa0JBQWUsMEJBQWtCLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL25pc3NpbW1lbmFzaGUvVkVSU0FUSUwgU0RMQyBGVy9zcmMvYW5hbHl0aWNzL3BlcmZvcm1hbmNlLW1vbml0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBWRVJTQVRJTCBTRExDIEZyYW1ld29yayAtIFBlcmZvcm1hbmNlIE1vbml0b3JpbmcgJiBBbmFseXRpY3MgU3lzdGVtXG4gKlxuICogUmVhbC10aW1lIHBlcmZvcm1hbmNlIG1vbml0b3JpbmcgZm9yIEVuaGFuY2VkIE9QRVJBIGFnZW50cyB3aXRoXG4gKiBjb21wcmVoZW5zaXZlIGFuYWx5dGljcywgbWV0cmljcyBjb2xsZWN0aW9uLCBhbmQgYWxlcnRpbmcgY2FwYWJpbGl0aWVzLlxuICovXG5cbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFBlcmZvcm1hbmNlTWV0cmljIHtcbiAgaWQ6IHN0cmluZztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIGFnZW50SWQ6IHN0cmluZztcbiAgbWV0cmljVHlwZTogJ2V4ZWN1dGlvbl90aW1lJyB8ICdtZW1vcnlfdXNhZ2UnIHwgJ2NwdV91c2FnZScgfCAnaXNzdWVfZGV0ZWN0aW9uJyB8ICdxdWFsaXR5X3Njb3JlJztcbiAgdmFsdWU6IG51bWJlcjtcbiAgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIHRocmVzaG9sZD86IG51bWJlcjtcbiAgc3RhdHVzOiAnbm9ybWFsJyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWdlbnRQZXJmb3JtYW5jZURhdGEge1xuICBhZ2VudElkOiBzdHJpbmc7XG4gIHRvdGFsRXhlY3V0aW9uczogbnVtYmVyO1xuICBhdmVyYWdlRXhlY3V0aW9uVGltZTogbnVtYmVyO1xuICBtYXhFeGVjdXRpb25UaW1lOiBudW1iZXI7XG4gIG1pbkV4ZWN1dGlvblRpbWU6IG51bWJlcjtcbiAgc3VjY2Vzc1JhdGU6IG51bWJlcjtcbiAgaXNzdWVzRGV0ZWN0ZWQ6IG51bWJlcjtcbiAgYXZlcmFnZVF1YWxpdHlTY29yZTogbnVtYmVyO1xuICBtZW1vcnlVc2FnZTogbnVtYmVyO1xuICBjcHVVc2FnZTogbnVtYmVyO1xuICBsYXN0RXhlY3V0aW9uOiBudW1iZXI7XG4gIHRyZW5kOiAnaW1wcm92aW5nJyB8ICdzdGFibGUnIHwgJ2RlY2xpbmluZyc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3lzdGVtUGVyZm9ybWFuY2VEYXRhIHtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIG92ZXJhbGxIZWFsdGg6IG51bWJlcjtcbiAgdG90YWxBZ2VudEV4ZWN1dGlvbnM6IG51bWJlcjtcbiAgYXZlcmFnZVJlc3BvbnNlVGltZTogbnVtYmVyO1xuICBzeXN0ZW1Mb2FkOiBudW1iZXI7XG4gIG1lbW9yeVVzYWdlOiBudW1iZXI7XG4gIGFjdGl2ZUFnZW50czogbnVtYmVyO1xuICBjcml0aWNhbElzc3VlczogbnVtYmVyO1xuICBoaWdoUHJpb3JpdHlJc3N1ZXM6IG51bWJlcjtcbiAgcXVhbGl0eUdhdGVTdGF0dXM6ICdwYXNzaW5nJyB8ICd3YXJuaW5nJyB8ICdmYWlsaW5nJztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQZXJmb3JtYW5jZUFsZXJ0IHtcbiAgaWQ6IHN0cmluZztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIHNldmVyaXR5OiAnaW5mbycgfCAnd2FybmluZycgfCAnY3JpdGljYWwnO1xuICBhZ2VudElkPzogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIG1ldHJpYzogc3RyaW5nO1xuICB2YWx1ZTogbnVtYmVyO1xuICB0aHJlc2hvbGQ6IG51bWJlcjtcbiAgYWN0aW9uOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBQZXJmb3JtYW5jZU1vbml0b3IgZXh0ZW5kcyBFdmVudEVtaXR0ZXIge1xuICBwcml2YXRlIG1ldHJpY3M6IE1hcDxzdHJpbmcsIFBlcmZvcm1hbmNlTWV0cmljW10+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIGFnZW50UGVyZm9ybWFuY2U6IE1hcDxzdHJpbmcsIEFnZW50UGVyZm9ybWFuY2VEYXRhPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBhbGVydHM6IFBlcmZvcm1hbmNlQWxlcnRbXSA9IFtdO1xuICBwcml2YXRlIGlzTW9uaXRvcmluZzogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIG1ldHJpY3NTdG9yZVBhdGg6IHN0cmluZztcbiAgcHJpdmF0ZSBhbGVydFRocmVzaG9sZHM6IE1hcDxzdHJpbmcsIG51bWJlcj4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm1ldHJpY3NTdG9yZVBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJy52ZXJzYXRpbCcsICdhbmFseXRpY3MnKTtcbiAgICB0aGlzLmluaXRpYWxpemVUaHJlc2hvbGRzKCk7XG4gICAgdGhpcy5lbnN1cmVTdG9yYWdlRGlyZWN0b3J5KCk7XG4gICAgdGhpcy5sb2FkSGlzdG9yaWNhbERhdGEoKTtcbiAgfVxuXG4gIHByaXZhdGUgaW5pdGlhbGl6ZVRocmVzaG9sZHMoKTogdm9pZCB7XG4gICAgdGhpcy5hbGVydFRocmVzaG9sZHMuc2V0KCdleGVjdXRpb25fdGltZScsIDUwMDApOyAvLyA1IHNlY29uZHNcbiAgICB0aGlzLmFsZXJ0VGhyZXNob2xkcy5zZXQoJ21lbW9yeV91c2FnZScsIDEwMCk7IC8vIDEwME1CXG4gICAgdGhpcy5hbGVydFRocmVzaG9sZHMuc2V0KCdjcHVfdXNhZ2UnLCA4MCk7IC8vIDgwJVxuICAgIHRoaXMuYWxlcnRUaHJlc2hvbGRzLnNldCgncXVhbGl0eV9zY29yZScsIDcwKTsgLy8gNzAlIG1pbmltdW1cbiAgICB0aGlzLmFsZXJ0VGhyZXNob2xkcy5zZXQoJ2lzc3VlX2RldGVjdGlvbicsIDEwKTsgLy8gMTArIGlzc3VlcyBwZXIgZXhlY3V0aW9uXG4gIH1cblxuICBwcml2YXRlIGVuc3VyZVN0b3JhZ2VEaXJlY3RvcnkoKTogdm9pZCB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHRoaXMubWV0cmljc1N0b3JlUGF0aCkpIHtcbiAgICAgIGZzLm1rZGlyU3luYyh0aGlzLm1ldHJpY3NTdG9yZVBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgbG9hZEhpc3RvcmljYWxEYXRhKCk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBtZXRyaWNzRmlsZSA9IHBhdGguam9pbih0aGlzLm1ldHJpY3NTdG9yZVBhdGgsICdtZXRyaWNzLmpzb24nKTtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKG1ldHJpY3NGaWxlKSkge1xuICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMobWV0cmljc0ZpbGUsICd1dGY4JykpO1xuICAgICAgICB0aGlzLm1ldHJpY3MgPSBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKGRhdGEubWV0cmljcyB8fCB7fSkpO1xuICAgICAgICB0aGlzLmFnZW50UGVyZm9ybWFuY2UgPSBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKGRhdGEuYWdlbnRQZXJmb3JtYW5jZSB8fCB7fSkpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBsb2FkIGhpc3RvcmljYWwgcGVyZm9ybWFuY2UgZGF0YTonLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCBwZXJmb3JtYW5jZSBtb25pdG9yaW5nXG4gICAqL1xuICBwdWJsaWMgc3RhcnRNb25pdG9yaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzTW9uaXRvcmluZykgcmV0dXJuO1xuXG4gICAgdGhpcy5pc01vbml0b3JpbmcgPSB0cnVlO1xuICAgIGNvbnNvbGUubG9nKCfwn5SNIFBlcmZvcm1hbmNlIG1vbml0b3Jpbmcgc3RhcnRlZCcpO1xuXG4gICAgLy8gQ29sbGVjdCBzeXN0ZW0gbWV0cmljcyBldmVyeSAzMCBzZWNvbmRzXG4gICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgdGhpcy5jb2xsZWN0U3lzdGVtTWV0cmljcygpO1xuICAgIH0sIDMwMDAwKTtcblxuICAgIC8vIFNhdmUgbWV0cmljcyBldmVyeSA1IG1pbnV0ZXNcbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLnNhdmVNZXRyaWNzKCk7XG4gICAgfSwgMzAwMDAwKTtcblxuICAgIC8vIENsZWFudXAgb2xkIG1ldHJpY3MgZXZlcnkgaG91clxuICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMuY2xlYW51cE9sZE1ldHJpY3MoKTtcbiAgICB9LCAzNjAwMDAwKTtcblxuICAgIHRoaXMuZW1pdCgnbW9uaXRvcmluZy1zdGFydGVkJyk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCBwZXJmb3JtYW5jZSBtb25pdG9yaW5nXG4gICAqL1xuICBwdWJsaWMgc3RvcE1vbml0b3JpbmcoKTogdm9pZCB7XG4gICAgdGhpcy5pc01vbml0b3JpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnNhdmVNZXRyaWNzKCk7XG4gICAgY29uc29sZS5sb2coJ/Cfm5EgUGVyZm9ybWFuY2UgbW9uaXRvcmluZyBzdG9wcGVkJyk7XG4gICAgdGhpcy5lbWl0KCdtb25pdG9yaW5nLXN0b3BwZWQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWNvcmQgYWdlbnQgZXhlY3V0aW9uIHBlcmZvcm1hbmNlXG4gICAqL1xuICBwdWJsaWMgcmVjb3JkQWdlbnRFeGVjdXRpb24oXG4gICAgYWdlbnRJZDogc3RyaW5nLFxuICAgIGV4ZWN1dGlvblRpbWU6IG51bWJlcixcbiAgICBpc3N1ZXNEZXRlY3RlZDogbnVtYmVyLFxuICAgIHF1YWxpdHlTY29yZTogbnVtYmVyLFxuICAgIHN1Y2Nlc3M6IGJvb2xlYW4sXG4gICAgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgKTogdm9pZCB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKTtcblxuICAgIC8vIFJlY29yZCBleGVjdXRpb24gdGltZSBtZXRyaWNcbiAgICBjb25zdCBleGVjTWV0cmljOiBQZXJmb3JtYW5jZU1ldHJpYyA9IHtcbiAgICAgIGlkOiBgJHthZ2VudElkfS1leGVjLSR7dGltZXN0YW1wfWAsXG4gICAgICB0aW1lc3RhbXAsXG4gICAgICBhZ2VudElkLFxuICAgICAgbWV0cmljVHlwZTogJ2V4ZWN1dGlvbl90aW1lJyxcbiAgICAgIHZhbHVlOiBleGVjdXRpb25UaW1lLFxuICAgICAgc3RhdHVzOiB0aGlzLmdldE1ldHJpY1N0YXR1cygnZXhlY3V0aW9uX3RpbWUnLCBleGVjdXRpb25UaW1lKVxuICAgIH07XG4gICAgaWYgKGNvbnRleHQpIGV4ZWNNZXRyaWMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgY29uc3QgZXhlY1RocmVzaG9sZCA9IHRoaXMuYWxlcnRUaHJlc2hvbGRzLmdldCgnZXhlY3V0aW9uX3RpbWUnKTtcbiAgICBpZiAoZXhlY1RocmVzaG9sZCAhPT0gdW5kZWZpbmVkKSBleGVjTWV0cmljLnRocmVzaG9sZCA9IGV4ZWNUaHJlc2hvbGQ7XG4gICAgdGhpcy5yZWNvcmRNZXRyaWMoZXhlY01ldHJpYyk7XG5cbiAgICAvLyBSZWNvcmQgaXNzdWVzIGRldGVjdGVkIG1ldHJpY1xuICAgIGNvbnN0IGlzc3Vlc01ldHJpYzogUGVyZm9ybWFuY2VNZXRyaWMgPSB7XG4gICAgICBpZDogYCR7YWdlbnRJZH0taXNzdWVzLSR7dGltZXN0YW1wfWAsXG4gICAgICB0aW1lc3RhbXAsXG4gICAgICBhZ2VudElkLFxuICAgICAgbWV0cmljVHlwZTogJ2lzc3VlX2RldGVjdGlvbicsXG4gICAgICB2YWx1ZTogaXNzdWVzRGV0ZWN0ZWQsXG4gICAgICBzdGF0dXM6IHRoaXMuZ2V0TWV0cmljU3RhdHVzKCdpc3N1ZV9kZXRlY3Rpb24nLCBpc3N1ZXNEZXRlY3RlZClcbiAgICB9O1xuICAgIGlmIChjb250ZXh0KSBpc3N1ZXNNZXRyaWMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgY29uc3QgaXNzdWVzVGhyZXNob2xkID0gdGhpcy5hbGVydFRocmVzaG9sZHMuZ2V0KCdpc3N1ZV9kZXRlY3Rpb24nKTtcbiAgICBpZiAoaXNzdWVzVGhyZXNob2xkICE9PSB1bmRlZmluZWQpIGlzc3Vlc01ldHJpYy50aHJlc2hvbGQgPSBpc3N1ZXNUaHJlc2hvbGQ7XG4gICAgdGhpcy5yZWNvcmRNZXRyaWMoaXNzdWVzTWV0cmljKTtcblxuICAgIC8vIFJlY29yZCBxdWFsaXR5IHNjb3JlIG1ldHJpY1xuICAgIGNvbnN0IHF1YWxpdHlNZXRyaWM6IFBlcmZvcm1hbmNlTWV0cmljID0ge1xuICAgICAgaWQ6IGAke2FnZW50SWR9LXF1YWxpdHktJHt0aW1lc3RhbXB9YCxcbiAgICAgIHRpbWVzdGFtcCxcbiAgICAgIGFnZW50SWQsXG4gICAgICBtZXRyaWNUeXBlOiAncXVhbGl0eV9zY29yZScsXG4gICAgICB2YWx1ZTogcXVhbGl0eVNjb3JlLFxuICAgICAgc3RhdHVzOiB0aGlzLmdldE1ldHJpY1N0YXR1cygncXVhbGl0eV9zY29yZScsIHF1YWxpdHlTY29yZSlcbiAgICB9O1xuICAgIGlmIChjb250ZXh0KSBxdWFsaXR5TWV0cmljLmNvbnRleHQgPSBjb250ZXh0O1xuICAgIGNvbnN0IHF1YWxpdHlUaHJlc2hvbGQgPSB0aGlzLmFsZXJ0VGhyZXNob2xkcy5nZXQoJ3F1YWxpdHlfc2NvcmUnKTtcbiAgICBpZiAocXVhbGl0eVRocmVzaG9sZCAhPT0gdW5kZWZpbmVkKSBxdWFsaXR5TWV0cmljLnRocmVzaG9sZCA9IHF1YWxpdHlUaHJlc2hvbGQ7XG4gICAgdGhpcy5yZWNvcmRNZXRyaWMocXVhbGl0eU1ldHJpYyk7XG5cbiAgICAvLyBVcGRhdGUgYWdlbnQgcGVyZm9ybWFuY2UgZGF0YVxuICAgIHRoaXMudXBkYXRlQWdlbnRQZXJmb3JtYW5jZShhZ2VudElkLCBleGVjdXRpb25UaW1lLCBpc3N1ZXNEZXRlY3RlZCwgcXVhbGl0eVNjb3JlLCBzdWNjZXNzKTtcblxuICAgIC8vIENoZWNrIGZvciBhbGVydHNcbiAgICB0aGlzLmNoZWNrQWxlcnRzKGFnZW50SWQsIGV4ZWN1dGlvblRpbWUsIGlzc3Vlc0RldGVjdGVkLCBxdWFsaXR5U2NvcmUpO1xuXG4gICAgdGhpcy5lbWl0KCdhZ2VudC1leGVjdXRpb24tcmVjb3JkZWQnLCB7IGFnZW50SWQsIGV4ZWN1dGlvblRpbWUsIGlzc3Vlc0RldGVjdGVkLCBxdWFsaXR5U2NvcmUsIHN1Y2Nlc3MgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIHN5c3RlbSByZXNvdXJjZSBtZXRyaWNzXG4gICAqL1xuICBwcml2YXRlIGNvbGxlY3RTeXN0ZW1NZXRyaWNzKCk6IHZvaWQge1xuICAgIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCk7XG5cbiAgICAvLyBHZXQgbWVtb3J5IHVzYWdlXG4gICAgY29uc3QgbWVtb3J5VXNhZ2UgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCk7XG4gICAgY29uc3QgbWVtb3J5VmFsdWUgPSBtZW1vcnlVc2FnZS5oZWFwVXNlZCAvIDEwMjQgLyAxMDI0OyAvLyBNQlxuICAgIGNvbnN0IG1lbW9yeU1ldHJpYzogUGVyZm9ybWFuY2VNZXRyaWMgPSB7XG4gICAgICBpZDogYHN5c3RlbS1tZW1vcnktJHt0aW1lc3RhbXB9YCxcbiAgICAgIHRpbWVzdGFtcCxcbiAgICAgIGFnZW50SWQ6ICdzeXN0ZW0nLFxuICAgICAgbWV0cmljVHlwZTogJ21lbW9yeV91c2FnZScsXG4gICAgICB2YWx1ZTogbWVtb3J5VmFsdWUsXG4gICAgICBzdGF0dXM6IHRoaXMuZ2V0TWV0cmljU3RhdHVzKCdtZW1vcnlfdXNhZ2UnLCBtZW1vcnlWYWx1ZSlcbiAgICB9O1xuICAgIGNvbnN0IG1lbW9yeVRocmVzaG9sZCA9IHRoaXMuYWxlcnRUaHJlc2hvbGRzLmdldCgnbWVtb3J5X3VzYWdlJyk7XG4gICAgaWYgKG1lbW9yeVRocmVzaG9sZCAhPT0gdW5kZWZpbmVkKSBtZW1vcnlNZXRyaWMudGhyZXNob2xkID0gbWVtb3J5VGhyZXNob2xkO1xuICAgIHRoaXMucmVjb3JkTWV0cmljKG1lbW9yeU1ldHJpYyk7XG5cbiAgICAvLyBHZXQgQ1BVIHVzYWdlIChhcHByb3hpbWF0aW9uKVxuICAgIGNvbnN0IGNwdVVzYWdlID0gcHJvY2Vzcy5jcHVVc2FnZSgpO1xuICAgIGNvbnN0IGNwdVBlcmNlbnQgPSAoY3B1VXNhZ2UudXNlciArIGNwdVVzYWdlLnN5c3RlbSkgLyAxMDAwMDAwOyAvLyBDb252ZXJ0IHRvIHBlcmNlbnRhZ2VcbiAgICBjb25zdCBjcHVNZXRyaWM6IFBlcmZvcm1hbmNlTWV0cmljID0ge1xuICAgICAgaWQ6IGBzeXN0ZW0tY3B1LSR7dGltZXN0YW1wfWAsXG4gICAgICB0aW1lc3RhbXAsXG4gICAgICBhZ2VudElkOiAnc3lzdGVtJyxcbiAgICAgIG1ldHJpY1R5cGU6ICdjcHVfdXNhZ2UnLFxuICAgICAgdmFsdWU6IGNwdVBlcmNlbnQsXG4gICAgICBzdGF0dXM6IHRoaXMuZ2V0TWV0cmljU3RhdHVzKCdjcHVfdXNhZ2UnLCBjcHVQZXJjZW50KVxuICAgIH07XG4gICAgY29uc3QgY3B1VGhyZXNob2xkID0gdGhpcy5hbGVydFRocmVzaG9sZHMuZ2V0KCdjcHVfdXNhZ2UnKTtcbiAgICBpZiAoY3B1VGhyZXNob2xkICE9PSB1bmRlZmluZWQpIGNwdU1ldHJpYy50aHJlc2hvbGQgPSBjcHVUaHJlc2hvbGQ7XG4gICAgdGhpcy5yZWNvcmRNZXRyaWMoY3B1TWV0cmljKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWNvcmQgYSBwZXJmb3JtYW5jZSBtZXRyaWNcbiAgICovXG4gIHByaXZhdGUgcmVjb3JkTWV0cmljKG1ldHJpYzogUGVyZm9ybWFuY2VNZXRyaWMpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMubWV0cmljcy5oYXMobWV0cmljLmFnZW50SWQpKSB7XG4gICAgICB0aGlzLm1ldHJpY3Muc2V0KG1ldHJpYy5hZ2VudElkLCBbXSk7XG4gICAgfVxuXG4gICAgdGhpcy5tZXRyaWNzLmdldChtZXRyaWMuYWdlbnRJZCkhLnB1c2gobWV0cmljKTtcblxuICAgIC8vIEVtaXQgbWV0cmljIHJlY29yZGVkIGV2ZW50XG4gICAgdGhpcy5lbWl0KCdtZXRyaWMtcmVjb3JkZWQnLCBtZXRyaWMpO1xuXG4gICAgLy8gTG9nIGNyaXRpY2FsIG1ldHJpY3NcbiAgICBpZiAobWV0cmljLnN0YXR1cyA9PT0gJ2NyaXRpY2FsJykge1xuICAgICAgY29uc29sZS53YXJuKGDwn5qoIENyaXRpY2FsIG1ldHJpYzogJHttZXRyaWMuYWdlbnRJZH0gJHttZXRyaWMubWV0cmljVHlwZX0gPSAke21ldHJpYy52YWx1ZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGFnZW50IHBlcmZvcm1hbmNlIGRhdGFcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQWdlbnRQZXJmb3JtYW5jZShcbiAgICBhZ2VudElkOiBzdHJpbmcsXG4gICAgZXhlY3V0aW9uVGltZTogbnVtYmVyLFxuICAgIGlzc3Vlc0RldGVjdGVkOiBudW1iZXIsXG4gICAgcXVhbGl0eVNjb3JlOiBudW1iZXIsXG4gICAgc3VjY2VzczogYm9vbGVhblxuICApOiB2b2lkIHtcbiAgICBsZXQgcGVyZm9ybWFuY2UgPSB0aGlzLmFnZW50UGVyZm9ybWFuY2UuZ2V0KGFnZW50SWQpO1xuXG4gICAgaWYgKCFwZXJmb3JtYW5jZSkge1xuICAgICAgcGVyZm9ybWFuY2UgPSB7XG4gICAgICAgIGFnZW50SWQsXG4gICAgICAgIHRvdGFsRXhlY3V0aW9uczogMCxcbiAgICAgICAgYXZlcmFnZUV4ZWN1dGlvblRpbWU6IDAsXG4gICAgICAgIG1heEV4ZWN1dGlvblRpbWU6IDAsXG4gICAgICAgIG1pbkV4ZWN1dGlvblRpbWU6IEluZmluaXR5LFxuICAgICAgICBzdWNjZXNzUmF0ZTogMCxcbiAgICAgICAgaXNzdWVzRGV0ZWN0ZWQ6IDAsXG4gICAgICAgIGF2ZXJhZ2VRdWFsaXR5U2NvcmU6IDAsXG4gICAgICAgIG1lbW9yeVVzYWdlOiAwLFxuICAgICAgICBjcHVVc2FnZTogMCxcbiAgICAgICAgbGFzdEV4ZWN1dGlvbjogMCxcbiAgICAgICAgdHJlbmQ6ICdzdGFibGUnXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBleGVjdXRpb24gc3RhdGlzdGljc1xuICAgIHBlcmZvcm1hbmNlLnRvdGFsRXhlY3V0aW9ucysrO1xuICAgIHBlcmZvcm1hbmNlLmF2ZXJhZ2VFeGVjdXRpb25UaW1lID1cbiAgICAgIChwZXJmb3JtYW5jZS5hdmVyYWdlRXhlY3V0aW9uVGltZSAqIChwZXJmb3JtYW5jZS50b3RhbEV4ZWN1dGlvbnMgLSAxKSArIGV4ZWN1dGlvblRpbWUpIC8gcGVyZm9ybWFuY2UudG90YWxFeGVjdXRpb25zO1xuICAgIHBlcmZvcm1hbmNlLm1heEV4ZWN1dGlvblRpbWUgPSBNYXRoLm1heChwZXJmb3JtYW5jZS5tYXhFeGVjdXRpb25UaW1lLCBleGVjdXRpb25UaW1lKTtcbiAgICBwZXJmb3JtYW5jZS5taW5FeGVjdXRpb25UaW1lID0gTWF0aC5taW4ocGVyZm9ybWFuY2UubWluRXhlY3V0aW9uVGltZSwgZXhlY3V0aW9uVGltZSk7XG4gICAgcGVyZm9ybWFuY2UuaXNzdWVzRGV0ZWN0ZWQgKz0gaXNzdWVzRGV0ZWN0ZWQ7XG4gICAgcGVyZm9ybWFuY2UuYXZlcmFnZVF1YWxpdHlTY29yZSA9XG4gICAgICAocGVyZm9ybWFuY2UuYXZlcmFnZVF1YWxpdHlTY29yZSAqIChwZXJmb3JtYW5jZS50b3RhbEV4ZWN1dGlvbnMgLSAxKSArIHF1YWxpdHlTY29yZSkgLyBwZXJmb3JtYW5jZS50b3RhbEV4ZWN1dGlvbnM7XG4gICAgcGVyZm9ybWFuY2UubGFzdEV4ZWN1dGlvbiA9IERhdGUubm93KCk7XG5cbiAgICAvLyBDYWxjdWxhdGUgc3VjY2VzcyByYXRlXG4gICAgY29uc3Qgc3VjY2Vzc0NvdW50ID0gc3VjY2VzcyA/IDEgOiAwO1xuICAgIHBlcmZvcm1hbmNlLnN1Y2Nlc3NSYXRlID1cbiAgICAgIChwZXJmb3JtYW5jZS5zdWNjZXNzUmF0ZSAqIChwZXJmb3JtYW5jZS50b3RhbEV4ZWN1dGlvbnMgLSAxKSArIHN1Y2Nlc3NDb3VudCkgLyBwZXJmb3JtYW5jZS50b3RhbEV4ZWN1dGlvbnM7XG5cbiAgICAvLyBEZXRlcm1pbmUgdHJlbmRcbiAgICBwZXJmb3JtYW5jZS50cmVuZCA9IHRoaXMuY2FsY3VsYXRlVHJlbmQoYWdlbnRJZCwgcGVyZm9ybWFuY2UpO1xuXG4gICAgdGhpcy5hZ2VudFBlcmZvcm1hbmNlLnNldChhZ2VudElkLCBwZXJmb3JtYW5jZSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHBlcmZvcm1hbmNlIHRyZW5kXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZVRyZW5kKGFnZW50SWQ6IHN0cmluZywgY3VycmVudDogQWdlbnRQZXJmb3JtYW5jZURhdGEpOiAnaW1wcm92aW5nJyB8ICdzdGFibGUnIHwgJ2RlY2xpbmluZycge1xuICAgIGNvbnN0IHJlY2VudE1ldHJpY3MgPSB0aGlzLmdldFJlY2VudE1ldHJpY3MoYWdlbnRJZCwgMTApO1xuICAgIGlmIChyZWNlbnRNZXRyaWNzLmxlbmd0aCA8IDUpIHJldHVybiAnc3RhYmxlJztcblxuICAgIGNvbnN0IHJlY2VudEV4ZWN1dGlvblRpbWVzID0gcmVjZW50TWV0cmljc1xuICAgICAgLmZpbHRlcihtID0+IG0ubWV0cmljVHlwZSA9PT0gJ2V4ZWN1dGlvbl90aW1lJylcbiAgICAgIC5tYXAobSA9PiBtLnZhbHVlKTtcblxuICAgIGNvbnN0IHJlY2VudFF1YWxpdHlTY29yZXMgPSByZWNlbnRNZXRyaWNzXG4gICAgICAuZmlsdGVyKG0gPT4gbS5tZXRyaWNUeXBlID09PSAncXVhbGl0eV9zY29yZScpXG4gICAgICAubWFwKG0gPT4gbS52YWx1ZSk7XG5cbiAgICBpZiAocmVjZW50RXhlY3V0aW9uVGltZXMubGVuZ3RoIDwgMyB8fCByZWNlbnRRdWFsaXR5U2NvcmVzLmxlbmd0aCA8IDMpIHJldHVybiAnc3RhYmxlJztcblxuICAgIC8vIENoZWNrIGV4ZWN1dGlvbiB0aW1lIHRyZW5kIChsb3dlciBpcyBiZXR0ZXIpXG4gICAgY29uc3QgYXZnUmVjZW50RXhlY1RpbWUgPSByZWNlbnRFeGVjdXRpb25UaW1lcy5zbGljZSgtMykucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkgLyAzO1xuICAgIGNvbnN0IGF2Z09sZGVyRXhlY1RpbWUgPSByZWNlbnRFeGVjdXRpb25UaW1lcy5zbGljZSgwLCAzKS5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIDM7XG5cbiAgICAvLyBDaGVjayBxdWFsaXR5IHNjb3JlIHRyZW5kIChoaWdoZXIgaXMgYmV0dGVyKVxuICAgIGNvbnN0IGF2Z1JlY2VudFF1YWxpdHkgPSByZWNlbnRRdWFsaXR5U2NvcmVzLnNsaWNlKC0zKS5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIDM7XG4gICAgY29uc3QgYXZnT2xkZXJRdWFsaXR5ID0gcmVjZW50UXVhbGl0eVNjb3Jlcy5zbGljZSgwLCAzKS5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIDM7XG5cbiAgICBjb25zdCBleGVjVGltZUltcHJvdmluZyA9IGF2Z1JlY2VudEV4ZWNUaW1lIDwgYXZnT2xkZXJFeGVjVGltZSAqIDAuOTU7XG4gICAgY29uc3QgcXVhbGl0eUltcHJvdmluZyA9IGF2Z1JlY2VudFF1YWxpdHkgPiBhdmdPbGRlclF1YWxpdHkgKiAxLjA1O1xuXG4gICAgY29uc3QgZXhlY1RpbWVEZWNsaW5pbmcgPSBhdmdSZWNlbnRFeGVjVGltZSA+IGF2Z09sZGVyRXhlY1RpbWUgKiAxLjA1O1xuICAgIGNvbnN0IHF1YWxpdHlEZWNsaW5pbmcgPSBhdmdSZWNlbnRRdWFsaXR5IDwgYXZnT2xkZXJRdWFsaXR5ICogMC45NTtcblxuICAgIGlmIChleGVjVGltZUltcHJvdmluZyB8fCBxdWFsaXR5SW1wcm92aW5nKSByZXR1cm4gJ2ltcHJvdmluZyc7XG4gICAgaWYgKGV4ZWNUaW1lRGVjbGluaW5nIHx8IHF1YWxpdHlEZWNsaW5pbmcpIHJldHVybiAnZGVjbGluaW5nJztcbiAgICByZXR1cm4gJ3N0YWJsZSc7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgZm9yIHBlcmZvcm1hbmNlIGFsZXJ0c1xuICAgKi9cbiAgcHJpdmF0ZSBjaGVja0FsZXJ0cyhhZ2VudElkOiBzdHJpbmcsIGV4ZWN1dGlvblRpbWU6IG51bWJlciwgaXNzdWVzRGV0ZWN0ZWQ6IG51bWJlciwgcXVhbGl0eVNjb3JlOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuXG4gICAgLy8gRXhlY3V0aW9uIHRpbWUgYWxlcnRcbiAgICBjb25zdCBleGVjVGhyZXNob2xkID0gdGhpcy5hbGVydFRocmVzaG9sZHMuZ2V0KCdleGVjdXRpb25fdGltZScpITtcbiAgICBpZiAoZXhlY3V0aW9uVGltZSA+IGV4ZWNUaHJlc2hvbGQpIHtcbiAgICAgIHRoaXMuY3JlYXRlQWxlcnQoe1xuICAgICAgICBpZDogYGV4ZWMtYWxlcnQtJHthZ2VudElkfS0ke3RpbWVzdGFtcH1gLFxuICAgICAgICB0aW1lc3RhbXAsXG4gICAgICAgIHNldmVyaXR5OiBleGVjdXRpb25UaW1lID4gZXhlY1RocmVzaG9sZCAqIDIgPyAnY3JpdGljYWwnIDogJ3dhcm5pbmcnLFxuICAgICAgICBhZ2VudElkLFxuICAgICAgICBtZXNzYWdlOiBgQWdlbnQgJHthZ2VudElkfSBleGVjdXRpb24gdGltZSBleGNlZWRlZCB0aHJlc2hvbGRgLFxuICAgICAgICBtZXRyaWM6ICdleGVjdXRpb25fdGltZScsXG4gICAgICAgIHZhbHVlOiBleGVjdXRpb25UaW1lLFxuICAgICAgICB0aHJlc2hvbGQ6IGV4ZWNUaHJlc2hvbGQsXG4gICAgICAgIGFjdGlvbjogJ1JldmlldyBhZ2VudCBpbXBsZW1lbnRhdGlvbiBmb3IgcGVyZm9ybWFuY2UgYm90dGxlbmVja3MnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBRdWFsaXR5IHNjb3JlIGFsZXJ0XG4gICAgY29uc3QgcXVhbGl0eVRocmVzaG9sZCA9IHRoaXMuYWxlcnRUaHJlc2hvbGRzLmdldCgncXVhbGl0eV9zY29yZScpITtcbiAgICBpZiAocXVhbGl0eVNjb3JlIDwgcXVhbGl0eVRocmVzaG9sZCkge1xuICAgICAgdGhpcy5jcmVhdGVBbGVydCh7XG4gICAgICAgIGlkOiBgcXVhbGl0eS1hbGVydC0ke2FnZW50SWR9LSR7dGltZXN0YW1wfWAsXG4gICAgICAgIHRpbWVzdGFtcCxcbiAgICAgICAgc2V2ZXJpdHk6IHF1YWxpdHlTY29yZSA8IHF1YWxpdHlUaHJlc2hvbGQgKiAwLjUgPyAnY3JpdGljYWwnIDogJ3dhcm5pbmcnLFxuICAgICAgICBhZ2VudElkLFxuICAgICAgICBtZXNzYWdlOiBgQWdlbnQgJHthZ2VudElkfSBxdWFsaXR5IHNjb3JlIGJlbG93IHRocmVzaG9sZGAsXG4gICAgICAgIG1ldHJpYzogJ3F1YWxpdHlfc2NvcmUnLFxuICAgICAgICB2YWx1ZTogcXVhbGl0eVNjb3JlLFxuICAgICAgICB0aHJlc2hvbGQ6IHF1YWxpdHlUaHJlc2hvbGQsXG4gICAgICAgIGFjdGlvbjogJ1JldmlldyBhZ2VudCB2YWxpZGF0aW9uIGxvZ2ljIGFuZCBlbmhhbmNlIGRldGVjdGlvbiBjYXBhYmlsaXRpZXMnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBJc3N1ZXMgZGV0ZWN0ZWQgYWxlcnRcbiAgICBjb25zdCBpc3N1ZXNUaHJlc2hvbGQgPSB0aGlzLmFsZXJ0VGhyZXNob2xkcy5nZXQoJ2lzc3VlX2RldGVjdGlvbicpITtcbiAgICBpZiAoaXNzdWVzRGV0ZWN0ZWQgPiBpc3N1ZXNUaHJlc2hvbGQpIHtcbiAgICAgIHRoaXMuY3JlYXRlQWxlcnQoe1xuICAgICAgICBpZDogYGlzc3Vlcy1hbGVydC0ke2FnZW50SWR9LSR7dGltZXN0YW1wfWAsXG4gICAgICAgIHRpbWVzdGFtcCxcbiAgICAgICAgc2V2ZXJpdHk6ICdpbmZvJyxcbiAgICAgICAgYWdlbnRJZCxcbiAgICAgICAgbWVzc2FnZTogYEFnZW50ICR7YWdlbnRJZH0gZGV0ZWN0ZWQgaGlnaCBudW1iZXIgb2YgaXNzdWVzYCxcbiAgICAgICAgbWV0cmljOiAnaXNzdWVfZGV0ZWN0aW9uJyxcbiAgICAgICAgdmFsdWU6IGlzc3Vlc0RldGVjdGVkLFxuICAgICAgICB0aHJlc2hvbGQ6IGlzc3Vlc1RocmVzaG9sZCxcbiAgICAgICAgYWN0aW9uOiAnUmV2aWV3IGNvZGViYXNlIHF1YWxpdHkgYW5kIGFkZHJlc3MgZGV0ZWN0ZWQgaXNzdWVzJ1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBwZXJmb3JtYW5jZSBhbGVydFxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVBbGVydChhbGVydDogUGVyZm9ybWFuY2VBbGVydCk6IHZvaWQge1xuICAgIHRoaXMuYWxlcnRzLnB1c2goYWxlcnQpO1xuXG4gICAgLy8gS2VlcCBvbmx5IGxhc3QgMTAwMCBhbGVydHNcbiAgICBpZiAodGhpcy5hbGVydHMubGVuZ3RoID4gMTAwMCkge1xuICAgICAgdGhpcy5hbGVydHMgPSB0aGlzLmFsZXJ0cy5zbGljZSgtMTAwMCk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYPCfmqggQWxlcnQ6ICR7YWxlcnQuc2V2ZXJpdHkudG9VcHBlckNhc2UoKX0gLSAke2FsZXJ0Lm1lc3NhZ2V9YCk7XG4gICAgdGhpcy5lbWl0KCdhbGVydC1jcmVhdGVkJywgYWxlcnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBtZXRyaWMgc3RhdHVzIGJhc2VkIG9uIHRocmVzaG9sZHNcbiAgICovXG4gIHByaXZhdGUgZ2V0TWV0cmljU3RhdHVzKG1ldHJpY1R5cGU6IHN0cmluZywgdmFsdWU6IG51bWJlcik6ICdub3JtYWwnIHwgJ3dhcm5pbmcnIHwgJ2NyaXRpY2FsJyB7XG4gICAgY29uc3QgdGhyZXNob2xkID0gdGhpcy5hbGVydFRocmVzaG9sZHMuZ2V0KG1ldHJpY1R5cGUpO1xuICAgIGlmICghdGhyZXNob2xkKSByZXR1cm4gJ25vcm1hbCc7XG5cbiAgICBzd2l0Y2ggKG1ldHJpY1R5cGUpIHtcbiAgICAgIGNhc2UgJ2V4ZWN1dGlvbl90aW1lJzpcbiAgICAgIGNhc2UgJ21lbW9yeV91c2FnZSc6XG4gICAgICBjYXNlICdjcHVfdXNhZ2UnOlxuICAgICAgY2FzZSAnaXNzdWVfZGV0ZWN0aW9uJzpcbiAgICAgICAgaWYgKHZhbHVlID4gdGhyZXNob2xkICogMikgcmV0dXJuICdjcml0aWNhbCc7XG4gICAgICAgIGlmICh2YWx1ZSA+IHRocmVzaG9sZCkgcmV0dXJuICd3YXJuaW5nJztcbiAgICAgICAgcmV0dXJuICdub3JtYWwnO1xuXG4gICAgICBjYXNlICdxdWFsaXR5X3Njb3JlJzpcbiAgICAgICAgaWYgKHZhbHVlIDwgdGhyZXNob2xkICogMC41KSByZXR1cm4gJ2NyaXRpY2FsJztcbiAgICAgICAgaWYgKHZhbHVlIDwgdGhyZXNob2xkKSByZXR1cm4gJ3dhcm5pbmcnO1xuICAgICAgICByZXR1cm4gJ25vcm1hbCc7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnbm9ybWFsJztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJlY2VudCBtZXRyaWNzIGZvciBhbiBhZ2VudFxuICAgKi9cbiAgcHJpdmF0ZSBnZXRSZWNlbnRNZXRyaWNzKGFnZW50SWQ6IHN0cmluZywgY291bnQ6IG51bWJlcik6IFBlcmZvcm1hbmNlTWV0cmljW10ge1xuICAgIGNvbnN0IGFnZW50TWV0cmljcyA9IHRoaXMubWV0cmljcy5nZXQoYWdlbnRJZCkgfHwgW107XG4gICAgcmV0dXJuIGFnZW50TWV0cmljc1xuICAgICAgLnNvcnQoKGEsIGIpID0+IGIudGltZXN0YW1wIC0gYS50aW1lc3RhbXApXG4gICAgICAuc2xpY2UoMCwgY291bnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBwZXJmb3JtYW5jZSBkYXNoYm9hcmQgZGF0YVxuICAgKi9cbiAgcHVibGljIGdldFBlcmZvcm1hbmNlRGFzaGJvYXJkKCk6IHtcbiAgICBzeXN0ZW06IFN5c3RlbVBlcmZvcm1hbmNlRGF0YTtcbiAgICBhZ2VudHM6IEFnZW50UGVyZm9ybWFuY2VEYXRhW107XG4gICAgcmVjZW50QWxlcnRzOiBQZXJmb3JtYW5jZUFsZXJ0W107XG4gICAgdHJlbmRzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICB9IHtcbiAgICBjb25zdCBzeXN0ZW1EYXRhID0gdGhpcy5nZXRTeXN0ZW1QZXJmb3JtYW5jZURhdGEoKTtcbiAgICBjb25zdCBhZ2VudERhdGEgPSBBcnJheS5mcm9tKHRoaXMuYWdlbnRQZXJmb3JtYW5jZS52YWx1ZXMoKSk7XG4gICAgY29uc3QgcmVjZW50QWxlcnRzID0gdGhpcy5hbGVydHMuc2xpY2UoLTIwKTtcbiAgICBjb25zdCB0cmVuZHMgPSB0aGlzLmNhbGN1bGF0ZVN5c3RlbVRyZW5kcygpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN5c3RlbTogc3lzdGVtRGF0YSxcbiAgICAgIGFnZW50czogYWdlbnREYXRhLFxuICAgICAgcmVjZW50QWxlcnRzLFxuICAgICAgdHJlbmRzXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3lzdGVtIHBlcmZvcm1hbmNlIGRhdGFcbiAgICovXG4gIHByaXZhdGUgZ2V0U3lzdGVtUGVyZm9ybWFuY2VEYXRhKCk6IFN5c3RlbVBlcmZvcm1hbmNlRGF0YSB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBhbGxBZ2VudHMgPSBBcnJheS5mcm9tKHRoaXMuYWdlbnRQZXJmb3JtYW5jZS52YWx1ZXMoKSk7XG5cbiAgICBjb25zdCB0b3RhbEV4ZWN1dGlvbnMgPSBhbGxBZ2VudHMucmVkdWNlKChzdW0sIGFnZW50KSA9PiBzdW0gKyBhZ2VudC50b3RhbEV4ZWN1dGlvbnMsIDApO1xuICAgIGNvbnN0IGF2ZXJhZ2VSZXNwb25zZVRpbWUgPSBhbGxBZ2VudHMucmVkdWNlKChzdW0sIGFnZW50KSA9PiBzdW0gKyBhZ2VudC5hdmVyYWdlRXhlY3V0aW9uVGltZSwgMCkgLyBhbGxBZ2VudHMubGVuZ3RoIHx8IDA7XG4gICAgY29uc3Qgb3ZlcmFsbFF1YWxpdHkgPSBhbGxBZ2VudHMucmVkdWNlKChzdW0sIGFnZW50KSA9PiBzdW0gKyBhZ2VudC5hdmVyYWdlUXVhbGl0eVNjb3JlLCAwKSAvIGFsbEFnZW50cy5sZW5ndGggfHwgMTAwO1xuXG4gICAgY29uc3QgcmVjZW50QWxlcnRzID0gdGhpcy5hbGVydHMuZmlsdGVyKGFsZXJ0ID0+IHRpbWVzdGFtcCAtIGFsZXJ0LnRpbWVzdGFtcCA8IDM2MDAwMDApOyAvLyBMYXN0IGhvdXJcbiAgICBjb25zdCBjcml0aWNhbElzc3VlcyA9IHJlY2VudEFsZXJ0cy5maWx0ZXIoYWxlcnQgPT4gYWxlcnQuc2V2ZXJpdHkgPT09ICdjcml0aWNhbCcpLmxlbmd0aDtcbiAgICBjb25zdCBoaWdoUHJpb3JpdHlJc3N1ZXMgPSByZWNlbnRBbGVydHMuZmlsdGVyKGFsZXJ0ID0+IGFsZXJ0LnNldmVyaXR5ID09PSAnd2FybmluZycpLmxlbmd0aDtcblxuICAgIC8vIEdldCBsYXRlc3Qgc3lzdGVtIG1ldHJpY3NcbiAgICBjb25zdCBzeXN0ZW1NZXRyaWNzID0gdGhpcy5tZXRyaWNzLmdldCgnc3lzdGVtJykgfHwgW107XG4gICAgY29uc3QgbGF0ZXN0TWVtb3J5ID0gc3lzdGVtTWV0cmljc1xuICAgICAgLmZpbHRlcihtID0+IG0ubWV0cmljVHlwZSA9PT0gJ21lbW9yeV91c2FnZScpXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi50aW1lc3RhbXAgLSBhLnRpbWVzdGFtcClbMF0/LnZhbHVlIHx8IDA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdGltZXN0YW1wLFxuICAgICAgb3ZlcmFsbEhlYWx0aDogTWF0aC5taW4oMTAwLCBvdmVyYWxsUXVhbGl0eSAtIChjcml0aWNhbElzc3VlcyAqIDEwKSAtIChoaWdoUHJpb3JpdHlJc3N1ZXMgKiA1KSksXG4gICAgICB0b3RhbEFnZW50RXhlY3V0aW9uczogdG90YWxFeGVjdXRpb25zLFxuICAgICAgYXZlcmFnZVJlc3BvbnNlVGltZSxcbiAgICAgIHN5c3RlbUxvYWQ6IGF2ZXJhZ2VSZXNwb25zZVRpbWUgPiAyMDAwID8gKGF2ZXJhZ2VSZXNwb25zZVRpbWUgLyAxMDAwKSAqIDEwIDogMTAsXG4gICAgICBtZW1vcnlVc2FnZTogbGF0ZXN0TWVtb3J5LFxuICAgICAgYWN0aXZlQWdlbnRzOiBhbGxBZ2VudHMubGVuZ3RoLFxuICAgICAgY3JpdGljYWxJc3N1ZXMsXG4gICAgICBoaWdoUHJpb3JpdHlJc3N1ZXMsXG4gICAgICBxdWFsaXR5R2F0ZVN0YXR1czogY3JpdGljYWxJc3N1ZXMgPiAwID8gJ2ZhaWxpbmcnIDogaGlnaFByaW9yaXR5SXNzdWVzID4gNSA/ICd3YXJuaW5nJyA6ICdwYXNzaW5nJ1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHN5c3RlbSB0cmVuZHNcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlU3lzdGVtVHJlbmRzKCk6IFJlY29yZDxzdHJpbmcsIGFueT4ge1xuICAgIGNvbnN0IHRyZW5kczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuXG4gICAgLy8gQ2FsY3VsYXRlIHRyZW5kcyBmb3IgZWFjaCBhZ2VudFxuICAgIGZvciAoY29uc3QgW2FnZW50SWQsIHBlcmZvcm1hbmNlXSBvZiB0aGlzLmFnZW50UGVyZm9ybWFuY2UpIHtcbiAgICAgIHRyZW5kc1thZ2VudElkXSA9IHtcbiAgICAgICAgcGVyZm9ybWFuY2U6IHBlcmZvcm1hbmNlLnRyZW5kLFxuICAgICAgICBleGVjdXRpb25UaW1lOiB0aGlzLmNhbGN1bGF0ZU1ldHJpY1RyZW5kKGFnZW50SWQsICdleGVjdXRpb25fdGltZScpLFxuICAgICAgICBxdWFsaXR5U2NvcmU6IHRoaXMuY2FsY3VsYXRlTWV0cmljVHJlbmQoYWdlbnRJZCwgJ3F1YWxpdHlfc2NvcmUnKSxcbiAgICAgICAgaXNzdWVzRGV0ZWN0ZWQ6IHRoaXMuY2FsY3VsYXRlTWV0cmljVHJlbmQoYWdlbnRJZCwgJ2lzc3VlX2RldGVjdGlvbicpXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB0cmVuZHM7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHRyZW5kIGZvciBzcGVjaWZpYyBtZXRyaWNcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlTWV0cmljVHJlbmQoYWdlbnRJZDogc3RyaW5nLCBtZXRyaWNUeXBlOiBzdHJpbmcpOiAnaW1wcm92aW5nJyB8ICdzdGFibGUnIHwgJ2RlY2xpbmluZycge1xuICAgIGNvbnN0IHJlY2VudE1ldHJpY3MgPSB0aGlzLmdldFJlY2VudE1ldHJpY3MoYWdlbnRJZCwgMjApXG4gICAgICAuZmlsdGVyKG0gPT4gbS5tZXRyaWNUeXBlID09PSBtZXRyaWNUeXBlKTtcblxuICAgIGlmIChyZWNlbnRNZXRyaWNzLmxlbmd0aCA8IDEwKSByZXR1cm4gJ3N0YWJsZSc7XG5cbiAgICBjb25zdCBmaXJzdEhhbGYgPSByZWNlbnRNZXRyaWNzLnNsaWNlKDAsIDEwKTtcbiAgICBjb25zdCBzZWNvbmRIYWxmID0gcmVjZW50TWV0cmljcy5zbGljZSgxMCk7XG5cbiAgICBjb25zdCBmaXJzdEF2ZyA9IGZpcnN0SGFsZi5yZWR1Y2UoKHN1bSwgbSkgPT4gc3VtICsgbS52YWx1ZSwgMCkgLyBmaXJzdEhhbGYubGVuZ3RoO1xuICAgIGNvbnN0IHNlY29uZEF2ZyA9IHNlY29uZEhhbGYucmVkdWNlKChzdW0sIG0pID0+IHN1bSArIG0udmFsdWUsIDApIC8gc2Vjb25kSGFsZi5sZW5ndGg7XG5cbiAgICBjb25zdCB0aHJlc2hvbGQgPSAwLjA1OyAvLyA1JSBjaGFuZ2UgdGhyZXNob2xkXG5cbiAgICBpZiAobWV0cmljVHlwZSA9PT0gJ3F1YWxpdHlfc2NvcmUnKSB7XG4gICAgICAvLyBGb3IgcXVhbGl0eSBzY29yZSwgaGlnaGVyIGlzIGJldHRlclxuICAgICAgaWYgKHNlY29uZEF2ZyA+IGZpcnN0QXZnICogKDEgKyB0aHJlc2hvbGQpKSByZXR1cm4gJ2ltcHJvdmluZyc7XG4gICAgICBpZiAoc2Vjb25kQXZnIDwgZmlyc3RBdmcgKiAoMSAtIHRocmVzaG9sZCkpIHJldHVybiAnZGVjbGluaW5nJztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRm9yIGV4ZWN1dGlvbiB0aW1lIGFuZCBpc3N1ZXMsIGxvd2VyIGlzIGJldHRlclxuICAgICAgaWYgKHNlY29uZEF2ZyA8IGZpcnN0QXZnICogKDEgLSB0aHJlc2hvbGQpKSByZXR1cm4gJ2ltcHJvdmluZyc7XG4gICAgICBpZiAoc2Vjb25kQXZnID4gZmlyc3RBdmcgKiAoMSArIHRocmVzaG9sZCkpIHJldHVybiAnZGVjbGluaW5nJztcbiAgICB9XG5cbiAgICByZXR1cm4gJ3N0YWJsZSc7XG4gIH1cblxuICAvKipcbiAgICogU2F2ZSBtZXRyaWNzIHRvIGRpc2tcbiAgICovXG4gIHByaXZhdGUgc2F2ZU1ldHJpY3MoKTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIG1ldHJpY3M6IE9iamVjdC5mcm9tRW50cmllcyh0aGlzLm1ldHJpY3MpLFxuICAgICAgICBhZ2VudFBlcmZvcm1hbmNlOiBPYmplY3QuZnJvbUVudHJpZXModGhpcy5hZ2VudFBlcmZvcm1hbmNlKSxcbiAgICAgICAgYWxlcnRzOiB0aGlzLmFsZXJ0cy5zbGljZSgtMTAwMCksIC8vIEtlZXAgbGFzdCAxMDAwIGFsZXJ0c1xuICAgICAgICBsYXN0U2F2ZWQ6IERhdGUubm93KClcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG1ldHJpY3NGaWxlID0gcGF0aC5qb2luKHRoaXMubWV0cmljc1N0b3JlUGF0aCwgJ21ldHJpY3MuanNvbicpO1xuICAgICAgZnMud3JpdGVGaWxlU3luYyhtZXRyaWNzRmlsZSwgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBwZXJmb3JtYW5jZSBtZXRyaWNzOicsIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFudXAgb2xkIG1ldHJpY3MgKGtlZXAgbGFzdCA3IGRheXMpXG4gICAqL1xuICBwcml2YXRlIGNsZWFudXBPbGRNZXRyaWNzKCk6IHZvaWQge1xuICAgIGNvbnN0IGN1dG9mZlRpbWUgPSBEYXRlLm5vdygpIC0gKDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gNyBkYXlzXG5cbiAgICBmb3IgKGNvbnN0IFthZ2VudElkLCBtZXRyaWNzXSBvZiB0aGlzLm1ldHJpY3MpIHtcbiAgICAgIGNvbnN0IGZpbHRlcmVkTWV0cmljcyA9IG1ldHJpY3MuZmlsdGVyKG1ldHJpYyA9PiBtZXRyaWMudGltZXN0YW1wID4gY3V0b2ZmVGltZSk7XG4gICAgICB0aGlzLm1ldHJpY3Muc2V0KGFnZW50SWQsIGZpbHRlcmVkTWV0cmljcyk7XG4gICAgfVxuXG4gICAgLy8gQ2xlYW51cCBvbGQgYWxlcnRzXG4gICAgdGhpcy5hbGVydHMgPSB0aGlzLmFsZXJ0cy5maWx0ZXIoYWxlcnQgPT4gYWxlcnQudGltZXN0YW1wID4gY3V0b2ZmVGltZSk7XG4gIH1cblxuICAvKipcbiAgICogRXhwb3J0IHBlcmZvcm1hbmNlIHJlcG9ydFxuICAgKi9cbiAgcHVibGljIGV4cG9ydFJlcG9ydChmb3JtYXQ6ICdqc29uJyB8ICdjc3YnID0gJ2pzb24nKTogc3RyaW5nIHtcbiAgICBjb25zdCBkYXNoYm9hcmQgPSB0aGlzLmdldFBlcmZvcm1hbmNlRGFzaGJvYXJkKCk7XG5cbiAgICBpZiAoZm9ybWF0ID09PSAnanNvbicpIHtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXNoYm9hcmQsIG51bGwsIDIpO1xuICAgIH1cblxuICAgIC8vIENTViBmb3JtYXRcbiAgICBsZXQgY3N2ID0gJ0FnZW50LFRvdGFsIEV4ZWN1dGlvbnMsQXZnIEV4ZWN1dGlvbiBUaW1lLE1heCBFeGVjdXRpb24gVGltZSxTdWNjZXNzIFJhdGUsQXZnIFF1YWxpdHkgU2NvcmUsSXNzdWVzIERldGVjdGVkLFRyZW5kXFxuJztcblxuICAgIGRhc2hib2FyZC5hZ2VudHMuZm9yRWFjaChhZ2VudCA9PiB7XG4gICAgICBjc3YgKz0gYCR7YWdlbnQuYWdlbnRJZH0sJHthZ2VudC50b3RhbEV4ZWN1dGlvbnN9LCR7YWdlbnQuYXZlcmFnZUV4ZWN1dGlvblRpbWUudG9GaXhlZCgyKX0sJHthZ2VudC5tYXhFeGVjdXRpb25UaW1lfSwkeyhhZ2VudC5zdWNjZXNzUmF0ZSAqIDEwMCkudG9GaXhlZCgxKX0lLCR7YWdlbnQuYXZlcmFnZVF1YWxpdHlTY29yZS50b0ZpeGVkKDEpfSwke2FnZW50Lmlzc3Vlc0RldGVjdGVkfSwke2FnZW50LnRyZW5kfVxcbmA7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gY3N2O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhZ2VudCBwZXJmb3JtYW5jZSBzdW1tYXJ5XG4gICAqL1xuICBwdWJsaWMgZ2V0QWdlbnRTdW1tYXJ5KGFnZW50SWQ6IHN0cmluZyk6IEFnZW50UGVyZm9ybWFuY2VEYXRhIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuYWdlbnRQZXJmb3JtYW5jZS5nZXQoYWdlbnRJZCkgfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3lzdGVtIGhlYWx0aCBzY29yZVxuICAgKi9cbiAgcHVibGljIGdldFN5c3RlbUhlYWx0aFNjb3JlKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U3lzdGVtUGVyZm9ybWFuY2VEYXRhKCkub3ZlcmFsbEhlYWx0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWN0aXZlIGFsZXJ0c1xuICAgKi9cbiAgcHVibGljIGdldEFjdGl2ZUFsZXJ0cygpOiBQZXJmb3JtYW5jZUFsZXJ0W10ge1xuICAgIGNvbnN0IG9uZUhvdXJBZ28gPSBEYXRlLm5vdygpIC0gMzYwMDAwMDtcbiAgICByZXR1cm4gdGhpcy5hbGVydHMuZmlsdGVyKGFsZXJ0ID0+IGFsZXJ0LnRpbWVzdGFtcCA+IG9uZUhvdXJBZ28pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IG1vbml0b3JpbmcgKGZvciBzZXJ2ZXIgaW50ZWdyYXRpb24pXG4gICAqL1xuICBwdWJsaWMgc3RhcnQoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmlzTW9uaXRvcmluZykge1xuICAgICAgdGhpcy5zdGFydE1vbml0b3JpbmcoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IFByb21ldGhldXMtY29tcGF0aWJsZSBtZXRyaWNzXG4gICAqL1xuICBwdWJsaWMgZ2V0UHJvbWV0aGV1c01ldHJpY3MoKTogc3RyaW5nIHtcbiAgICBjb25zdCBkYXNoYm9hcmQgPSB0aGlzLmdldFBlcmZvcm1hbmNlRGFzaGJvYXJkKCk7XG4gICAgbGV0IG1ldHJpY3MgPSAnJztcblxuICAgIC8vIFN5c3RlbSBtZXRyaWNzXG4gICAgbWV0cmljcyArPSBgIyBIRUxQIHZlcnNhdGlsX3N5c3RlbV9oZWFsdGggT3ZlcmFsbCBzeXN0ZW0gaGVhbHRoIHNjb3JlXFxuYDtcbiAgICBtZXRyaWNzICs9IGAjIFRZUEUgdmVyc2F0aWxfc3lzdGVtX2hlYWx0aCBnYXVnZVxcbmA7XG4gICAgbWV0cmljcyArPSBgdmVyc2F0aWxfc3lzdGVtX2hlYWx0aCAke2Rhc2hib2FyZC5zeXN0ZW0ub3ZlcmFsbEhlYWx0aH1cXG5cXG5gO1xuXG4gICAgbWV0cmljcyArPSBgIyBIRUxQIHZlcnNhdGlsX3RvdGFsX2V4ZWN1dGlvbnMgVG90YWwgYWdlbnQgZXhlY3V0aW9uc1xcbmA7XG4gICAgbWV0cmljcyArPSBgIyBUWVBFIHZlcnNhdGlsX3RvdGFsX2V4ZWN1dGlvbnMgY291bnRlclxcbmA7XG4gICAgbWV0cmljcyArPSBgdmVyc2F0aWxfdG90YWxfZXhlY3V0aW9ucyAke2Rhc2hib2FyZC5zeXN0ZW0udG90YWxBZ2VudEV4ZWN1dGlvbnN9XFxuXFxuYDtcblxuICAgIG1ldHJpY3MgKz0gYCMgSEVMUCB2ZXJzYXRpbF9yZXNwb25zZV90aW1lX2F2ZyBBdmVyYWdlIHJlc3BvbnNlIHRpbWVcXG5gO1xuICAgIG1ldHJpY3MgKz0gYCMgVFlQRSB2ZXJzYXRpbF9yZXNwb25zZV90aW1lX2F2ZyBnYXVnZVxcbmA7XG4gICAgbWV0cmljcyArPSBgdmVyc2F0aWxfcmVzcG9uc2VfdGltZV9hdmcgJHtkYXNoYm9hcmQuc3lzdGVtLmF2ZXJhZ2VSZXNwb25zZVRpbWV9XFxuXFxuYDtcblxuICAgIC8vIEFnZW50LXNwZWNpZmljIG1ldHJpY3NcbiAgICBkYXNoYm9hcmQuYWdlbnRzLmZvckVhY2goYWdlbnQgPT4ge1xuICAgICAgbWV0cmljcyArPSBgIyBIRUxQIHZlcnNhdGlsX2FnZW50X2V4ZWN1dGlvbnMgQWdlbnQgZXhlY3V0aW9uIGNvdW50XFxuYDtcbiAgICAgIG1ldHJpY3MgKz0gYCMgVFlQRSB2ZXJzYXRpbF9hZ2VudF9leGVjdXRpb25zIGNvdW50ZXJcXG5gO1xuICAgICAgbWV0cmljcyArPSBgdmVyc2F0aWxfYWdlbnRfZXhlY3V0aW9uc3thZ2VudD1cIiR7YWdlbnQuYWdlbnRJZH1cIn0gJHthZ2VudC50b3RhbEV4ZWN1dGlvbnN9XFxuXFxuYDtcblxuICAgICAgbWV0cmljcyArPSBgIyBIRUxQIHZlcnNhdGlsX2FnZW50X3F1YWxpdHlfc2NvcmUgQWdlbnQgcXVhbGl0eSBzY29yZVxcbmA7XG4gICAgICBtZXRyaWNzICs9IGAjIFRZUEUgdmVyc2F0aWxfYWdlbnRfcXVhbGl0eV9zY29yZSBnYXVnZVxcbmA7XG4gICAgICBtZXRyaWNzICs9IGB2ZXJzYXRpbF9hZ2VudF9xdWFsaXR5X3Njb3Jle2FnZW50PVwiJHthZ2VudC5hZ2VudElkfVwifSAke2FnZW50LmF2ZXJhZ2VRdWFsaXR5U2NvcmV9XFxuXFxuYDtcblxuICAgICAgbWV0cmljcyArPSBgIyBIRUxQIHZlcnNhdGlsX2FnZW50X2lzc3Vlc19kZXRlY3RlZCBJc3N1ZXMgZGV0ZWN0ZWQgYnkgYWdlbnRcXG5gO1xuICAgICAgbWV0cmljcyArPSBgIyBUWVBFIHZlcnNhdGlsX2FnZW50X2lzc3Vlc19kZXRlY3RlZCBjb3VudGVyXFxuYDtcbiAgICAgIG1ldHJpY3MgKz0gYHZlcnNhdGlsX2FnZW50X2lzc3Vlc19kZXRlY3RlZHthZ2VudD1cIiR7YWdlbnQuYWdlbnRJZH1cIn0gJHthZ2VudC5pc3N1ZXNEZXRlY3RlZH1cXG5cXG5gO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIG1ldHJpY3M7XG4gIH1cblxuICBnZXRNZXRyaWNzKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UGVyZm9ybWFuY2VEYXNoYm9hcmQoKTtcbiAgfVxuXG4gIGdldEFkYXB0aXZlSW5zaWdodHMoKTogYW55IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHJlbmRzOiB0aGlzLmNhbGN1bGF0ZVN5c3RlbVRyZW5kcygpLFxuICAgICAgaGVhbHRoOiB0aGlzLmdldFN5c3RlbUhlYWx0aFNjb3JlKCksXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IFtdXG4gICAgfTtcbiAgfVxuXG4gIGlzSGVhbHRoeSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTeXN0ZW1IZWFsdGhTY29yZSgpID49IDcwO1xuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBwZXJmb3JtYW5jZU1vbml0b3IgPSBuZXcgUGVyZm9ybWFuY2VNb25pdG9yKCk7XG5leHBvcnQgZGVmYXVsdCBwZXJmb3JtYW5jZU1vbml0b3I7Il0sInZlcnNpb24iOjN9