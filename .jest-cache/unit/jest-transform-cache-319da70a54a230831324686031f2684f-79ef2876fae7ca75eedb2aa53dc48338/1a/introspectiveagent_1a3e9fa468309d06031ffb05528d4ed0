660f3e6dab3fd442b797ee677584d4f7
"use strict";
/**
 * IntrospectiveAgent - Testable without mocks
 * Uses dependency injection for real testing
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.IntrospectiveAgent = exports.TestCommandExecutor = exports.TestFileSystemProvider = exports.RealCommandExecutor = exports.RealFileSystemProvider = void 0;
const base_agent_1 = require("./base-agent");
const logger_1 = require("../utils/logger");
const performance_monitor_1 = require("../analytics/performance-monitor");
// Real implementations for production
class RealFileSystemProvider {
    async fileExists(path) {
        try {
            const fs = await Promise.resolve().then(() => __importStar(require('fs-extra')));
            await fs.access(path);
            return true;
        }
        catch {
            return false;
        }
    }
    async readFile(path) {
        const fs = await Promise.resolve().then(() => __importStar(require('fs-extra')));
        return await fs.readFile(path, 'utf-8');
    }
}
exports.RealFileSystemProvider = RealFileSystemProvider;
class RealCommandExecutor {
    async execute(command, timeoutMs) {
        const { exec } = await Promise.resolve().then(() => __importStar(require('child_process')));
        const { promisify } = await Promise.resolve().then(() => __importStar(require('util')));
        const execAsync = promisify(exec);
        return new Promise((resolve, reject) => {
            const timeout = setTimeout(() => {
                reject(new Error(`Command timeout: ${command}`));
            }, timeoutMs);
            execAsync(command)
                .then(result => {
                clearTimeout(timeout);
                resolve(result);
            })
                .catch(error => {
                clearTimeout(timeout);
                reject(error);
            });
        });
    }
}
exports.RealCommandExecutor = RealCommandExecutor;
// Test implementations (lightweight, real behavior)
class TestFileSystemProvider {
    constructor(initialFiles = {}) {
        this.files = new Map();
        for (const [path, content] of Object.entries(initialFiles)) {
            this.files.set(path, content);
        }
    }
    async fileExists(path) {
        return this.files.has(path);
    }
    async readFile(path) {
        const content = this.files.get(path);
        if (content === undefined) {
            throw new Error(`File not found: ${path}`);
        }
        return content;
    }
    addFile(path, content) {
        this.files.set(path, content);
    }
}
exports.TestFileSystemProvider = TestFileSystemProvider;
class TestCommandExecutor {
    constructor() {
        this.responses = new Map();
    }
    async execute(command, timeoutMs) {
        // Simulate delay
        await new Promise(resolve => setTimeout(resolve, 10));
        const response = this.responses.get(command) || { stdout: '', stderr: '', delay: 10 };
        // Simulate actual command delay if configured
        if (response.delay > 0) {
            await new Promise(resolve => setTimeout(resolve, response.delay));
        }
        // If stderr is present, throw error (simulating command failure)
        if (response.stderr) {
            const error = new Error(`Command failed: ${command}`);
            error.stdout = response.stdout;
            error.stderr = response.stderr;
            throw error;
        }
        return { stdout: response.stdout, stderr: response.stderr };
    }
    setResponse(command, stdout, stderr = '', delay = 10) {
        this.responses.set(command, { stdout, stderr, delay });
    }
}
exports.TestCommandExecutor = TestCommandExecutor;
/**
 * IntrospectiveAgent - Testable implementation
 */
class IntrospectiveAgent extends base_agent_1.BaseAgent {
    constructor(fileSystem, commandExecutor) {
        super();
        this.name = 'IntrospectiveAgent';
        this.id = 'introspective-agent';
        this.specialization = 'Self-Monitoring & Optimization Controller';
        this.systemPrompt = 'Autonomous agent responsible for framework introspection, optimization, and self-improvement';
        this.learningInsights = new Map();
        this.improvementHistory = [];
        this.logger = logger_1.VERSATILLogger.getInstance();
        this.performanceMonitor = new performance_monitor_1.PerformanceMonitor();
        // Use injected or default to real implementations
        this.fileSystem = fileSystem || new RealFileSystemProvider();
        this.commandExecutor = commandExecutor || new RealCommandExecutor();
        this.logger.info('IntrospectiveAgent initialized with tool-based controller architecture', {
            features: [
                'Framework Health Monitoring',
                'Performance Optimization Engine',
                'Pattern Recognition System',
                'Meta-Learning Capabilities',
                'Autonomous Improvement Engine'
            ]
        }, 'IntrospectiveAgent');
    }
    /**
     * Main activation method
     */
    async activate(context) {
        const startTime = Date.now();
        this.logger.info('üîç Starting introspective analysis using tool controllers', {
            context: context.trigger || 'unknown'
        }, 'IntrospectiveAgent');
        try {
            // Perform analysis
            const healthAssessment = await this.assessFrameworkHealth();
            const performanceMetrics = await this.analyzePerformance();
            const patterns = await this.discoverPatterns(context);
            const learningInsights = await this.performMetaLearning();
            const confidence = this.calculateConfidence(healthAssessment, performanceMetrics);
            const suggestions = this.generateSuggestions(healthAssessment, performanceMetrics, patterns, learningInsights);
            const handoffTo = this.determineHandoffsFromAnalysis(suggestions);
            const priority = this.calculatePriorityFromSuggestions(suggestions);
            const executionTime = Date.now() - startTime;
            this.logger.info('‚úÖ Introspective analysis completed', {
                executionTime: `${executionTime}ms`,
                improvements: suggestions.length,
                confidence
            }, 'IntrospectiveAgent');
            return {
                agentId: this.id,
                message: `Introspective analysis completed with ${suggestions.length} insights`,
                suggestions,
                priority,
                handoffTo,
                context: {
                    confidence,
                    introspectionTime: executionTime,
                    healthScore: healthAssessment.score,
                    performanceMetrics,
                    patterns: patterns.length,
                    learningInsights: learningInsights.length,
                    // Additional fields for test compatibility
                    patternsDiscovered: patterns.length,
                    learningUpdates: learningInsights.length,
                    optimizationsApplied: suggestions.filter(s => s.autoFixable).length,
                    qualityGates: {
                        config: healthAssessment.score >= 0.8,
                        security: healthAssessment.vulnerabilities === 0,
                        performance: performanceMetrics.buildTime > 0 && performanceMetrics.buildTime < 30000,
                        overall: confidence >= 0.7
                    }
                }
            };
        }
        catch (error) {
            const errorMessage = error instanceof Error ? error.message : String(error);
            this.logger.error('‚ùå Introspective analysis failed', {
                error: errorMessage,
                context: context.trigger || 'unknown'
            }, 'IntrospectiveAgent');
            return {
                agentId: this.id,
                message: `Framework encountered errors and requires investigation: ${errorMessage}`,
                suggestions: [{
                        type: 'error-recovery',
                        message: 'Run framework recovery: npm run recover',
                        priority: 'high'
                    }, {
                        type: 'configuration-check',
                        message: 'Verify framework configuration and dependencies',
                        priority: 'medium'
                    }],
                priority: 'low',
                handoffTo: [],
                context: {
                    confidence: 0.1,
                    error: true,
                    errorMessage
                }
            };
        }
    }
    /**
     * Assess framework health
     */
    async assessFrameworkHealth() {
        const configFiles = {
            'package.json': false,
            'tsconfig.json': false,
            'jest.config.cjs': false,
            '.versatil-project.json': false
        };
        const issues = [];
        // Check configuration files using injected file system
        for (const file of Object.keys(configFiles)) {
            const exists = await this.fileSystem.fileExists(file);
            configFiles[file] = exists;
            if (!exists) {
                issues.push(`Missing configuration file: ${file}`);
            }
        }
        // Check for vulnerabilities using injected command executor
        let vulnerabilities = 0;
        try {
            const auditResult = await this.commandExecutor.execute('npm audit --json', 5000);
            const auditData = JSON.parse(auditResult.stdout);
            vulnerabilities = auditData.metadata?.vulnerabilities?.total || 0;
        }
        catch (error) {
            // npm audit returns non-zero for vulnerabilities, try parsing anyway
            if (error instanceof Error && 'stdout' in error) {
                try {
                    const auditData = JSON.parse(error.stdout);
                    vulnerabilities = auditData.metadata?.vulnerabilities?.total || 0;
                }
                catch {
                    // Parsing failed, assume no vulnerabilities
                }
            }
        }
        // Calculate health score
        const configScore = Object.values(configFiles).filter(Boolean).length / Object.keys(configFiles).length;
        const securityScore = vulnerabilities === 0 ? 1 : Math.max(0, 1 - (vulnerabilities * 0.1));
        const healthScore = (configScore * 0.6 + securityScore * 0.4);
        return {
            score: healthScore,
            configFiles,
            dependencies: { total: 0, outdated: 0 },
            vulnerabilities,
            issues
        };
    }
    /**
     * Analyze performance
     */
    async analyzePerformance() {
        const metrics = {
            buildTime: 0,
            testTime: 0,
            lintTime: 0,
            memoryUsage: process.memoryUsage()
        };
        // Measure build time
        try {
            const buildStart = Date.now();
            await this.commandExecutor.execute('npm run build', 60000);
            metrics.buildTime = Date.now() - buildStart;
        }
        catch {
            metrics.buildTime = -1;
        }
        // Measure test time
        try {
            const testStart = Date.now();
            await this.commandExecutor.execute('npm test -- --silent', 30000);
            metrics.testTime = Date.now() - testStart;
        }
        catch {
            metrics.testTime = -1;
        }
        // Measure lint time
        try {
            const lintStart = Date.now();
            await this.commandExecutor.execute('npm run lint', 15000);
            metrics.lintTime = Date.now() - lintStart;
        }
        catch {
            metrics.lintTime = -1;
        }
        return metrics;
    }
    /**
     * Discover patterns
     */
    async discoverPatterns(context) {
        const patterns = [];
        if (context.content && context.content.includes('test')) {
            patterns.push({
                type: 'test-coverage',
                description: 'Test file detected - consider checking coverage metrics',
                confidence: 0.9,
                impact: 'high',
                actionable: true
            });
        }
        if (context.content && (context.content.includes('performance') || context.content.includes('optimization'))) {
            patterns.push({
                type: 'performance-focus',
                description: 'Performance-related code detected - monitoring for optimization opportunities',
                confidence: 0.85,
                impact: 'high',
                actionable: true
            });
        }
        return patterns;
    }
    /**
     * Perform meta-learning
     */
    async performMetaLearning() {
        const insights = [];
        if (this.improvementHistory.length > 0) {
            const successRate = this.improvementHistory.filter(i => i.success).length / this.improvementHistory.length;
            if (successRate < 0.5) {
                insights.push({
                    type: 'meta-learning',
                    description: 'Low success rate in past improvements - review optimization strategy',
                    confidence: 0.7,
                    impact: 'medium',
                    actionable: true
                });
            }
        }
        if (this.learningInsights.size > 10) {
            insights.push({
                type: 'meta-learning',
                description: `Accumulated ${this.learningInsights.size} insights - ready for pattern synthesis`,
                confidence: 0.9,
                impact: 'high',
                actionable: true
            });
        }
        return insights;
    }
    calculateConfidence(health, performance) {
        let confidence = 0.5;
        // Health score is heavily weighted (40%)
        confidence += health.score * 0.4;
        // Performance score (30%) - penalize negative values (command failures)
        const perfScore = ((performance.buildTime > 0 && performance.buildTime < 30000 ? 0.33 : performance.buildTime === -1 ? -0.1 : 0) +
            (performance.testTime > 0 && performance.testTime < 15000 ? 0.33 : performance.testTime === -1 ? -0.1 : 0) +
            (performance.lintTime > 0 && performance.lintTime < 5000 ? 0.34 : performance.lintTime === -1 ? -0.1 : 0));
        confidence += perfScore * 0.3;
        const memoryMB = performance.memoryUsage.heapUsed / 1024 / 1024;
        const memoryScore = memoryMB < 100 ? 1 : memoryMB < 200 ? 0.7 : 0.3;
        confidence += memoryScore * 0.2;
        return Math.max(0, Math.min(1, confidence));
    }
    generateSuggestions(health, performance, patterns, learningInsights) {
        const suggestions = [];
        if (health.vulnerabilities > 0) {
            suggestions.push({
                type: 'security',
                message: `Fix ${health.vulnerabilities} security vulnerabilities`,
                priority: 'critical'
            });
        }
        if (health.issues.length > 0) {
            suggestions.push({
                type: 'configuration',
                message: 'Resolve configuration issues: ' + health.issues.join(', '),
                priority: 'high'
            });
        }
        if (performance.buildTime > 30000) {
            suggestions.push({
                type: 'performance',
                message: 'Build time optimization recommended - consider build time optimization strategies',
                priority: 'medium'
            });
        }
        const memoryMB = performance.memoryUsage.heapUsed / 1024 / 1024;
        if (memoryMB > 150) {
            suggestions.push({
                type: 'performance',
                message: 'High memory usage detected - implement memory optimization',
                priority: 'medium'
            });
        }
        for (const pattern of patterns) {
            if (pattern.actionable) {
                suggestions.push({
                    type: pattern.type,
                    message: pattern.description,
                    priority: pattern.impact === 'high' ? 'high' : 'medium'
                });
            }
        }
        return suggestions;
    }
    determineHandoffsFromAnalysis(suggestions) {
        const handoffs = [];
        if (suggestions.some(s => s.type === 'security'))
            handoffs.push('security-sam');
        if (suggestions.some(s => s.type === 'performance'))
            handoffs.push('enhanced-marcus');
        if (suggestions.some(s => s.type === 'test-coverage'))
            handoffs.push('enhanced-maria');
        return handoffs;
    }
    calculatePriorityFromSuggestions(suggestions) {
        if (suggestions.some(s => s.priority === 'critical'))
            return 'critical';
        if (suggestions.some(s => s.priority === 'high'))
            return 'high';
        if (suggestions.some(s => s.priority === 'medium'))
            return 'medium';
        return 'low';
    }
    // Public API methods
    async triggerIntrospection() {
        const health = await this.assessFrameworkHealth();
        const performance = await this.analyzePerformance();
        const patterns = await this.discoverPatterns({ trigger: 'manual-introspection' });
        const learningInsights = await this.performMetaLearning();
        const confidence = this.calculateConfidence(health, performance);
        const suggestions = this.generateSuggestions(health, performance, patterns, learningInsights);
        return {
            insights: [...patterns, ...learningInsights],
            recommendations: suggestions.map(s => ({
                type: s.type,
                message: s.message,
                priority: s.priority,
                estimatedEffort: 'medium',
                autoFixable: false
            })),
            timestamp: Date.now(),
            confidence,
            healthScore: health.score
        };
    }
    getLearningInsights() {
        return this.learningInsights;
    }
    getImprovementHistory() {
        return this.improvementHistory;
    }
    // Common methods from earlier
    calculatePriority(issues) {
        if (!issues || issues.length === 0)
            return 0;
        const severities = issues.map(i => i.severity === 'critical' ? 4 :
            i.severity === 'high' ? 3 :
                i.severity === 'medium' ? 2 : 1);
        return Math.max(...severities);
    }
    determineHandoffs(issues) {
        const handoffs = [];
        if (!issues)
            return handoffs;
        const hasSecurityIssue = issues.some(i => i.type === 'security');
        const hasPerformanceIssue = issues.some(i => i.type === 'performance');
        const hasUIIssue = issues.some(i => i.type === 'ui' || i.type === 'accessibility');
        if (hasSecurityIssue)
            handoffs.push('security-sam');
        if (hasPerformanceIssue)
            handoffs.push('enhanced-marcus');
        if (hasUIIssue)
            handoffs.push('enhanced-james');
        return handoffs;
    }
    generateActionableRecommendations(issues) {
        if (!issues || issues.length === 0)
            return [];
        return issues.map(issue => {
            if (issue.type === 'security') {
                return `Fix security issue: ${issue.message || 'Security vulnerability detected'}`;
            }
            if (issue.type === 'performance') {
                return `Optimize performance: ${issue.message || 'Performance issue detected'}`;
            }
            return `Address issue: ${issue.message || issue.description || 'Issue detected'}`;
        });
    }
    generateEnhancedReport(issues, metadata = {}) {
        return {
            summary: {
                totalIssues: issues?.length || 0,
                critical: issues?.filter(i => i.severity === 'critical').length || 0,
                high: issues?.filter(i => i.severity === 'high').length || 0,
                medium: issues?.filter(i => i.severity === 'medium').length || 0,
                low: issues?.filter(i => i.severity === 'low').length || 0
            },
            issues: issues || [],
            recommendations: this.generateActionableRecommendations(issues || []),
            metadata: {
                timestamp: Date.now(),
                ...metadata
            }
        };
    }
    getScoreEmoji(score) {
        if (score >= 90)
            return 'üü¢';
        if (score >= 75)
            return 'üü°';
        if (score >= 60)
            return 'üü†';
        return 'üî¥';
    }
    extractAgentName(text) {
        const match = text.match(/@(\w+)/);
        return match ? match[1] : '';
    }
    analyzeCrossFileConsistency(context) {
        return {
            [context.filePath || 'unknown']: context.content || ''
        };
    }
    hasConfigurationInconsistencies(context) {
        return false;
    }
}
exports.IntrospectiveAgent = IntrospectiveAgent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL25pc3NpbW1lbmFzaGUvVkVSU0FUSUwgU0RMQyBGVy9zcmMvYWdlbnRzL2ludHJvc3BlY3RpdmUtYWdlbnQudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsNkNBQWdGO0FBQ2hGLDRDQUFpRDtBQUNqRCwwRUFBc0U7QUE0RHRFLHNDQUFzQztBQUN0QyxNQUFhLHNCQUFzQjtJQUNqQyxLQUFLLENBQUMsVUFBVSxDQUFDLElBQVk7UUFDM0IsSUFBSSxDQUFDO1lBQ0gsTUFBTSxFQUFFLEdBQUcsd0RBQWEsVUFBVSxHQUFDLENBQUM7WUFDcEMsTUFBTSxFQUFFLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3RCLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUFDLE1BQU0sQ0FBQztZQUNQLE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztJQUNILENBQUM7SUFFRCxLQUFLLENBQUMsUUFBUSxDQUFDLElBQVk7UUFDekIsTUFBTSxFQUFFLEdBQUcsd0RBQWEsVUFBVSxHQUFDLENBQUM7UUFDcEMsT0FBTyxNQUFNLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzFDLENBQUM7Q0FDRjtBQWZELHdEQWVDO0FBRUQsTUFBYSxtQkFBbUI7SUFDOUIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFlLEVBQUUsU0FBaUI7UUFDOUMsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLHdEQUFhLGVBQWUsR0FBQyxDQUFDO1FBQy9DLE1BQU0sRUFBRSxTQUFTLEVBQUUsR0FBRyx3REFBYSxNQUFNLEdBQUMsQ0FBQztRQUMzQyxNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFbEMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUNyQyxNQUFNLE9BQU8sR0FBRyxVQUFVLENBQUMsR0FBRyxFQUFFO2dC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LEVBQUUsQ0FBQztZQUNyRSxRQUFRLEVBQUU7Z0JBQ1IsU0FBUyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUU7Z0JBQ3JCLEdBQUcsUUFBUTthQUNaO1NBQ0YsQ0FBQztJQUNKLENBQUM7SUFFRCxhQUFhLENBQUMsS0FBYTtRQUN6QixJQUFJLEtBQUssSUFBSSxFQUFFO1lBQUUsT0FBTyxJQUFJLENBQUM7UUFDN0IsSUFBSSxLQUFLLElBQUksRUFBRTtZQUFFLE9BQU8sSUFBSSxDQUFDO1FBQzdCLElBQUksS0FBSyxJQUFJLEVBQUU7WUFBRSxPQUFPLElBQUksQ0FBQztRQUM3QixPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFRCxnQkFBZ0IsQ0FBQyxJQUFZO1FBQzNCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbkMsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBQy9CLENBQUM7SUFFUywyQkFBMkIsQ0FBQyxPQUErQjtRQUNuRSxPQUFPO1lBQ0wsQ0FBQyxPQUFPLENBQUMsUUFBUSxJQUFJLFNBQVMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxPQUFPLElBQUksRUFBRTtTQUN2RCxDQUFDO0lBQ0osQ0FBQztJQUVELCtCQUErQixDQUFDLE9BQVk7UUFDMUMsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0NBRUY7QUF4ZkQsZ0RBd2ZDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9uaXNzaW1tZW5hc2hlL1ZFUlNBVElMIFNETEMgRlcvc3JjL2FnZW50cy9pbnRyb3NwZWN0aXZlLWFnZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSW50cm9zcGVjdGl2ZUFnZW50IC0gVGVzdGFibGUgd2l0aG91dCBtb2Nrc1xuICogVXNlcyBkZXBlbmRlbmN5IGluamVjdGlvbiBmb3IgcmVhbCB0ZXN0aW5nXG4gKi9cblxuaW1wb3J0IHsgQmFzZUFnZW50LCBBZ2VudFJlc3BvbnNlLCBBZ2VudEFjdGl2YXRpb25Db250ZXh0IH0gZnJvbSAnLi9iYXNlLWFnZW50JztcbmltcG9ydCB7IFZFUlNBVElMTG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvbG9nZ2VyJztcbmltcG9ydCB7IFBlcmZvcm1hbmNlTW9uaXRvciB9IGZyb20gJy4uL2FuYWx5dGljcy9wZXJmb3JtYW5jZS1tb25pdG9yJztcblxuZXhwb3J0IGludGVyZmFjZSBJbnRyb3NwZWN0aW9uUmVzdWx0IHtcbiAgaW5zaWdodHM6IEluc2lnaHRbXTtcbiAgcmVjb21tZW5kYXRpb25zOiBSZWNvbW1lbmRhdGlvbltdO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgY29uZmlkZW5jZTogbnVtYmVyO1xuICBoZWFsdGhTY29yZTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEluc2lnaHQge1xuICB0eXBlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGNvbmZpZGVuY2U6IG51bWJlcjtcbiAgaW1wYWN0Pzogc3RyaW5nO1xuICBhY3Rpb25hYmxlPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZWNvbW1lbmRhdGlvbiB7XG4gIHR5cGU6IHN0cmluZztcbiAgbWVzc2FnZTogc3RyaW5nO1xuICBwcmlvcml0eTogc3RyaW5nO1xuICBlc3RpbWF0ZWRFZmZvcnQ/OiBzdHJpbmc7XG4gIGF1dG9GaXhhYmxlPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbXByb3ZlbWVudFJlY29yZCB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBpbXBhY3Q6IHN0cmluZztcbiAgc3VjY2VzczogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGcmFtZXdvcmtIZWFsdGgge1xuICBzY29yZTogbnVtYmVyO1xuICBjb25maWdGaWxlczogeyBba2V5OiBzdHJpbmddOiBib29sZWFuIH07XG4gIGRlcGVuZGVuY2llczogeyB0b3RhbDogbnVtYmVyOyBvdXRkYXRlZDogbnVtYmVyIH07XG4gIHZ1bG5lcmFiaWxpdGllczogbnVtYmVyO1xuICBpc3N1ZXM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBlcmZvcm1hbmNlTWV0cmljcyB7XG4gIGJ1aWxkVGltZTogbnVtYmVyO1xuICB0ZXN0VGltZTogbnVtYmVyO1xuICBsaW50VGltZTogbnVtYmVyO1xuICBtZW1vcnlVc2FnZTogTm9kZUpTLk1lbW9yeVVzYWdlO1xufVxuXG4vLyBBYnN0cmFjdGlvbiBmb3IgZmlsZSBzeXN0ZW0gb3BlcmF0aW9uc1xuZXhwb3J0IGludGVyZmFjZSBGaWxlU3lzdGVtUHJvdmlkZXIge1xuICBmaWxlRXhpc3RzKHBhdGg6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj47XG4gIHJlYWRGaWxlKHBhdGg6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPjtcbn1cblxuLy8gQWJzdHJhY3Rpb24gZm9yIGNvbW1hbmQgZXhlY3V0aW9uXG5leHBvcnQgaW50ZXJmYWNlIENvbW1hbmRFeGVjdXRvciB7XG4gIGV4ZWN1dGUoY29tbWFuZDogc3RyaW5nLCB0aW1lb3V0TXM6IG51bWJlcik6IFByb21pc2U8eyBzdGRvdXQ6IHN0cmluZzsgc3RkZXJyOiBzdHJpbmcgfT47XG59XG5cbi8vIFJlYWwgaW1wbGVtZW50YXRpb25zIGZvciBwcm9kdWN0aW9uXG5leHBvcnQgY2xhc3MgUmVhbEZpbGVTeXN0ZW1Qcm92aWRlciBpbXBsZW1lbnRzIEZpbGVTeXN0ZW1Qcm92aWRlciB7XG4gIGFzeW5jIGZpbGVFeGlzdHMocGF0aDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZzID0gYXdhaXQgaW1wb3J0KCdmcy1leHRyYScpO1xuICAgICAgYXdhaXQgZnMuYWNjZXNzKHBhdGgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVhZEZpbGUocGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBmcyA9IGF3YWl0IGltcG9ydCgnZnMtZXh0cmEnKTtcbiAgICByZXR1cm4gYXdhaXQgZnMucmVhZEZpbGUocGF0aCwgJ3V0Zi04Jyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlYWxDb21tYW5kRXhlY3V0b3IgaW1wbGVtZW50cyBDb21tYW5kRXhlY3V0b3Ige1xuICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IHN0cmluZywgdGltZW91dE1zOiBudW1iZXIpOiBQcm9taXNlPHsgc3Rkb3V0OiBzdHJpbmc7IHN0ZGVycjogc3RyaW5nIH0+IHtcbiAgICBjb25zdCB7IGV4ZWMgfSA9IGF3YWl0IGltcG9ydCgnY2hpbGRfcHJvY2VzcycpO1xuICAgIGNvbnN0IHsgcHJvbWlzaWZ5IH0gPSBhd2FpdCBpbXBvcnQoJ3V0aWwnKTtcbiAgICBjb25zdCBleGVjQXN5bmMgPSBwcm9taXNpZnkoZXhlYyk7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICByZWplY3QobmV3IEVycm9yKGBDb21tYW5kIHRpbWVvdXQ6ICR7Y29tbWFuZH1gKSk7XG4gICAgICB9LCB0aW1lb3V0TXMpO1xuXG4gICAgICBleGVjQXN5bmMoY29tbWFuZClcbiAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuXG4vLyBUZXN0IGltcGxlbWVudGF0aW9ucyAobGlnaHR3ZWlnaHQsIHJlYWwgYmVoYXZpb3IpXG5leHBvcnQgY2xhc3MgVGVzdEZpbGVTeXN0ZW1Qcm92aWRlciBpbXBsZW1lbnRzIEZpbGVTeXN0ZW1Qcm92aWRlciB7XG4gIHByaXZhdGUgZmlsZXM6IE1hcDxzdHJpbmcsIHN0cmluZz4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3IoaW5pdGlhbEZpbGVzOiB7IFtwYXRoOiBzdHJpbmddOiBzdHJpbmcgfSA9IHt9KSB7XG4gICAgZm9yIChjb25zdCBbcGF0aCwgY29udGVudF0gb2YgT2JqZWN0LmVudHJpZXMoaW5pdGlhbEZpbGVzKSkge1xuICAgICAgdGhpcy5maWxlcy5zZXQocGF0aCwgY29udGVudCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZmlsZUV4aXN0cyhwYXRoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gdGhpcy5maWxlcy5oYXMocGF0aCk7XG4gIH1cblxuICBhc3luYyByZWFkRmlsZShwYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLmZpbGVzLmdldChwYXRoKTtcbiAgICBpZiAoY29udGVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGUgbm90IGZvdW5kOiAke3BhdGh9YCk7XG4gICAgfVxuICAgIHJldHVybiBjb250ZW50O1xuICB9XG5cbiAgYWRkRmlsZShwYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuZmlsZXMuc2V0KHBhdGgsIGNvbnRlbnQpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUZXN0Q29tbWFuZEV4ZWN1dG9yIGltcGxlbWVudHMgQ29tbWFuZEV4ZWN1dG9yIHtcbiAgcHJpdmF0ZSByZXNwb25zZXM6IE1hcDxzdHJpbmcsIHsgc3Rkb3V0OiBzdHJpbmc7IHN0ZGVycjogc3RyaW5nOyBkZWxheTogbnVtYmVyIH0+ID0gbmV3IE1hcCgpO1xuXG4gIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogc3RyaW5nLCB0aW1lb3V0TXM6IG51bWJlcik6IFByb21pc2U8eyBzdGRvdXQ6IHN0cmluZzsgc3RkZXJyOiBzdHJpbmcgfT4ge1xuICAgIC8vIFNpbXVsYXRlIGRlbGF5XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwKSk7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IHRoaXMucmVzcG9uc2VzLmdldChjb21tYW5kKSB8fCB7IHN0ZG91dDogJycsIHN0ZGVycjogJycsIGRlbGF5OiAxMCB9O1xuXG4gICAgLy8gU2ltdWxhdGUgYWN0dWFsIGNvbW1hbmQgZGVsYXkgaWYgY29uZmlndXJlZFxuICAgIGlmIChyZXNwb25zZS5kZWxheSA+IDApIHtcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCByZXNwb25zZS5kZWxheSkpO1xuICAgIH1cblxuICAgIC8vIElmIHN0ZGVyciBpcyBwcmVzZW50LCB0aHJvdyBlcnJvciAoc2ltdWxhdGluZyBjb21tYW5kIGZhaWx1cmUpXG4gICAgaWYgKHJlc3BvbnNlLnN0ZGVycikge1xuICAgICAgY29uc3QgZXJyb3I6IGFueSA9IG5ldyBFcnJvcihgQ29tbWFuZCBmYWlsZWQ6ICR7Y29tbWFuZH1gKTtcbiAgICAgIGVycm9yLnN0ZG91dCA9IHJlc3BvbnNlLnN0ZG91dDtcbiAgICAgIGVycm9yLnN0ZGVyciA9IHJlc3BvbnNlLnN0ZGVycjtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cblxuICAgIHJldHVybiB7IHN0ZG91dDogcmVzcG9uc2Uuc3Rkb3V0LCBzdGRlcnI6IHJlc3BvbnNlLnN0ZGVyciB9O1xuICB9XG5cbiAgc2V0UmVzcG9uc2UoY29tbWFuZDogc3RyaW5nLCBzdGRvdXQ6IHN0cmluZywgc3RkZXJyOiBzdHJpbmcgPSAnJywgZGVsYXk6IG51bWJlciA9IDEwKTogdm9pZCB7XG4gICAgdGhpcy5yZXNwb25zZXMuc2V0KGNvbW1hbmQsIHsgc3Rkb3V0LCBzdGRlcnIsIGRlbGF5IH0pO1xuICB9XG59XG5cbi8qKlxuICogSW50cm9zcGVjdGl2ZUFnZW50IC0gVGVzdGFibGUgaW1wbGVtZW50YXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIEludHJvc3BlY3RpdmVBZ2VudCBleHRlbmRzIEJhc2VBZ2VudCB7XG4gIG5hbWUgPSAnSW50cm9zcGVjdGl2ZUFnZW50JztcbiAgaWQgPSAnaW50cm9zcGVjdGl2ZS1hZ2VudCc7XG4gIHNwZWNpYWxpemF0aW9uID0gJ1NlbGYtTW9uaXRvcmluZyAmIE9wdGltaXphdGlvbiBDb250cm9sbGVyJztcbiAgc3lzdGVtUHJvbXB0ID0gJ0F1dG9ub21vdXMgYWdlbnQgcmVzcG9uc2libGUgZm9yIGZyYW1ld29yayBpbnRyb3NwZWN0aW9uLCBvcHRpbWl6YXRpb24sIGFuZCBzZWxmLWltcHJvdmVtZW50JztcblxuICBwcml2YXRlIGxvZ2dlcjogVkVSU0FUSUxMb2dnZXI7XG4gIHByaXZhdGUgcGVyZm9ybWFuY2VNb25pdG9yOiBQZXJmb3JtYW5jZU1vbml0b3I7XG4gIHByaXZhdGUgbGVhcm5pbmdJbnNpZ2h0czogTWFwPHN0cmluZywgSW5zaWdodD4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgaW1wcm92ZW1lbnRIaXN0b3J5OiBJbXByb3ZlbWVudFJlY29yZFtdID0gW107XG5cbiAgLy8gSW5qZWN0ZWQgZGVwZW5kZW5jaWVzXG4gIHByaXZhdGUgZmlsZVN5c3RlbTogRmlsZVN5c3RlbVByb3ZpZGVyO1xuICBwcml2YXRlIGNvbW1hbmRFeGVjdXRvcjogQ29tbWFuZEV4ZWN1dG9yO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGZpbGVTeXN0ZW0/OiBGaWxlU3lzdGVtUHJvdmlkZXIsXG4gICAgY29tbWFuZEV4ZWN1dG9yPzogQ29tbWFuZEV4ZWN1dG9yXG4gICkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5sb2dnZXIgPSBWRVJTQVRJTExvZ2dlci5nZXRJbnN0YW5jZSgpO1xuICAgIHRoaXMucGVyZm9ybWFuY2VNb25pdG9yID0gbmV3IFBlcmZvcm1hbmNlTW9uaXRvcigpO1xuXG4gICAgLy8gVXNlIGluamVjdGVkIG9yIGRlZmF1bHQgdG8gcmVhbCBpbXBsZW1lbnRhdGlvbnNcbiAgICB0aGlzLmZpbGVTeXN0ZW0gPSBmaWxlU3lzdGVtIHx8IG5ldyBSZWFsRmlsZVN5c3RlbVByb3ZpZGVyKCk7XG4gICAgdGhpcy5jb21tYW5kRXhlY3V0b3IgPSBjb21tYW5kRXhlY3V0b3IgfHwgbmV3IFJlYWxDb21tYW5kRXhlY3V0b3IoKTtcblxuICAgIHRoaXMubG9nZ2VyLmluZm8oXG4gICAgICAnSW50cm9zcGVjdGl2ZUFnZW50IGluaXRpYWxpemVkIHdpdGggdG9vbC1iYXNlZCBjb250cm9sbGVyIGFyY2hpdGVjdHVyZScsXG4gICAgICB7XG4gICAgICAgIGZlYXR1cmVzOiBbXG4gICAgICAgICAgJ0ZyYW1ld29yayBIZWFsdGggTW9uaXRvcmluZycsXG4gICAgICAgICAgJ1BlcmZvcm1hbmNlIE9wdGltaXphdGlvbiBFbmdpbmUnLFxuICAgICAgICAgICdQYXR0ZXJuIFJlY29nbml0aW9uIFN5c3RlbScsXG4gICAgICAgICAgJ01ldGEtTGVhcm5pbmcgQ2FwYWJpbGl0aWVzJyxcbiAgICAgICAgICAnQXV0b25vbW91cyBJbXByb3ZlbWVudCBFbmdpbmUnXG4gICAgICAgIF1cbiAgICAgIH0sXG4gICAgICAnSW50cm9zcGVjdGl2ZUFnZW50J1xuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogTWFpbiBhY3RpdmF0aW9uIG1ldGhvZFxuICAgKi9cbiAgYXN5bmMgYWN0aXZhdGUoY29udGV4dDogQWdlbnRBY3RpdmF0aW9uQ29udGV4dCk6IFByb21pc2U8QWdlbnRSZXNwb25zZT4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICB0aGlzLmxvZ2dlci5pbmZvKFxuICAgICAgJ/CflI0gU3RhcnRpbmcgaW50cm9zcGVjdGl2ZSBhbmFseXNpcyB1c2luZyB0b29sIGNvbnRyb2xsZXJzJyxcbiAgICAgIHtcbiAgICAgICAgY29udGV4dDogY29udGV4dC50cmlnZ2VyIHx8ICd1bmtub3duJ1xuICAgICAgfSxcbiAgICAgICdJbnRyb3NwZWN0aXZlQWdlbnQnXG4gICAgKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBQZXJmb3JtIGFuYWx5c2lzXG4gICAgICBjb25zdCBoZWFsdGhBc3Nlc3NtZW50ID0gYXdhaXQgdGhpcy5hc3Nlc3NGcmFtZXdvcmtIZWFsdGgoKTtcbiAgICAgIGNvbnN0IHBlcmZvcm1hbmNlTWV0cmljcyA9IGF3YWl0IHRoaXMuYW5hbHl6ZVBlcmZvcm1hbmNlKCk7XG4gICAgICBjb25zdCBwYXR0ZXJucyA9IGF3YWl0IHRoaXMuZGlzY292ZXJQYXR0ZXJucyhjb250ZXh0KTtcbiAgICAgIGNvbnN0IGxlYXJuaW5nSW5zaWdodHMgPSBhd2FpdCB0aGlzLnBlcmZvcm1NZXRhTGVhcm5pbmcoKTtcblxuICAgICAgY29uc3QgY29uZmlkZW5jZSA9IHRoaXMuY2FsY3VsYXRlQ29uZmlkZW5jZShoZWFsdGhBc3Nlc3NtZW50LCBwZXJmb3JtYW5jZU1ldHJpY3MpO1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSB0aGlzLmdlbmVyYXRlU3VnZ2VzdGlvbnMoXG4gICAgICAgIGhlYWx0aEFzc2Vzc21lbnQsXG4gICAgICAgIHBlcmZvcm1hbmNlTWV0cmljcyxcbiAgICAgICAgcGF0dGVybnMsXG4gICAgICAgIGxlYXJuaW5nSW5zaWdodHNcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGhhbmRvZmZUbyA9IHRoaXMuZGV0ZXJtaW5lSGFuZG9mZnNGcm9tQW5hbHlzaXMoc3VnZ2VzdGlvbnMpO1xuICAgICAgY29uc3QgcHJpb3JpdHkgPSB0aGlzLmNhbGN1bGF0ZVByaW9yaXR5RnJvbVN1Z2dlc3Rpb25zKHN1Z2dlc3Rpb25zKTtcbiAgICAgIGNvbnN0IGV4ZWN1dGlvblRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuXG4gICAgICB0aGlzLmxvZ2dlci5pbmZvKFxuICAgICAgICAn4pyFIEludHJvc3BlY3RpdmUgYW5hbHlzaXMgY29tcGxldGVkJyxcbiAgICAgICAge1xuICAgICAgICAgIGV4ZWN1dGlvblRpbWU6IGAke2V4ZWN1dGlvblRpbWV9bXNgLFxuICAgICAgICAgIGltcHJvdmVtZW50czogc3VnZ2VzdGlvbnMubGVuZ3RoLFxuICAgICAgICAgIGNvbmZpZGVuY2VcbiAgICAgICAgfSxcbiAgICAgICAgJ0ludHJvc3BlY3RpdmVBZ2VudCdcbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFnZW50SWQ6IHRoaXMuaWQsXG4gICAgICAgIG1lc3NhZ2U6IGBJbnRyb3NwZWN0aXZlIGFuYWx5c2lzIGNvbXBsZXRlZCB3aXRoICR7c3VnZ2VzdGlvbnMubGVuZ3RofSBpbnNpZ2h0c2AsXG4gICAgICAgIHN1Z2dlc3Rpb25zLFxuICAgICAgICBwcmlvcml0eSxcbiAgICAgICAgaGFuZG9mZlRvLFxuICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgY29uZmlkZW5jZSxcbiAgICAgICAgICBpbnRyb3NwZWN0aW9uVGltZTogZXhlY3V0aW9uVGltZSxcbiAgICAgICAgICBoZWFsdGhTY29yZTogaGVhbHRoQXNzZXNzbWVudC5zY29yZSxcbiAgICAgICAgICBwZXJmb3JtYW5jZU1ldHJpY3MsXG4gICAgICAgICAgcGF0dGVybnM6IHBhdHRlcm5zLmxlbmd0aCxcbiAgICAgICAgICBsZWFybmluZ0luc2lnaHRzOiBsZWFybmluZ0luc2lnaHRzLmxlbmd0aCxcbiAgICAgICAgICAvLyBBZGRpdGlvbmFsIGZpZWxkcyBmb3IgdGVzdCBjb21wYXRpYmlsaXR5XG4gICAgICAgICAgcGF0dGVybnNEaXNjb3ZlcmVkOiBwYXR0ZXJucy5sZW5ndGgsXG4gICAgICAgICAgbGVhcm5pbmdVcGRhdGVzOiBsZWFybmluZ0luc2lnaHRzLmxlbmd0aCxcbiAgICAgICAgICBvcHRpbWl6YXRpb25zQXBwbGllZDogc3VnZ2VzdGlvbnMuZmlsdGVyKHMgPT4gcy5hdXRvRml4YWJsZSkubGVuZ3RoLFxuICAgICAgICAgIHF1YWxpdHlHYXRlczoge1xuICAgICAgICAgICAgY29uZmlnOiBoZWFsdGhBc3Nlc3NtZW50LnNjb3JlID49IDAuOCxcbiAgICAgICAgICAgIHNlY3VyaXR5OiBoZWFsdGhBc3Nlc3NtZW50LnZ1bG5lcmFiaWxpdGllcyA9PT0gMCxcbiAgICAgICAgICAgIHBlcmZvcm1hbmNlOiBwZXJmb3JtYW5jZU1ldHJpY3MuYnVpbGRUaW1lID4gMCAmJiBwZXJmb3JtYW5jZU1ldHJpY3MuYnVpbGRUaW1lIDwgMzAwMDAsXG4gICAgICAgICAgICBvdmVyYWxsOiBjb25maWRlbmNlID49IDAuN1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgJ+KdjCBJbnRyb3NwZWN0aXZlIGFuYWx5c2lzIGZhaWxlZCcsXG4gICAgICAgIHtcbiAgICAgICAgICBlcnJvcjogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHQudHJpZ2dlciB8fCAndW5rbm93bidcbiAgICAgICAgfSxcbiAgICAgICAgJ0ludHJvc3BlY3RpdmVBZ2VudCdcbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFnZW50SWQ6IHRoaXMuaWQsXG4gICAgICAgIG1lc3NhZ2U6IGBGcmFtZXdvcmsgZW5jb3VudGVyZWQgZXJyb3JzIGFuZCByZXF1aXJlcyBpbnZlc3RpZ2F0aW9uOiAke2Vycm9yTWVzc2FnZX1gLFxuICAgICAgICBzdWdnZXN0aW9uczogW3tcbiAgICAgICAgICB0eXBlOiAnZXJyb3ItcmVjb3ZlcnknLFxuICAgICAgICAgIG1lc3NhZ2U6ICdSdW4gZnJhbWV3b3JrIHJlY292ZXJ5OiBucG0gcnVuIHJlY292ZXInLFxuICAgICAgICAgIHByaW9yaXR5OiAnaGlnaCdcbiAgICAgICAgfSwge1xuICAgICAgICAgIHR5cGU6ICdjb25maWd1cmF0aW9uLWNoZWNrJyxcbiAgICAgICAgICBtZXNzYWdlOiAnVmVyaWZ5IGZyYW1ld29yayBjb25maWd1cmF0aW9uIGFuZCBkZXBlbmRlbmNpZXMnLFxuICAgICAgICAgIHByaW9yaXR5OiAnbWVkaXVtJ1xuICAgICAgICB9XSxcbiAgICAgICAgcHJpb3JpdHk6ICdsb3cnLFxuICAgICAgICBoYW5kb2ZmVG86IFtdLFxuICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgY29uZmlkZW5jZTogMC4xLFxuICAgICAgICAgIGVycm9yOiB0cnVlLFxuICAgICAgICAgIGVycm9yTWVzc2FnZVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBc3Nlc3MgZnJhbWV3b3JrIGhlYWx0aFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhc3Nlc3NGcmFtZXdvcmtIZWFsdGgoKTogUHJvbWlzZTxGcmFtZXdvcmtIZWFsdGg+IHtcbiAgICBjb25zdCBjb25maWdGaWxlcyA9IHtcbiAgICAgICdwYWNrYWdlLmpzb24nOiBmYWxzZSxcbiAgICAgICd0c2NvbmZpZy5qc29uJzogZmFsc2UsXG4gICAgICAnamVzdC5jb25maWcuY2pzJzogZmFsc2UsXG4gICAgICAnLnZlcnNhdGlsLXByb2plY3QuanNvbic6IGZhbHNlXG4gICAgfTtcblxuICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgIC8vIENoZWNrIGNvbmZpZ3VyYXRpb24gZmlsZXMgdXNpbmcgaW5qZWN0ZWQgZmlsZSBzeXN0ZW1cbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgT2JqZWN0LmtleXMoY29uZmlnRmlsZXMpKSB7XG4gICAgICBjb25zdCBleGlzdHMgPSBhd2FpdCB0aGlzLmZpbGVTeXN0ZW0uZmlsZUV4aXN0cyhmaWxlKTtcbiAgICAgIGNvbmZpZ0ZpbGVzW2ZpbGVdID0gZXhpc3RzO1xuICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgaXNzdWVzLnB1c2goYE1pc3NpbmcgY29uZmlndXJhdGlvbiBmaWxlOiAke2ZpbGV9YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIHZ1bG5lcmFiaWxpdGllcyB1c2luZyBpbmplY3RlZCBjb21tYW5kIGV4ZWN1dG9yXG4gICAgbGV0IHZ1bG5lcmFiaWxpdGllcyA9IDA7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGF1ZGl0UmVzdWx0ID0gYXdhaXQgdGhpcy5jb21tYW5kRXhlY3V0b3IuZXhlY3V0ZSgnbnBtIGF1ZGl0IC0tanNvbicsIDUwMDApO1xuICAgICAgY29uc3QgYXVkaXREYXRhID0gSlNPTi5wYXJzZShhdWRpdFJlc3VsdC5zdGRvdXQpO1xuICAgICAgdnVsbmVyYWJpbGl0aWVzID0gYXVkaXREYXRhLm1ldGFkYXRhPy52dWxuZXJhYmlsaXRpZXM/LnRvdGFsIHx8IDA7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIG5wbSBhdWRpdCByZXR1cm5zIG5vbi16ZXJvIGZvciB2dWxuZXJhYmlsaXRpZXMsIHRyeSBwYXJzaW5nIGFueXdheVxuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgJ3N0ZG91dCcgaW4gKGVycm9yIGFzIGFueSkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBhdWRpdERhdGEgPSBKU09OLnBhcnNlKChlcnJvciBhcyBhbnkpLnN0ZG91dCk7XG4gICAgICAgICAgdnVsbmVyYWJpbGl0aWVzID0gYXVkaXREYXRhLm1ldGFkYXRhPy52dWxuZXJhYmlsaXRpZXM/LnRvdGFsIHx8IDA7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgIC8vIFBhcnNpbmcgZmFpbGVkLCBhc3N1bWUgbm8gdnVsbmVyYWJpbGl0aWVzXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgaGVhbHRoIHNjb3JlXG4gICAgY29uc3QgY29uZmlnU2NvcmUgPSBPYmplY3QudmFsdWVzKGNvbmZpZ0ZpbGVzKS5maWx0ZXIoQm9vbGVhbikubGVuZ3RoIC8gT2JqZWN0LmtleXMoY29uZmlnRmlsZXMpLmxlbmd0aDtcbiAgICBjb25zdCBzZWN1cml0eVNjb3JlID0gdnVsbmVyYWJpbGl0aWVzID09PSAwID8gMSA6IE1hdGgubWF4KDAsIDEgLSAodnVsbmVyYWJpbGl0aWVzICogMC4xKSk7XG4gICAgY29uc3QgaGVhbHRoU2NvcmUgPSAoY29uZmlnU2NvcmUgKiAwLjYgKyBzZWN1cml0eVNjb3JlICogMC40KTtcblxuICAgIHJldHVybiB7XG4gICAgICBzY29yZTogaGVhbHRoU2NvcmUsXG4gICAgICBjb25maWdGaWxlcyxcbiAgICAgIGRlcGVuZGVuY2llczogeyB0b3RhbDogMCwgb3V0ZGF0ZWQ6IDAgfSxcbiAgICAgIHZ1bG5lcmFiaWxpdGllcyxcbiAgICAgIGlzc3Vlc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQW5hbHl6ZSBwZXJmb3JtYW5jZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplUGVyZm9ybWFuY2UoKTogUHJvbWlzZTxQZXJmb3JtYW5jZU1ldHJpY3M+IHtcbiAgICBjb25zdCBtZXRyaWNzOiBQZXJmb3JtYW5jZU1ldHJpY3MgPSB7XG4gICAgICBidWlsZFRpbWU6IDAsXG4gICAgICB0ZXN0VGltZTogMCxcbiAgICAgIGxpbnRUaW1lOiAwLFxuICAgICAgbWVtb3J5VXNhZ2U6IHByb2Nlc3MubWVtb3J5VXNhZ2UoKVxuICAgIH07XG5cbiAgICAvLyBNZWFzdXJlIGJ1aWxkIHRpbWVcbiAgICB0cnkge1xuICAgICAgY29uc3QgYnVpbGRTdGFydCA9IERhdGUubm93KCk7XG4gICAgICBhd2FpdCB0aGlzLmNvbW1hbmRFeGVjdXRvci5leGVjdXRlKCducG0gcnVuIGJ1aWxkJywgNjAwMDApO1xuICAgICAgbWV0cmljcy5idWlsZFRpbWUgPSBEYXRlLm5vdygpIC0gYnVpbGRTdGFydDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIG1ldHJpY3MuYnVpbGRUaW1lID0gLTE7XG4gICAgfVxuXG4gICAgLy8gTWVhc3VyZSB0ZXN0IHRpbWVcbiAgICB0cnkge1xuICAgICAgY29uc3QgdGVzdFN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICAgIGF3YWl0IHRoaXMuY29tbWFuZEV4ZWN1dG9yLmV4ZWN1dGUoJ25wbSB0ZXN0IC0tIC0tc2lsZW50JywgMzAwMDApO1xuICAgICAgbWV0cmljcy50ZXN0VGltZSA9IERhdGUubm93KCkgLSB0ZXN0U3RhcnQ7XG4gICAgfSBjYXRjaCB7XG4gICAgICBtZXRyaWNzLnRlc3RUaW1lID0gLTE7XG4gICAgfVxuXG4gICAgLy8gTWVhc3VyZSBsaW50IHRpbWVcbiAgICB0cnkge1xuICAgICAgY29uc3QgbGludFN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICAgIGF3YWl0IHRoaXMuY29tbWFuZEV4ZWN1dG9yLmV4ZWN1dGUoJ25wbSBydW4gbGludCcsIDE1MDAwKTtcbiAgICAgIG1ldHJpY3MubGludFRpbWUgPSBEYXRlLm5vdygpIC0gbGludFN0YXJ0O1xuICAgIH0gY2F0Y2gge1xuICAgICAgbWV0cmljcy5saW50VGltZSA9IC0xO1xuICAgIH1cblxuICAgIHJldHVybiBtZXRyaWNzO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc2NvdmVyIHBhdHRlcm5zXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyUGF0dGVybnMoY29udGV4dDogQWdlbnRBY3RpdmF0aW9uQ29udGV4dCk6IFByb21pc2U8SW5zaWdodFtdPiB7XG4gICAgY29uc3QgcGF0dGVybnM6IEluc2lnaHRbXSA9IFtdO1xuXG4gICAgaWYgKGNvbnRleHQuY29udGVudCAmJiBjb250ZXh0LmNvbnRlbnQuaW5jbHVkZXMoJ3Rlc3QnKSkge1xuICAgICAgcGF0dGVybnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICd0ZXN0LWNvdmVyYWdlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdUZXN0IGZpbGUgZGV0ZWN0ZWQgLSBjb25zaWRlciBjaGVja2luZyBjb3ZlcmFnZSBtZXRyaWNzJyxcbiAgICAgICAgY29uZmlkZW5jZTogMC45LFxuICAgICAgICBpbXBhY3Q6ICdoaWdoJyxcbiAgICAgICAgYWN0aW9uYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuY29udGVudCAmJiAoY29udGV4dC5jb250ZW50LmluY2x1ZGVzKCdwZXJmb3JtYW5jZScpIHx8IGNvbnRleHQuY29udGVudC5pbmNsdWRlcygnb3B0aW1pemF0aW9uJykpKSB7XG4gICAgICBwYXR0ZXJucy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3BlcmZvcm1hbmNlLWZvY3VzJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdQZXJmb3JtYW5jZS1yZWxhdGVkIGNvZGUgZGV0ZWN0ZWQgLSBtb25pdG9yaW5nIGZvciBvcHRpbWl6YXRpb24gb3Bwb3J0dW5pdGllcycsXG4gICAgICAgIGNvbmZpZGVuY2U6IDAuODUsXG4gICAgICAgIGltcGFjdDogJ2hpZ2gnLFxuICAgICAgICBhY3Rpb25hYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGF0dGVybnM7XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBtZXRhLWxlYXJuaW5nXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1NZXRhTGVhcm5pbmcoKTogUHJvbWlzZTxJbnNpZ2h0W10+IHtcbiAgICBjb25zdCBpbnNpZ2h0czogSW5zaWdodFtdID0gW107XG5cbiAgICBpZiAodGhpcy5pbXByb3ZlbWVudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3Qgc3VjY2Vzc1JhdGUgPSB0aGlzLmltcHJvdmVtZW50SGlzdG9yeS5maWx0ZXIoaSA9PiBpLnN1Y2Nlc3MpLmxlbmd0aCAvIHRoaXMuaW1wcm92ZW1lbnRIaXN0b3J5Lmxlbmd0aDtcbiAgICAgIGlmIChzdWNjZXNzUmF0ZSA8IDAuNSkge1xuICAgICAgICBpbnNpZ2h0cy5wdXNoKHtcbiAgICAgICAgICB0eXBlOiAnbWV0YS1sZWFybmluZycsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdMb3cgc3VjY2VzcyByYXRlIGluIHBhc3QgaW1wcm92ZW1lbnRzIC0gcmV2aWV3IG9wdGltaXphdGlvbiBzdHJhdGVneScsXG4gICAgICAgICAgY29uZmlkZW5jZTogMC43LFxuICAgICAgICAgIGltcGFjdDogJ21lZGl1bScsXG4gICAgICAgICAgYWN0aW9uYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5sZWFybmluZ0luc2lnaHRzLnNpemUgPiAxMCkge1xuICAgICAgaW5zaWdodHMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdtZXRhLWxlYXJuaW5nJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGBBY2N1bXVsYXRlZCAke3RoaXMubGVhcm5pbmdJbnNpZ2h0cy5zaXplfSBpbnNpZ2h0cyAtIHJlYWR5IGZvciBwYXR0ZXJuIHN5bnRoZXNpc2AsXG4gICAgICAgIGNvbmZpZGVuY2U6IDAuOSxcbiAgICAgICAgaW1wYWN0OiAnaGlnaCcsXG4gICAgICAgIGFjdGlvbmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBpbnNpZ2h0cztcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlQ29uZmlkZW5jZShoZWFsdGg6IEZyYW1ld29ya0hlYWx0aCwgcGVyZm9ybWFuY2U6IFBlcmZvcm1hbmNlTWV0cmljcyk6IG51bWJlciB7XG4gICAgbGV0IGNvbmZpZGVuY2UgPSAwLjU7XG5cbiAgICAvLyBIZWFsdGggc2NvcmUgaXMgaGVhdmlseSB3ZWlnaHRlZCAoNDAlKVxuICAgIGNvbmZpZGVuY2UgKz0gaGVhbHRoLnNjb3JlICogMC40O1xuXG4gICAgLy8gUGVyZm9ybWFuY2Ugc2NvcmUgKDMwJSkgLSBwZW5hbGl6ZSBuZWdhdGl2ZSB2YWx1ZXMgKGNvbW1hbmQgZmFpbHVyZXMpXG4gICAgY29uc3QgcGVyZlNjb3JlID0gKFxuICAgICAgKHBlcmZvcm1hbmNlLmJ1aWxkVGltZSA+IDAgJiYgcGVyZm9ybWFuY2UuYnVpbGRUaW1lIDwgMzAwMDAgPyAwLjMzIDogcGVyZm9ybWFuY2UuYnVpbGRUaW1lID09PSAtMSA/IC0wLjEgOiAwKSArXG4gICAgICAocGVyZm9ybWFuY2UudGVzdFRpbWUgPiAwICYmIHBlcmZvcm1hbmNlLnRlc3RUaW1lIDwgMTUwMDAgPyAwLjMzIDogcGVyZm9ybWFuY2UudGVzdFRpbWUgPT09IC0xID8gLTAuMSA6IDApICtcbiAgICAgIChwZXJmb3JtYW5jZS5saW50VGltZSA+IDAgJiYgcGVyZm9ybWFuY2UubGludFRpbWUgPCA1MDAwID8gMC4zNCA6IHBlcmZvcm1hbmNlLmxpbnRUaW1lID09PSAtMSA/IC0wLjEgOiAwKVxuICAgICk7XG4gICAgY29uZmlkZW5jZSArPSBwZXJmU2NvcmUgKiAwLjM7XG5cbiAgICBjb25zdCBtZW1vcnlNQiA9IHBlcmZvcm1hbmNlLm1lbW9yeVVzYWdlLmhlYXBVc2VkIC8gMTAyNCAvIDEwMjQ7XG4gICAgY29uc3QgbWVtb3J5U2NvcmUgPSBtZW1vcnlNQiA8IDEwMCA/IDEgOiBtZW1vcnlNQiA8IDIwMCA/IDAuNyA6IDAuMztcbiAgICBjb25maWRlbmNlICs9IG1lbW9yeVNjb3JlICogMC4yO1xuXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEsIGNvbmZpZGVuY2UpKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVTdWdnZXN0aW9ucyhcbiAgICBoZWFsdGg6IEZyYW1ld29ya0hlYWx0aCxcbiAgICBwZXJmb3JtYW5jZTogUGVyZm9ybWFuY2VNZXRyaWNzLFxuICAgIHBhdHRlcm5zOiBJbnNpZ2h0W10sXG4gICAgbGVhcm5pbmdJbnNpZ2h0czogSW5zaWdodFtdXG4gICk6IGFueVtdIHtcbiAgICBjb25zdCBzdWdnZXN0aW9uczogYW55W10gPSBbXTtcblxuICAgIGlmIChoZWFsdGgudnVsbmVyYWJpbGl0aWVzID4gMCkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzZWN1cml0eScsXG4gICAgICAgIG1lc3NhZ2U6IGBGaXggJHtoZWFsdGgudnVsbmVyYWJpbGl0aWVzfSBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXNgLFxuICAgICAgICBwcmlvcml0eTogJ2NyaXRpY2FsJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGhlYWx0aC5pc3N1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdjb25maWd1cmF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogJ1Jlc29sdmUgY29uZmlndXJhdGlvbiBpc3N1ZXM6ICcgKyBoZWFsdGguaXNzdWVzLmpvaW4oJywgJyksXG4gICAgICAgIHByaW9yaXR5OiAnaGlnaCdcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChwZXJmb3JtYW5jZS5idWlsZFRpbWUgPiAzMDAwMCkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdwZXJmb3JtYW5jZScsXG4gICAgICAgIG1lc3NhZ2U6ICdCdWlsZCB0aW1lIG9wdGltaXphdGlvbiByZWNvbW1lbmRlZCAtIGNvbnNpZGVyIGJ1aWxkIHRpbWUgb3B0aW1pemF0aW9uIHN0cmF0ZWdpZXMnLFxuICAgICAgICBwcmlvcml0eTogJ21lZGl1bSdcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IG1lbW9yeU1CID0gcGVyZm9ybWFuY2UubWVtb3J5VXNhZ2UuaGVhcFVzZWQgLyAxMDI0IC8gMTAyNDtcbiAgICBpZiAobWVtb3J5TUIgPiAxNTApIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xuICAgICAgICB0eXBlOiAncGVyZm9ybWFuY2UnLFxuICAgICAgICBtZXNzYWdlOiAnSGlnaCBtZW1vcnkgdXNhZ2UgZGV0ZWN0ZWQgLSBpbXBsZW1lbnQgbWVtb3J5IG9wdGltaXphdGlvbicsXG4gICAgICAgIHByaW9yaXR5OiAnbWVkaXVtJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XG4gICAgICBpZiAocGF0dGVybi5hY3Rpb25hYmxlKSB7XG4gICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xuICAgICAgICAgIHR5cGU6IHBhdHRlcm4udHlwZSxcbiAgICAgICAgICBtZXNzYWdlOiBwYXR0ZXJuLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIHByaW9yaXR5OiBwYXR0ZXJuLmltcGFjdCA9PT0gJ2hpZ2gnID8gJ2hpZ2gnIDogJ21lZGl1bSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICB9XG5cbiAgcHJpdmF0ZSBkZXRlcm1pbmVIYW5kb2Zmc0Zyb21BbmFseXNpcyhzdWdnZXN0aW9uczogYW55W10pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaGFuZG9mZnM6IHN0cmluZ1tdID0gW107XG4gICAgaWYgKHN1Z2dlc3Rpb25zLnNvbWUocyA9PiBzLnR5cGUgPT09ICdzZWN1cml0eScpKSBoYW5kb2Zmcy5wdXNoKCdzZWN1cml0eS1zYW0nKTtcbiAgICBpZiAoc3VnZ2VzdGlvbnMuc29tZShzID0+IHMudHlwZSA9PT0gJ3BlcmZvcm1hbmNlJykpIGhhbmRvZmZzLnB1c2goJ2VuaGFuY2VkLW1hcmN1cycpO1xuICAgIGlmIChzdWdnZXN0aW9ucy5zb21lKHMgPT4gcy50eXBlID09PSAndGVzdC1jb3ZlcmFnZScpKSBoYW5kb2Zmcy5wdXNoKCdlbmhhbmNlZC1tYXJpYScpO1xuICAgIHJldHVybiBoYW5kb2ZmcztcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlUHJpb3JpdHlGcm9tU3VnZ2VzdGlvbnMoc3VnZ2VzdGlvbnM6IGFueVtdKTogJ2NyaXRpY2FsJyB8ICdoaWdoJyB8ICdtZWRpdW0nIHwgJ2xvdycge1xuICAgIGlmIChzdWdnZXN0aW9ucy5zb21lKHMgPT4gcy5wcmlvcml0eSA9PT0gJ2NyaXRpY2FsJykpIHJldHVybiAnY3JpdGljYWwnO1xuICAgIGlmIChzdWdnZXN0aW9ucy5zb21lKHMgPT4gcy5wcmlvcml0eSA9PT0gJ2hpZ2gnKSkgcmV0dXJuICdoaWdoJztcbiAgICBpZiAoc3VnZ2VzdGlvbnMuc29tZShzID0+IHMucHJpb3JpdHkgPT09ICdtZWRpdW0nKSkgcmV0dXJuICdtZWRpdW0nO1xuICAgIHJldHVybiAnbG93JztcbiAgfVxuXG4gIC8vIFB1YmxpYyBBUEkgbWV0aG9kc1xuICBhc3luYyB0cmlnZ2VySW50cm9zcGVjdGlvbigpOiBQcm9taXNlPEludHJvc3BlY3Rpb25SZXN1bHQ+IHtcbiAgICBjb25zdCBoZWFsdGggPSBhd2FpdCB0aGlzLmFzc2Vzc0ZyYW1ld29ya0hlYWx0aCgpO1xuICAgIGNvbnN0IHBlcmZvcm1hbmNlID0gYXdhaXQgdGhpcy5hbmFseXplUGVyZm9ybWFuY2UoKTtcbiAgICBjb25zdCBwYXR0ZXJucyA9IGF3YWl0IHRoaXMuZGlzY292ZXJQYXR0ZXJucyh7IHRyaWdnZXI6ICdtYW51YWwtaW50cm9zcGVjdGlvbicgfSBhcyBBZ2VudEFjdGl2YXRpb25Db250ZXh0KTtcbiAgICBjb25zdCBsZWFybmluZ0luc2lnaHRzID0gYXdhaXQgdGhpcy5wZXJmb3JtTWV0YUxlYXJuaW5nKCk7XG5cbiAgICBjb25zdCBjb25maWRlbmNlID0gdGhpcy5jYWxjdWxhdGVDb25maWRlbmNlKGhlYWx0aCwgcGVyZm9ybWFuY2UpO1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gdGhpcy5nZW5lcmF0ZVN1Z2dlc3Rpb25zKGhlYWx0aCwgcGVyZm9ybWFuY2UsIHBhdHRlcm5zLCBsZWFybmluZ0luc2lnaHRzKTtcblxuICAgIHJldHVybiB7XG4gICAgICBpbnNpZ2h0czogWy4uLnBhdHRlcm5zLCAuLi5sZWFybmluZ0luc2lnaHRzXSxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogc3VnZ2VzdGlvbnMubWFwKHMgPT4gKHtcbiAgICAgICAgdHlwZTogcy50eXBlLFxuICAgICAgICBtZXNzYWdlOiBzLm1lc3NhZ2UsXG4gICAgICAgIHByaW9yaXR5OiBzLnByaW9yaXR5LFxuICAgICAgICBlc3RpbWF0ZWRFZmZvcnQ6ICdtZWRpdW0nLFxuICAgICAgICBhdXRvRml4YWJsZTogZmFsc2VcbiAgICAgIH0pKSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgIGNvbmZpZGVuY2UsXG4gICAgICBoZWFsdGhTY29yZTogaGVhbHRoLnNjb3JlXG4gICAgfTtcbiAgfVxuXG4gIGdldExlYXJuaW5nSW5zaWdodHMoKTogTWFwPHN0cmluZywgSW5zaWdodD4ge1xuICAgIHJldHVybiB0aGlzLmxlYXJuaW5nSW5zaWdodHM7XG4gIH1cblxuICBnZXRJbXByb3ZlbWVudEhpc3RvcnkoKTogSW1wcm92ZW1lbnRSZWNvcmRbXSB7XG4gICAgcmV0dXJuIHRoaXMuaW1wcm92ZW1lbnRIaXN0b3J5O1xuICB9XG5cbiAgLy8gQ29tbW9uIG1ldGhvZHMgZnJvbSBlYXJsaWVyXG4gIGNhbGN1bGF0ZVByaW9yaXR5KGlzc3VlczogYW55W10pOiBudW1iZXIge1xuICAgIGlmICghaXNzdWVzIHx8IGlzc3Vlcy5sZW5ndGggPT09IDApIHJldHVybiAwO1xuICAgIGNvbnN0IHNldmVyaXRpZXMgPSBpc3N1ZXMubWFwKGkgPT5cbiAgICAgIGkuc2V2ZXJpdHkgPT09ICdjcml0aWNhbCcgPyA0IDpcbiAgICAgIGkuc2V2ZXJpdHkgPT09ICdoaWdoJyA/IDMgOlxuICAgICAgaS5zZXZlcml0eSA9PT0gJ21lZGl1bScgPyAyIDogMVxuICAgICk7XG4gICAgcmV0dXJuIE1hdGgubWF4KC4uLnNldmVyaXRpZXMpO1xuICB9XG5cbiAgZGV0ZXJtaW5lSGFuZG9mZnMoaXNzdWVzOiBhbnlbXSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBoYW5kb2Zmczogc3RyaW5nW10gPSBbXTtcbiAgICBpZiAoIWlzc3VlcykgcmV0dXJuIGhhbmRvZmZzO1xuXG4gICAgY29uc3QgaGFzU2VjdXJpdHlJc3N1ZSA9IGlzc3Vlcy5zb21lKGkgPT4gaS50eXBlID09PSAnc2VjdXJpdHknKTtcbiAgICBjb25zdCBoYXNQZXJmb3JtYW5jZUlzc3VlID0gaXNzdWVzLnNvbWUoaSA9PiBpLnR5cGUgPT09ICdwZXJmb3JtYW5jZScpO1xuICAgIGNvbnN0IGhhc1VJSXNzdWUgPSBpc3N1ZXMuc29tZShpID0+IGkudHlwZSA9PT0gJ3VpJyB8fCBpLnR5cGUgPT09ICdhY2Nlc3NpYmlsaXR5Jyk7XG5cbiAgICBpZiAoaGFzU2VjdXJpdHlJc3N1ZSkgaGFuZG9mZnMucHVzaCgnc2VjdXJpdHktc2FtJyk7XG4gICAgaWYgKGhhc1BlcmZvcm1hbmNlSXNzdWUpIGhhbmRvZmZzLnB1c2goJ2VuaGFuY2VkLW1hcmN1cycpO1xuICAgIGlmIChoYXNVSUlzc3VlKSBoYW5kb2Zmcy5wdXNoKCdlbmhhbmNlZC1qYW1lcycpO1xuXG4gICAgcmV0dXJuIGhhbmRvZmZzO1xuICB9XG5cbiAgZ2VuZXJhdGVBY3Rpb25hYmxlUmVjb21tZW5kYXRpb25zKGlzc3VlczogYW55W10pOiBzdHJpbmdbXSB7XG4gICAgaWYgKCFpc3N1ZXMgfHwgaXNzdWVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFtdO1xuXG4gICAgcmV0dXJuIGlzc3Vlcy5tYXAoaXNzdWUgPT4ge1xuICAgICAgaWYgKGlzc3VlLnR5cGUgPT09ICdzZWN1cml0eScpIHtcbiAgICAgICAgcmV0dXJuIGBGaXggc2VjdXJpdHkgaXNzdWU6ICR7aXNzdWUubWVzc2FnZSB8fCAnU2VjdXJpdHkgdnVsbmVyYWJpbGl0eSBkZXRlY3RlZCd9YDtcbiAgICAgIH1cbiAgICAgIGlmIChpc3N1ZS50eXBlID09PSAncGVyZm9ybWFuY2UnKSB7XG4gICAgICAgIHJldHVybiBgT3B0aW1pemUgcGVyZm9ybWFuY2U6ICR7aXNzdWUubWVzc2FnZSB8fCAnUGVyZm9ybWFuY2UgaXNzdWUgZGV0ZWN0ZWQnfWA7XG4gICAgICB9XG4gICAgICByZXR1cm4gYEFkZHJlc3MgaXNzdWU6ICR7aXNzdWUubWVzc2FnZSB8fCBpc3N1ZS5kZXNjcmlwdGlvbiB8fCAnSXNzdWUgZGV0ZWN0ZWQnfWA7XG4gICAgfSk7XG4gIH1cblxuICBnZW5lcmF0ZUVuaGFuY2VkUmVwb3J0KGlzc3VlczogYW55W10sIG1ldGFkYXRhOiBhbnkgPSB7fSk6IGFueSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgdG90YWxJc3N1ZXM6IGlzc3Vlcz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgIGNyaXRpY2FsOiBpc3N1ZXM/LmZpbHRlcihpID0+IGkuc2V2ZXJpdHkgPT09ICdjcml0aWNhbCcpLmxlbmd0aCB8fCAwLFxuICAgICAgICBoaWdoOiBpc3N1ZXM/LmZpbHRlcihpID0+IGkuc2V2ZXJpdHkgPT09ICdoaWdoJykubGVuZ3RoIHx8IDAsXG4gICAgICAgIG1lZGl1bTogaXNzdWVzPy5maWx0ZXIoaSA9PiBpLnNldmVyaXR5ID09PSAnbWVkaXVtJykubGVuZ3RoIHx8IDAsXG4gICAgICAgIGxvdzogaXNzdWVzPy5maWx0ZXIoaSA9PiBpLnNldmVyaXR5ID09PSAnbG93JykubGVuZ3RoIHx8IDBcbiAgICAgIH0sXG4gICAgICBpc3N1ZXM6IGlzc3VlcyB8fCBbXSxcbiAgICAgIHJlY29tbWVuZGF0aW9uczogdGhpcy5nZW5lcmF0ZUFjdGlvbmFibGVSZWNvbW1lbmRhdGlvbnMoaXNzdWVzIHx8IFtdKSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgLi4ubWV0YWRhdGFcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgZ2V0U2NvcmVFbW9qaShzY29yZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBpZiAoc2NvcmUgPj0gOTApIHJldHVybiAn8J+foic7XG4gICAgaWYgKHNjb3JlID49IDc1KSByZXR1cm4gJ/Cfn6EnO1xuICAgIGlmIChzY29yZSA+PSA2MCkgcmV0dXJuICfwn5+gJztcbiAgICByZXR1cm4gJ/CflLQnO1xuICB9XG5cbiAgZXh0cmFjdEFnZW50TmFtZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaCgvQChcXHcrKS8pO1xuICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogJyc7XG4gIH1cblxuICBwcm90ZWN0ZWQgYW5hbHl6ZUNyb3NzRmlsZUNvbnNpc3RlbmN5KGNvbnRleHQ6IEFnZW50QWN0aXZhdGlvbkNvbnRleHQpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcbiAgICByZXR1cm4ge1xuICAgICAgW2NvbnRleHQuZmlsZVBhdGggfHwgJ3Vua25vd24nXTogY29udGV4dC5jb250ZW50IHx8ICcnXG4gICAgfTtcbiAgfVxuXG4gIGhhc0NvbmZpZ3VyYXRpb25JbmNvbnNpc3RlbmNpZXMoY29udGV4dDogYW55KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbn0iXSwidmVyc2lvbiI6M30=