18fa87a3672f092488269e3b26b92eef
"use strict";
/**
 * VERSATIL SDLC Framework - Configuration Wizard
 * Interactive setup wizard for first-time users
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.ConfigWizard = void 0;
exports.getDefaultConfigWizard = getDefaultConfigWizard;
const readline = __importStar(require("readline"));
const preference_manager_js_1 = require("./preference-manager.js");
const config_profiles_js_1 = require("./config-profiles.js");
class ConfigWizard {
    constructor() {
        this.rl = readline.createInterface({
            input: process.stdin,
            output: process.stdout
        });
        this.preferenceManager = new preference_manager_js_1.PreferenceManager();
        this.profileManager = new config_profiles_js_1.ConfigProfileManager();
    }
    /**
     * Run the setup wizard
     */
    async run() {
        console.log('\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó');
        console.log('‚ïë   üöÄ VERSATIL SDLC Framework - First-Time Setup   üöÄ   ‚ïë');
        console.log('‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n');
        console.log('Welcome! Let\'s configure your framework preferences.\n');
        console.log('You can change these settings anytime using: versatil config\n');
        // Ask if user wants quick setup or custom
        const setupType = await this.askChoice('Choose setup type:', [
            { key: '1', label: 'Quick Setup (use recommended defaults)', value: 'quick' },
            { key: '2', label: 'Custom Setup (choose your preferences)', value: 'custom' },
            { key: '3', label: 'Use Profile (conservative/balanced/aggressive)', value: 'profile' }
        ], '1');
        let preferences;
        if (setupType === 'quick') {
            preferences = await this.quickSetup();
        }
        else if (setupType === 'profile') {
            preferences = await this.profileSetup();
        }
        else {
            preferences = await this.customSetup();
        }
        // Save preferences
        await this.preferenceManager.savePreferences(preferences);
        console.log('\n‚úÖ Setup complete! Your preferences have been saved.\n');
        console.log('To view your preferences: versatil config show');
        console.log('To modify preferences: versatil config set <key> <value>\n');
        this.rl.close();
        return preferences;
    }
    /**
     * Quick setup with recommended defaults
     */
    async quickSetup() {
        console.log('\nüì¶ Quick Setup - Using Recommended Defaults\n');
        const preferences = this.preferenceManager.getDefaultPreferences();
        console.log('Your configuration:');
        console.log('  ‚Ä¢ Update Behavior: Notify (you approve updates)');
        console.log('  ‚Ä¢ Update Channel: Stable (production-ready only)');
        console.log('  ‚Ä¢ Safety Level: Balanced (good balance of safety and speed)');
        console.log('  ‚Ä¢ Auto-install Security Updates: Yes');
        console.log('  ‚Ä¢ Backup Before Update: Yes');
        console.log('  ‚Ä¢ Auto-rollback on Failure: Yes');
        console.log('  ‚Ä¢ Telemetry: Yes (helps improve the framework)');
        const confirm = await this.askYesNo('\nContinue with these settings?', true);
        if (!confirm) {
            console.log('\nLet\'s try custom setup instead...\n');
            return await this.customSetup();
        }
        return preferences;
    }
    /**
     * Profile-based setup
     */
    async profileSetup() {
        console.log('\nüìã Profile-Based Setup\n');
        const profiles = this.profileManager.getAvailableProfiles();
        console.log('Available profiles:\n');
        profiles.forEach(profile => {
            console.log(`${profile.emoji} ${profile.name}:`);
            console.log(`   ${profile.description}`);
            console.log(`   Best for: ${profile.bestFor}`);
            console.log('');
        });
        const profileChoice = await this.askChoice('Choose a profile:', [
            { key: '1', label: 'Conservative (maximum safety)', value: 'conservative' },
            { key: '2', label: 'Balanced (recommended)', value: 'balanced' },
            { key: '3', label: 'Aggressive (latest features)', value: 'aggressive' }
        ], '2');
        const profile = this.profileManager.getProfile(profileChoice);
        if (!profile) {
            throw new Error('Invalid profile');
        }
        console.log(`\n‚úÖ Using ${profile.name} profile\n`);
        return profile.preferences;
    }
    /**
     * Custom setup with user choices
     */
    async customSetup() {
        console.log('\n‚öôÔ∏è  Custom Setup\n');
        const preferences = this.preferenceManager.getDefaultPreferences();
        // Update behavior
        console.log('‚ïê‚ïê‚ïê Update Behavior ‚ïê‚ïê‚ïê\n');
        preferences.updateBehavior = await this.askChoice('How should updates be handled?', [
            { key: '1', label: 'Auto - Install updates automatically', value: 'auto' },
            { key: '2', label: 'Notify - Notify me, I approve (recommended)', value: 'notify' },
            { key: '3', label: 'Manual - I check for updates manually', value: 'manual' }
        ], '2');
        // Update channel
        console.log('\n‚ïê‚ïê‚ïê Update Channel ‚ïê‚ïê‚ïê\n');
        preferences.updateChannel = await this.askChoice('Which update channel?', [
            { key: '1', label: 'Stable - Production-ready releases only (recommended)', value: 'stable' },
            { key: '2', label: 'Beta - Early access to new features', value: 'beta' },
            { key: '3', label: 'Alpha - Bleeding edge (may be unstable)', value: 'alpha' }
        ], '1');
        // Safety level
        console.log('\n‚ïê‚ïê‚ïê Safety Level ‚ïê‚ïê‚ïê\n');
        preferences.safetyLevel = await this.askChoice('Choose safety level:', [
            { key: '1', label: 'Conservative - Maximum safety, slower updates', value: 'conservative' },
            { key: '2', label: 'Balanced - Good balance (recommended)', value: 'balanced' },
            { key: '3', label: 'Fast - Faster updates, less validation', value: 'fast' }
        ], '2');
        // Security updates
        console.log('\n‚ïê‚ïê‚ïê Security Updates ‚ïê‚ïê‚ïê\n');
        preferences.autoInstallSecurity = await this.askYesNo('Auto-install security updates? (recommended: yes)', true);
        // Backup
        console.log('\n‚ïê‚ïê‚ïê Backup ‚ïê‚ïê‚ïê\n');
        preferences.backupBeforeUpdate = await this.askYesNo('Create backup before each update? (recommended: yes)', true);
        if (preferences.backupBeforeUpdate) {
            const maxBackupsStr = await this.askInput('Maximum number of backups to keep:', '5');
            preferences.maxRollbackPoints = parseInt(maxBackupsStr, 10) || 5;
        }
        // Rollback
        console.log('\n‚ïê‚ïê‚ïê Rollback ‚ïê‚ïê‚ïê\n');
        preferences.rollbackOnFailure = await this.askYesNo('Auto-rollback if update fails? (recommended: yes)', true);
        // Notifications
        console.log('\n‚ïê‚ïê‚ïê Notifications ‚ïê‚ïê‚ïê\n');
        preferences.notificationLevel = await this.askChoice('Notification level:', [
            { key: '1', label: 'All - Show all notifications', value: 'all' },
            { key: '2', label: 'Important - Important updates only (recommended)', value: 'important' },
            { key: '3', label: 'Critical - Critical updates only', value: 'critical' },
            { key: '4', label: 'None - No notifications', value: 'none' }
        ], '2');
        // Telemetry
        console.log('\n‚ïê‚ïê‚ïê Telemetry ‚ïê‚ïê‚ïê\n');
        console.log('Telemetry helps us improve the framework by collecting anonymous usage data.');
        console.log('No personal information is collected.\n');
        preferences.enableTelemetry = await this.askYesNo('Enable telemetry?', true);
        if (preferences.enableTelemetry) {
            preferences.shareErrorReports = await this.askYesNo('Share error reports?', true);
            preferences.shareUsageStatistics = await this.askYesNo('Share usage statistics?', false);
        }
        console.log('\n');
        return preferences;
    }
    /**
     * Ask yes/no question
     */
    async askYesNo(question, defaultValue) {
        const defaultStr = defaultValue ? 'Y/n' : 'y/N';
        const answer = await this.askInput(`${question} (${defaultStr}):`, defaultValue ? 'y' : 'n');
        const normalized = answer.toLowerCase().trim();
        if (normalized === '') {
            return defaultValue;
        }
        return normalized === 'y' || normalized === 'yes';
    }
    /**
     * Ask input question
     */
    async askInput(question, defaultValue = '') {
        return new Promise(resolve => {
            this.rl.question(`${question} ${defaultValue ? `[${defaultValue}]` : ''} `, answer => {
                resolve(answer.trim() || defaultValue);
            });
        });
    }
    /**
     * Ask choice question
     */
    async askChoice(question, choices, defaultKey = '1') {
        console.log(question);
        choices.forEach(choice => {
            console.log(`  ${choice.key}. ${choice.label}`);
        });
        const answer = await this.askInput('\nYour choice:', defaultKey);
        const choice = choices.find(c => c.key === answer);
        if (!choice) {
            console.log(`Invalid choice. Using default: ${choices.find(c => c.key === defaultKey)?.label}`);
            return choices.find(c => c.key === defaultKey)?.value;
        }
        return choice.value;
    }
    /**
     * Run minimal wizard (for CI/automated installs)
     */
    async runMinimal() {
        console.log('üöÄ Running automated setup with defaults...');
        const preferences = this.preferenceManager.getDefaultPreferences();
        // Disable interactive features for CI
        preferences.updateBehavior = 'manual';
        preferences.notificationLevel = 'none';
        preferences.enableTelemetry = false;
        await this.preferenceManager.savePreferences(preferences);
        console.log('‚úÖ Automated setup complete');
        return preferences;
    }
    /**
     * Update preferences interactively
     */
    async updatePreferences() {
        console.log('\n‚öôÔ∏è  Update Preferences\n');
        const preferences = await this.preferenceManager.getPreferences();
        console.log('Current preferences:');
        console.log(await this.preferenceManager.getSummary());
        console.log('');
        const category = await this.askChoice('What would you like to change?', [
            { key: '1', label: 'Update settings', value: 'update' },
            { key: '2', label: 'Rollback settings', value: 'rollback' },
            { key: '3', label: 'Notification settings', value: 'notification' },
            { key: '4', label: 'Telemetry settings', value: 'telemetry' },
            { key: '5', label: 'View all settings', value: 'view' },
            { key: '6', label: 'Reset to defaults', value: 'reset' }
        ], '1');
        switch (category) {
            case 'update':
                await this.updateUpdateSettings(preferences);
                break;
            case 'rollback':
                await this.updateRollbackSettings(preferences);
                break;
            case 'notification':
                await this.updateNotificationSettings(preferences);
                break;
            case 'telemetry':
                await this.updateTelemetrySettings(preferences);
                break;
            case 'view':
                console.log(await this.preferenceManager.getSummary());
                break;
            case 'reset':
                const confirm = await this.askYesNo('Reset all preferences to defaults?', false);
                if (confirm) {
                    await this.preferenceManager.resetToDefaults();
                }
                break;
        }
        this.rl.close();
    }
    async updateUpdateSettings(preferences) {
        preferences.updateBehavior = await this.askChoice('Update behavior:', [
            { key: '1', label: 'Auto', value: 'auto' },
            { key: '2', label: 'Notify', value: 'notify' },
            { key: '3', label: 'Manual', value: 'manual' }
        ], preferences.updateBehavior === 'auto' ? '1' : preferences.updateBehavior === 'notify' ? '2' : '3');
        await this.preferenceManager.savePreferences(preferences);
    }
    async updateRollbackSettings(preferences) {
        preferences.rollbackOnFailure = await this.askYesNo('Auto-rollback on failure?', preferences.rollbackOnFailure);
        await this.preferenceManager.savePreferences(preferences);
    }
    async updateNotificationSettings(preferences) {
        preferences.notificationLevel = await this.askChoice('Notification level:', [
            { key: '1', label: 'All', value: 'all' },
            { key: '2', label: 'Important', value: 'important' },
            { key: '3', label: 'Critical', value: 'critical' },
            { key: '4', label: 'None', value: 'none' }
        ], preferences.notificationLevel === 'all'
            ? '1'
            : preferences.notificationLevel === 'important'
                ? '2'
                : preferences.notificationLevel === 'critical'
                    ? '3'
                    : '4');
        await this.preferenceManager.savePreferences(preferences);
    }
    async updateTelemetrySettings(preferences) {
        preferences.enableTelemetry = await this.askYesNo('Enable telemetry?', preferences.enableTelemetry);
        await this.preferenceManager.savePreferences(preferences);
    }
}
exports.ConfigWizard = ConfigWizard;
/**
 * Default config wizard instance (singleton)
 * Lazy-loaded to avoid stdin issues in test environments
 */
let _defaultConfigWizard = null;
function getDefaultConfigWizard() {
    if (!_defaultConfigWizard) {
        _defaultConfigWizard = new ConfigWizard();
    }
    return _defaultConfigWizard;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL25pc3NpbW1lbmFzaGUvVkVSU0FUSUwgU0RMQyBGVy9zcmMvY29uZmlnL2NvbmZpZy13aXphcmQudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdVpILHdEQUtDO0FBMVpELG1EQUFxQztBQUNyQyxtRUFBNkU7QUFDN0UsNkRBQTREO0FBRTVELE1BQWEsWUFBWTtJQUt2QjtRQUNFLElBQUksQ0FBQyxFQUFFLEdBQUcsUUFBUSxDQUFDLGVBQWUsQ0FBQztZQUNqQyxLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUs7WUFDcEIsTUFBTSxFQUFFLE9BQU8sQ0FBQyxNQUFNO1NBQ3ZCLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLHlDQUFpQixFQUFFLENBQUM7UUFDakQsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLHlDQUFvQixFQUFFLENBQUM7SUFDbkQsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLEdBQUc7UUFDUCxPQUFPLENBQUMsR0FBRyxDQUFDLGlFQUFpRSxDQUFDLENBQUM7UUFDL0UsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0REFBNEQsQ0FBQyxDQUFDO1FBQzFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUVBQWlFLENBQUMsQ0FBQztRQUUvRSxPQUFPLENBQUMsR0FBRyxDQUFDLHlEQUF5RCxDQUFDLENBQUM7UUFDdkUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnRUFBZ0UsQ0FBQyxDQUFDO1FBRTlFLDBDQUEwQztRQUMxQyxNQUFNLFNBQVMsR0FBRyxNQUFNLElBQUksQ0FBQyxTQUFTLENBQ3BDLG9CQUFvQixFQUNwQjtZQUNFLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsd0NBQXdDLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRTtZQUM3RSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLHdDQUF3QyxFQUFFLEtBQUssRUFBRSxRQUFRLEVB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QWUsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUM1RCxDQUFDO0lBRU8sS0FBSyxDQUFDLHVCQUF1QixDQUFDLFdBQTRCO1FBQ2hFLFdBQVcsQ0FBQyxlQUFlLEdBQUcsTUFBTSxJQUFJLENBQUMsUUFBUSxDQUFDLG1CQUFtQixFQUFFLFdBQVcsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUVwRyxNQUFNLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDNUQsQ0FBQztDQUNGO0FBMVlELG9DQTBZQztBQUVEOzs7R0FHRztBQUNILElBQUksb0JBQW9CLEdBQXdCLElBQUksQ0FBQztBQUNyRCxTQUFnQixzQkFBc0I7SUFDcEMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7UUFDMUIsb0JBQW9CLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztJQUM1QyxDQUFDO0lBQ0QsT0FBTyxvQkFBb0IsQ0FBQztBQUM5QixDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9uaXNzaW1tZW5hc2hlL1ZFUlNBVElMIFNETEMgRlcvc3JjL2NvbmZpZy9jb25maWctd2l6YXJkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVkVSU0FUSUwgU0RMQyBGcmFtZXdvcmsgLSBDb25maWd1cmF0aW9uIFdpemFyZFxuICogSW50ZXJhY3RpdmUgc2V0dXAgd2l6YXJkIGZvciBmaXJzdC10aW1lIHVzZXJzXG4gKi9cblxuaW1wb3J0ICogYXMgcmVhZGxpbmUgZnJvbSAncmVhZGxpbmUnO1xuaW1wb3J0IHsgUHJlZmVyZW5jZU1hbmFnZXIsIFVzZXJQcmVmZXJlbmNlcyB9IGZyb20gJy4vcHJlZmVyZW5jZS1tYW5hZ2VyLmpzJztcbmltcG9ydCB7IENvbmZpZ1Byb2ZpbGVNYW5hZ2VyIH0gZnJvbSAnLi9jb25maWctcHJvZmlsZXMuanMnO1xuXG5leHBvcnQgY2xhc3MgQ29uZmlnV2l6YXJkIHtcbiAgcHJpdmF0ZSBybDogcmVhZGxpbmUuSW50ZXJmYWNlO1xuICBwcml2YXRlIHByZWZlcmVuY2VNYW5hZ2VyOiBQcmVmZXJlbmNlTWFuYWdlcjtcbiAgcHJpdmF0ZSBwcm9maWxlTWFuYWdlcjogQ29uZmlnUHJvZmlsZU1hbmFnZXI7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5ybCA9IHJlYWRsaW5lLmNyZWF0ZUludGVyZmFjZSh7XG4gICAgICBpbnB1dDogcHJvY2Vzcy5zdGRpbixcbiAgICAgIG91dHB1dDogcHJvY2Vzcy5zdGRvdXRcbiAgICB9KTtcbiAgICB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyID0gbmV3IFByZWZlcmVuY2VNYW5hZ2VyKCk7XG4gICAgdGhpcy5wcm9maWxlTWFuYWdlciA9IG5ldyBDb25maWdQcm9maWxlTWFuYWdlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJ1biB0aGUgc2V0dXAgd2l6YXJkXG4gICAqL1xuICBhc3luYyBydW4oKTogUHJvbWlzZTxVc2VyUHJlZmVyZW5jZXM+IHtcbiAgICBjb25zb2xlLmxvZygnXFxu4pWU4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWXJyk7XG4gICAgY29uc29sZS5sb2coJ+KVkSAgIPCfmoAgVkVSU0FUSUwgU0RMQyBGcmFtZXdvcmsgLSBGaXJzdC1UaW1lIFNldHVwICAg8J+agCAgIOKVkScpO1xuICAgIGNvbnNvbGUubG9nKCfilZrilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZ1cXG4nKTtcblxuICAgIGNvbnNvbGUubG9nKCdXZWxjb21lISBMZXRcXCdzIGNvbmZpZ3VyZSB5b3VyIGZyYW1ld29yayBwcmVmZXJlbmNlcy5cXG4nKTtcbiAgICBjb25zb2xlLmxvZygnWW91IGNhbiBjaGFuZ2UgdGhlc2Ugc2V0dGluZ3MgYW55dGltZSB1c2luZzogdmVyc2F0aWwgY29uZmlnXFxuJyk7XG5cbiAgICAvLyBBc2sgaWYgdXNlciB3YW50cyBxdWljayBzZXR1cCBvciBjdXN0b21cbiAgICBjb25zdCBzZXR1cFR5cGUgPSBhd2FpdCB0aGlzLmFza0Nob2ljZShcbiAgICAgICdDaG9vc2Ugc2V0dXAgdHlwZTonLFxuICAgICAgW1xuICAgICAgICB7IGtleTogJzEnLCBsYWJlbDogJ1F1aWNrIFNldHVwICh1c2UgcmVjb21tZW5kZWQgZGVmYXVsdHMpJywgdmFsdWU6ICdxdWljaycgfSxcbiAgICAgICAgeyBrZXk6ICcyJywgbGFiZWw6ICdDdXN0b20gU2V0dXAgKGNob29zZSB5b3VyIHByZWZlcmVuY2VzKScsIHZhbHVlOiAnY3VzdG9tJyB9LFxuICAgICAgICB7IGtleTogJzMnLCBsYWJlbDogJ1VzZSBQcm9maWxlIChjb25zZXJ2YXRpdmUvYmFsYW5jZWQvYWdncmVzc2l2ZSknLCB2YWx1ZTogJ3Byb2ZpbGUnIH1cbiAgICAgIF0sXG4gICAgICAnMSdcbiAgICApO1xuXG4gICAgbGV0IHByZWZlcmVuY2VzOiBVc2VyUHJlZmVyZW5jZXM7XG5cbiAgICBpZiAoc2V0dXBUeXBlID09PSAncXVpY2snKSB7XG4gICAgICBwcmVmZXJlbmNlcyA9IGF3YWl0IHRoaXMucXVpY2tTZXR1cCgpO1xuICAgIH0gZWxzZSBpZiAoc2V0dXBUeXBlID09PSAncHJvZmlsZScpIHtcbiAgICAgIHByZWZlcmVuY2VzID0gYXdhaXQgdGhpcy5wcm9maWxlU2V0dXAoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcHJlZmVyZW5jZXMgPSBhd2FpdCB0aGlzLmN1c3RvbVNldHVwKCk7XG4gICAgfVxuXG4gICAgLy8gU2F2ZSBwcmVmZXJlbmNlc1xuICAgIGF3YWl0IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIuc2F2ZVByZWZlcmVuY2VzKHByZWZlcmVuY2VzKTtcblxuICAgIGNvbnNvbGUubG9nKCdcXG7inIUgU2V0dXAgY29tcGxldGUhIFlvdXIgcHJlZmVyZW5jZXMgaGF2ZSBiZWVuIHNhdmVkLlxcbicpO1xuICAgIGNvbnNvbGUubG9nKCdUbyB2aWV3IHlvdXIgcHJlZmVyZW5jZXM6IHZlcnNhdGlsIGNvbmZpZyBzaG93Jyk7XG4gICAgY29uc29sZS5sb2coJ1RvIG1vZGlmeSBwcmVmZXJlbmNlczogdmVyc2F0aWwgY29uZmlnIHNldCA8a2V5PiA8dmFsdWU+XFxuJyk7XG5cbiAgICB0aGlzLnJsLmNsb3NlKCk7XG5cbiAgICByZXR1cm4gcHJlZmVyZW5jZXM7XG4gIH1cblxuICAvKipcbiAgICogUXVpY2sgc2V0dXAgd2l0aCByZWNvbW1lbmRlZCBkZWZhdWx0c1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBxdWlja1NldHVwKCk6IFByb21pc2U8VXNlclByZWZlcmVuY2VzPiB7XG4gICAgY29uc29sZS5sb2coJ1xcbvCfk6YgUXVpY2sgU2V0dXAgLSBVc2luZyBSZWNvbW1lbmRlZCBEZWZhdWx0c1xcbicpO1xuXG4gICAgY29uc3QgcHJlZmVyZW5jZXMgPSB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLmdldERlZmF1bHRQcmVmZXJlbmNlcygpO1xuXG4gICAgY29uc29sZS5sb2coJ1lvdXIgY29uZmlndXJhdGlvbjonKTtcbiAgICBjb25zb2xlLmxvZygnICDigKIgVXBkYXRlIEJlaGF2aW9yOiBOb3RpZnkgKHlvdSBhcHByb3ZlIHVwZGF0ZXMpJyk7XG4gICAgY29uc29sZS5sb2coJyAg4oCiIFVwZGF0ZSBDaGFubmVsOiBTdGFibGUgKHByb2R1Y3Rpb24tcmVhZHkgb25seSknKTtcbiAgICBjb25zb2xlLmxvZygnICDigKIgU2FmZXR5IExldmVsOiBCYWxhbmNlZCAoZ29vZCBiYWxhbmNlIG9mIHNhZmV0eSBhbmQgc3BlZWQpJyk7XG4gICAgY29uc29sZS5sb2coJyAg4oCiIEF1dG8taW5zdGFsbCBTZWN1cml0eSBVcGRhdGVzOiBZZXMnKTtcbiAgICBjb25zb2xlLmxvZygnICDigKIgQmFja3VwIEJlZm9yZSBVcGRhdGU6IFllcycpO1xuICAgIGNvbnNvbGUubG9nKCcgIOKAoiBBdXRvLXJvbGxiYWNrIG9uIEZhaWx1cmU6IFllcycpO1xuICAgIGNvbnNvbGUubG9nKCcgIOKAoiBUZWxlbWV0cnk6IFllcyAoaGVscHMgaW1wcm92ZSB0aGUgZnJhbWV3b3JrKScpO1xuXG4gICAgY29uc3QgY29uZmlybSA9IGF3YWl0IHRoaXMuYXNrWWVzTm8oJ1xcbkNvbnRpbnVlIHdpdGggdGhlc2Ugc2V0dGluZ3M/JywgdHJ1ZSk7XG5cbiAgICBpZiAoIWNvbmZpcm0pIHtcbiAgICAgIGNvbnNvbGUubG9nKCdcXG5MZXRcXCdzIHRyeSBjdXN0b20gc2V0dXAgaW5zdGVhZC4uLlxcbicpO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY3VzdG9tU2V0dXAoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJlZmVyZW5jZXM7XG4gIH1cblxuICAvKipcbiAgICogUHJvZmlsZS1iYXNlZCBzZXR1cFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwcm9maWxlU2V0dXAoKTogUHJvbWlzZTxVc2VyUHJlZmVyZW5jZXM+IHtcbiAgICBjb25zb2xlLmxvZygnXFxu8J+TiyBQcm9maWxlLUJhc2VkIFNldHVwXFxuJyk7XG5cbiAgICBjb25zdCBwcm9maWxlcyA9IHRoaXMucHJvZmlsZU1hbmFnZXIuZ2V0QXZhaWxhYmxlUHJvZmlsZXMoKTtcblxuICAgIGNvbnNvbGUubG9nKCdBdmFpbGFibGUgcHJvZmlsZXM6XFxuJyk7XG4gICAgcHJvZmlsZXMuZm9yRWFjaChwcm9maWxlID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGAke3Byb2ZpbGUuZW1vaml9ICR7cHJvZmlsZS5uYW1lfTpgKTtcbiAgICAgIGNvbnNvbGUubG9nKGAgICAke3Byb2ZpbGUuZGVzY3JpcHRpb259YCk7XG4gICAgICBjb25zb2xlLmxvZyhgICAgQmVzdCBmb3I6ICR7cHJvZmlsZS5iZXN0Rm9yfWApO1xuICAgICAgY29uc29sZS5sb2coJycpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcHJvZmlsZUNob2ljZSA9IGF3YWl0IHRoaXMuYXNrQ2hvaWNlKFxuICAgICAgJ0Nob29zZSBhIHByb2ZpbGU6JyxcbiAgICAgIFtcbiAgICAgICAgeyBrZXk6ICcxJywgbGFiZWw6ICdDb25zZXJ2YXRpdmUgKG1heGltdW0gc2FmZXR5KScsIHZhbHVlOiAnY29uc2VydmF0aXZlJyB9LFxuICAgICAgICB7IGtleTogJzInLCBsYWJlbDogJ0JhbGFuY2VkIChyZWNvbW1lbmRlZCknLCB2YWx1ZTogJ2JhbGFuY2VkJyB9LFxuICAgICAgICB7IGtleTogJzMnLCBsYWJlbDogJ0FnZ3Jlc3NpdmUgKGxhdGVzdCBmZWF0dXJlcyknLCB2YWx1ZTogJ2FnZ3Jlc3NpdmUnIH1cbiAgICAgIF0sXG4gICAgICAnMidcbiAgICApO1xuXG4gICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZU1hbmFnZXIuZ2V0UHJvZmlsZShwcm9maWxlQ2hvaWNlIGFzIGFueSk7XG5cbiAgICBpZiAoIXByb2ZpbGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwcm9maWxlJyk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFxcbuKchSBVc2luZyAke3Byb2ZpbGUubmFtZX0gcHJvZmlsZVxcbmApO1xuXG4gICAgcmV0dXJuIHByb2ZpbGUucHJlZmVyZW5jZXM7XG4gIH1cblxuICAvKipcbiAgICogQ3VzdG9tIHNldHVwIHdpdGggdXNlciBjaG9pY2VzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGN1c3RvbVNldHVwKCk6IFByb21pc2U8VXNlclByZWZlcmVuY2VzPiB7XG4gICAgY29uc29sZS5sb2coJ1xcbuKame+4jyAgQ3VzdG9tIFNldHVwXFxuJyk7XG5cbiAgICBjb25zdCBwcmVmZXJlbmNlcyA9IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIuZ2V0RGVmYXVsdFByZWZlcmVuY2VzKCk7XG5cbiAgICAvLyBVcGRhdGUgYmVoYXZpb3JcbiAgICBjb25zb2xlLmxvZygn4pWQ4pWQ4pWQIFVwZGF0ZSBCZWhhdmlvciDilZDilZDilZBcXG4nKTtcbiAgICBwcmVmZXJlbmNlcy51cGRhdGVCZWhhdmlvciA9IGF3YWl0IHRoaXMuYXNrQ2hvaWNlKFxuICAgICAgJ0hvdyBzaG91bGQgdXBkYXRlcyBiZSBoYW5kbGVkPycsXG4gICAgICBbXG4gICAgICAgIHsga2V5OiAnMScsIGxhYmVsOiAnQXV0byAtIEluc3RhbGwgdXBkYXRlcyBhdXRvbWF0aWNhbGx5JywgdmFsdWU6ICdhdXRvJyB9LFxuICAgICAgICB7IGtleTogJzInLCBsYWJlbDogJ05vdGlmeSAtIE5vdGlmeSBtZSwgSSBhcHByb3ZlIChyZWNvbW1lbmRlZCknLCB2YWx1ZTogJ25vdGlmeScgfSxcbiAgICAgICAgeyBrZXk6ICczJywgbGFiZWw6ICdNYW51YWwgLSBJIGNoZWNrIGZvciB1cGRhdGVzIG1hbnVhbGx5JywgdmFsdWU6ICdtYW51YWwnIH1cbiAgICAgIF0sXG4gICAgICAnMidcbiAgICApO1xuXG4gICAgLy8gVXBkYXRlIGNoYW5uZWxcbiAgICBjb25zb2xlLmxvZygnXFxu4pWQ4pWQ4pWQIFVwZGF0ZSBDaGFubmVsIOKVkOKVkOKVkFxcbicpO1xuICAgIHByZWZlcmVuY2VzLnVwZGF0ZUNoYW5uZWwgPSBhd2FpdCB0aGlzLmFza0Nob2ljZShcbiAgICAgICdXaGljaCB1cGRhdGUgY2hhbm5lbD8nLFxuICAgICAgW1xuICAgICAgICB7IGtleTogJzEnLCBsYWJlbDogJ1N0YWJsZSAtIFByb2R1Y3Rpb24tcmVhZHkgcmVsZWFzZXMgb25seSAocmVjb21tZW5kZWQpJywgdmFsdWU6ICdzdGFibGUnIH0sXG4gICAgICAgIHsga2V5OiAnMicsIGxhYmVsOiAnQmV0YSAtIEVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMnLCB2YWx1ZTogJ2JldGEnIH0sXG4gICAgICAgIHsga2V5OiAnMycsIGxhYmVsOiAnQWxwaGEgLSBCbGVlZGluZyBlZGdlIChtYXkgYmUgdW5zdGFibGUpJywgdmFsdWU6ICdhbHBoYScgfVxuICAgICAgXSxcbiAgICAgICcxJ1xuICAgICk7XG5cbiAgICAvLyBTYWZldHkgbGV2ZWxcbiAgICBjb25zb2xlLmxvZygnXFxu4pWQ4pWQ4pWQIFNhZmV0eSBMZXZlbCDilZDilZDilZBcXG4nKTtcbiAgICBwcmVmZXJlbmNlcy5zYWZldHlMZXZlbCA9IGF3YWl0IHRoaXMuYXNrQ2hvaWNlKFxuICAgICAgJ0Nob29zZSBzYWZldHkgbGV2ZWw6JyxcbiAgICAgIFtcbiAgICAgICAgeyBrZXk6ICcxJywgbGFiZWw6ICdDb25zZXJ2YXRpdmUgLSBNYXhpbXVtIHNhZmV0eSwgc2xvd2VyIHVwZGF0ZXMnLCB2YWx1ZTogJ2NvbnNlcnZhdGl2ZScgfSxcbiAgICAgICAgeyBrZXk6ICcyJywgbGFiZWw6ICdCYWxhbmNlZCAtIEdvb2QgYmFsYW5jZSAocmVjb21tZW5kZWQpJywgdmFsdWU6ICdiYWxhbmNlZCcgfSxcbiAgICAgICAgeyBrZXk6ICczJywgbGFiZWw6ICdGYXN0IC0gRmFzdGVyIHVwZGF0ZXMsIGxlc3MgdmFsaWRhdGlvbicsIHZhbHVlOiAnZmFzdCcgfVxuICAgICAgXSxcbiAgICAgICcyJ1xuICAgICk7XG5cbiAgICAvLyBTZWN1cml0eSB1cGRhdGVzXG4gICAgY29uc29sZS5sb2coJ1xcbuKVkOKVkOKVkCBTZWN1cml0eSBVcGRhdGVzIOKVkOKVkOKVkFxcbicpO1xuICAgIHByZWZlcmVuY2VzLmF1dG9JbnN0YWxsU2VjdXJpdHkgPSBhd2FpdCB0aGlzLmFza1llc05vKFxuICAgICAgJ0F1dG8taW5zdGFsbCBzZWN1cml0eSB1cGRhdGVzPyAocmVjb21tZW5kZWQ6IHllcyknLFxuICAgICAgdHJ1ZVxuICAgICk7XG5cbiAgICAvLyBCYWNrdXBcbiAgICBjb25zb2xlLmxvZygnXFxu4pWQ4pWQ4pWQIEJhY2t1cCDilZDilZDilZBcXG4nKTtcbiAgICBwcmVmZXJlbmNlcy5iYWNrdXBCZWZvcmVVcGRhdGUgPSBhd2FpdCB0aGlzLmFza1llc05vKCdDcmVhdGUgYmFja3VwIGJlZm9yZSBlYWNoIHVwZGF0ZT8gKHJlY29tbWVuZGVkOiB5ZXMpJywgdHJ1ZSk7XG5cbiAgICBpZiAocHJlZmVyZW5jZXMuYmFja3VwQmVmb3JlVXBkYXRlKSB7XG4gICAgICBjb25zdCBtYXhCYWNrdXBzU3RyID0gYXdhaXQgdGhpcy5hc2tJbnB1dChcbiAgICAgICAgJ01heGltdW0gbnVtYmVyIG9mIGJhY2t1cHMgdG8ga2VlcDonLFxuICAgICAgICAnNSdcbiAgICAgICk7XG4gICAgICBwcmVmZXJlbmNlcy5tYXhSb2xsYmFja1BvaW50cyA9IHBhcnNlSW50KG1heEJhY2t1cHNTdHIsIDEwKSB8fCA1O1xuICAgIH1cblxuICAgIC8vIFJvbGxiYWNrXG4gICAgY29uc29sZS5sb2coJ1xcbuKVkOKVkOKVkCBSb2xsYmFjayDilZDilZDilZBcXG4nKTtcbiAgICBwcmVmZXJlbmNlcy5yb2xsYmFja09uRmFpbHVyZSA9IGF3YWl0IHRoaXMuYXNrWWVzTm8oXG4gICAgICAnQXV0by1yb2xsYmFjayBpZiB1cGRhdGUgZmFpbHM/IChyZWNvbW1lbmRlZDogeWVzKScsXG4gICAgICB0cnVlXG4gICAgKTtcblxuICAgIC8vIE5vdGlmaWNhdGlvbnNcbiAgICBjb25zb2xlLmxvZygnXFxu4pWQ4pWQ4pWQIE5vdGlmaWNhdGlvbnMg4pWQ4pWQ4pWQXFxuJyk7XG4gICAgcHJlZmVyZW5jZXMubm90aWZpY2F0aW9uTGV2ZWwgPSBhd2FpdCB0aGlzLmFza0Nob2ljZShcbiAgICAgICdOb3RpZmljYXRpb24gbGV2ZWw6JyxcbiAgICAgIFtcbiAgICAgICAgeyBrZXk6ICcxJywgbGFiZWw6ICdBbGwgLSBTaG93IGFsbCBub3RpZmljYXRpb25zJywgdmFsdWU6ICdhbGwnIH0sXG4gICAgICAgIHsga2V5OiAnMicsIGxhYmVsOiAnSW1wb3J0YW50IC0gSW1wb3J0YW50IHVwZGF0ZXMgb25seSAocmVjb21tZW5kZWQpJywgdmFsdWU6ICdpbXBvcnRhbnQnIH0sXG4gICAgICAgIHsga2V5OiAnMycsIGxhYmVsOiAnQ3JpdGljYWwgLSBDcml0aWNhbCB1cGRhdGVzIG9ubHknLCB2YWx1ZTogJ2NyaXRpY2FsJyB9LFxuICAgICAgICB7IGtleTogJzQnLCBsYWJlbDogJ05vbmUgLSBObyBub3RpZmljYXRpb25zJywgdmFsdWU6ICdub25lJyB9XG4gICAgICBdLFxuICAgICAgJzInXG4gICAgKTtcblxuICAgIC8vIFRlbGVtZXRyeVxuICAgIGNvbnNvbGUubG9nKCdcXG7ilZDilZDilZAgVGVsZW1ldHJ5IOKVkOKVkOKVkFxcbicpO1xuICAgIGNvbnNvbGUubG9nKCdUZWxlbWV0cnkgaGVscHMgdXMgaW1wcm92ZSB0aGUgZnJhbWV3b3JrIGJ5IGNvbGxlY3RpbmcgYW5vbnltb3VzIHVzYWdlIGRhdGEuJyk7XG4gICAgY29uc29sZS5sb2coJ05vIHBlcnNvbmFsIGluZm9ybWF0aW9uIGlzIGNvbGxlY3RlZC5cXG4nKTtcbiAgICBwcmVmZXJlbmNlcy5lbmFibGVUZWxlbWV0cnkgPSBhd2FpdCB0aGlzLmFza1llc05vKCdFbmFibGUgdGVsZW1ldHJ5PycsIHRydWUpO1xuXG4gICAgaWYgKHByZWZlcmVuY2VzLmVuYWJsZVRlbGVtZXRyeSkge1xuICAgICAgcHJlZmVyZW5jZXMuc2hhcmVFcnJvclJlcG9ydHMgPSBhd2FpdCB0aGlzLmFza1llc05vKCdTaGFyZSBlcnJvciByZXBvcnRzPycsIHRydWUpO1xuICAgICAgcHJlZmVyZW5jZXMuc2hhcmVVc2FnZVN0YXRpc3RpY3MgPSBhd2FpdCB0aGlzLmFza1llc05vKCdTaGFyZSB1c2FnZSBzdGF0aXN0aWNzPycsIGZhbHNlKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnXFxuJyk7XG5cbiAgICByZXR1cm4gcHJlZmVyZW5jZXM7XG4gIH1cblxuICAvKipcbiAgICogQXNrIHllcy9ubyBxdWVzdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhc2tZZXNObyhxdWVzdGlvbjogc3RyaW5nLCBkZWZhdWx0VmFsdWU6IGJvb2xlYW4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBkZWZhdWx0U3RyID0gZGVmYXVsdFZhbHVlID8gJ1kvbicgOiAneS9OJztcbiAgICBjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzLmFza0lucHV0KGAke3F1ZXN0aW9ufSAoJHtkZWZhdWx0U3RyfSk6YCwgZGVmYXVsdFZhbHVlID8gJ3knIDogJ24nKTtcblxuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBhbnN3ZXIudG9Mb3dlckNhc2UoKS50cmltKCk7XG5cbiAgICBpZiAobm9ybWFsaXplZCA9PT0gJycpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vcm1hbGl6ZWQgPT09ICd5JyB8fCBub3JtYWxpemVkID09PSAneWVzJztcbiAgfVxuXG4gIC8qKlxuICAgKiBBc2sgaW5wdXQgcXVlc3Rpb25cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgYXNrSW5wdXQocXVlc3Rpb246IHN0cmluZywgZGVmYXVsdFZhbHVlOiBzdHJpbmcgPSAnJyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgdGhpcy5ybC5xdWVzdGlvbihgJHtxdWVzdGlvbn0gJHtkZWZhdWx0VmFsdWUgPyBgWyR7ZGVmYXVsdFZhbHVlfV1gIDogJyd9IGAsIGFuc3dlciA9PiB7XG4gICAgICAgIHJlc29sdmUoYW5zd2VyLnRyaW0oKSB8fCBkZWZhdWx0VmFsdWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQXNrIGNob2ljZSBxdWVzdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhc2tDaG9pY2UoXG4gICAgcXVlc3Rpb246IHN0cmluZyxcbiAgICBjaG9pY2VzOiBBcnJheTx7IGtleTogc3RyaW5nOyBsYWJlbDogc3RyaW5nOyB2YWx1ZTogc3RyaW5nIH0+LFxuICAgIGRlZmF1bHRLZXk6IHN0cmluZyA9ICcxJ1xuICApOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnNvbGUubG9nKHF1ZXN0aW9uKTtcbiAgICBjaG9pY2VzLmZvckVhY2goY2hvaWNlID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGAgICR7Y2hvaWNlLmtleX0uICR7Y2hvaWNlLmxhYmVsfWApO1xuICAgIH0pO1xuXG4gICAgY29uc3QgYW5zd2VyID0gYXdhaXQgdGhpcy5hc2tJbnB1dCgnXFxuWW91ciBjaG9pY2U6JywgZGVmYXVsdEtleSk7XG5cbiAgICBjb25zdCBjaG9pY2UgPSBjaG9pY2VzLmZpbmQoYyA9PiBjLmtleSA9PT0gYW5zd2VyKTtcblxuICAgIGlmICghY2hvaWNlKSB7XG4gICAgICBjb25zb2xlLmxvZyhgSW52YWxpZCBjaG9pY2UuIFVzaW5nIGRlZmF1bHQ6ICR7Y2hvaWNlcy5maW5kKGMgPT4gYy5rZXkgPT09IGRlZmF1bHRLZXkpPy5sYWJlbH1gKTtcbiAgICAgIHJldHVybiBjaG9pY2VzLmZpbmQoYyA9PiBjLmtleSA9PT0gZGVmYXVsdEtleSk/LnZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiBjaG9pY2UudmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogUnVuIG1pbmltYWwgd2l6YXJkIChmb3IgQ0kvYXV0b21hdGVkIGluc3RhbGxzKVxuICAgKi9cbiAgYXN5bmMgcnVuTWluaW1hbCgpOiBQcm9taXNlPFVzZXJQcmVmZXJlbmNlcz4ge1xuICAgIGNvbnNvbGUubG9nKCfwn5qAIFJ1bm5pbmcgYXV0b21hdGVkIHNldHVwIHdpdGggZGVmYXVsdHMuLi4nKTtcblxuICAgIGNvbnN0IHByZWZlcmVuY2VzID0gdGhpcy5wcmVmZXJlbmNlTWFuYWdlci5nZXREZWZhdWx0UHJlZmVyZW5jZXMoKTtcblxuICAgIC8vIERpc2FibGUgaW50ZXJhY3RpdmUgZmVhdHVyZXMgZm9yIENJXG4gICAgcHJlZmVyZW5jZXMudXBkYXRlQmVoYXZpb3IgPSAnbWFudWFsJztcbiAgICBwcmVmZXJlbmNlcy5ub3RpZmljYXRpb25MZXZlbCA9ICdub25lJztcbiAgICBwcmVmZXJlbmNlcy5lbmFibGVUZWxlbWV0cnkgPSBmYWxzZTtcblxuICAgIGF3YWl0IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIuc2F2ZVByZWZlcmVuY2VzKHByZWZlcmVuY2VzKTtcblxuICAgIGNvbnNvbGUubG9nKCfinIUgQXV0b21hdGVkIHNldHVwIGNvbXBsZXRlJyk7XG5cbiAgICByZXR1cm4gcHJlZmVyZW5jZXM7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHByZWZlcmVuY2VzIGludGVyYWN0aXZlbHlcbiAgICovXG4gIGFzeW5jIHVwZGF0ZVByZWZlcmVuY2VzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnNvbGUubG9nKCdcXG7impnvuI8gIFVwZGF0ZSBQcmVmZXJlbmNlc1xcbicpO1xuXG4gICAgY29uc3QgcHJlZmVyZW5jZXMgPSBhd2FpdCB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLmdldFByZWZlcmVuY2VzKCk7XG5cbiAgICBjb25zb2xlLmxvZygnQ3VycmVudCBwcmVmZXJlbmNlczonKTtcbiAgICBjb25zb2xlLmxvZyhhd2FpdCB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLmdldFN1bW1hcnkoKSk7XG4gICAgY29uc29sZS5sb2coJycpO1xuXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCB0aGlzLmFza0Nob2ljZShcbiAgICAgICdXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGNoYW5nZT8nLFxuICAgICAgW1xuICAgICAgICB7IGtleTogJzEnLCBsYWJlbDogJ1VwZGF0ZSBzZXR0aW5ncycsIHZhbHVlOiAndXBkYXRlJyB9LFxuICAgICAgICB7IGtleTogJzInLCBsYWJlbDogJ1JvbGxiYWNrIHNldHRpbmdzJywgdmFsdWU6ICdyb2xsYmFjaycgfSxcbiAgICAgICAgeyBrZXk6ICczJywgbGFiZWw6ICdOb3RpZmljYXRpb24gc2V0dGluZ3MnLCB2YWx1ZTogJ25vdGlmaWNhdGlvbicgfSxcbiAgICAgICAgeyBrZXk6ICc0JywgbGFiZWw6ICdUZWxlbWV0cnkgc2V0dGluZ3MnLCB2YWx1ZTogJ3RlbGVtZXRyeScgfSxcbiAgICAgICAgeyBrZXk6ICc1JywgbGFiZWw6ICdWaWV3IGFsbCBzZXR0aW5ncycsIHZhbHVlOiAndmlldycgfSxcbiAgICAgICAgeyBrZXk6ICc2JywgbGFiZWw6ICdSZXNldCB0byBkZWZhdWx0cycsIHZhbHVlOiAncmVzZXQnIH1cbiAgICAgIF0sXG4gICAgICAnMSdcbiAgICApO1xuXG4gICAgc3dpdGNoIChjYXRlZ29yeSkge1xuICAgICAgY2FzZSAndXBkYXRlJzpcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVVcGRhdGVTZXR0aW5ncyhwcmVmZXJlbmNlcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncm9sbGJhY2snOlxuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVJvbGxiYWNrU2V0dGluZ3MocHJlZmVyZW5jZXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ25vdGlmaWNhdGlvbic6XG4gICAgICAgIGF3YWl0IHRoaXMudXBkYXRlTm90aWZpY2F0aW9uU2V0dGluZ3MocHJlZmVyZW5jZXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RlbGVtZXRyeSc6XG4gICAgICAgIGF3YWl0IHRoaXMudXBkYXRlVGVsZW1ldHJ5U2V0dGluZ3MocHJlZmVyZW5jZXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3ZpZXcnOlxuICAgICAgICBjb25zb2xlLmxvZyhhd2FpdCB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLmdldFN1bW1hcnkoKSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncmVzZXQnOlxuICAgICAgICBjb25zdCBjb25maXJtID0gYXdhaXQgdGhpcy5hc2tZZXNObygnUmVzZXQgYWxsIHByZWZlcmVuY2VzIHRvIGRlZmF1bHRzPycsIGZhbHNlKTtcbiAgICAgICAgaWYgKGNvbmZpcm0pIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLnJlc2V0VG9EZWZhdWx0cygpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHRoaXMucmwuY2xvc2UoKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlVXBkYXRlU2V0dGluZ3MocHJlZmVyZW5jZXM6IFVzZXJQcmVmZXJlbmNlcyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHByZWZlcmVuY2VzLnVwZGF0ZUJlaGF2aW9yID0gYXdhaXQgdGhpcy5hc2tDaG9pY2UoXG4gICAgICAnVXBkYXRlIGJlaGF2aW9yOicsXG4gICAgICBbXG4gICAgICAgIHsga2V5OiAnMScsIGxhYmVsOiAnQXV0bycsIHZhbHVlOiAnYXV0bycgfSxcbiAgICAgICAgeyBrZXk6ICcyJywgbGFiZWw6ICdOb3RpZnknLCB2YWx1ZTogJ25vdGlmeScgfSxcbiAgICAgICAgeyBrZXk6ICczJywgbGFiZWw6ICdNYW51YWwnLCB2YWx1ZTogJ21hbnVhbCcgfVxuICAgICAgXSxcbiAgICAgIHByZWZlcmVuY2VzLnVwZGF0ZUJlaGF2aW9yID09PSAnYXV0bycgPyAnMScgOiBwcmVmZXJlbmNlcy51cGRhdGVCZWhhdmlvciA9PT0gJ25vdGlmeScgPyAnMicgOiAnMydcbiAgICApO1xuXG4gICAgYXdhaXQgdGhpcy5wcmVmZXJlbmNlTWFuYWdlci5zYXZlUHJlZmVyZW5jZXMocHJlZmVyZW5jZXMpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVSb2xsYmFja1NldHRpbmdzKHByZWZlcmVuY2VzOiBVc2VyUHJlZmVyZW5jZXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBwcmVmZXJlbmNlcy5yb2xsYmFja09uRmFpbHVyZSA9IGF3YWl0IHRoaXMuYXNrWWVzTm8oXG4gICAgICAnQXV0by1yb2xsYmFjayBvbiBmYWlsdXJlPycsXG4gICAgICBwcmVmZXJlbmNlcy5yb2xsYmFja09uRmFpbHVyZVxuICAgICk7XG5cbiAgICBhd2FpdCB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLnNhdmVQcmVmZXJlbmNlcyhwcmVmZXJlbmNlcyk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHVwZGF0ZU5vdGlmaWNhdGlvblNldHRpbmdzKHByZWZlcmVuY2VzOiBVc2VyUHJlZmVyZW5jZXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBwcmVmZXJlbmNlcy5ub3RpZmljYXRpb25MZXZlbCA9IGF3YWl0IHRoaXMuYXNrQ2hvaWNlKFxuICAgICAgJ05vdGlmaWNhdGlvbiBsZXZlbDonLFxuICAgICAgW1xuICAgICAgICB7IGtleTogJzEnLCBsYWJlbDogJ0FsbCcsIHZhbHVlOiAnYWxsJyB9LFxuICAgICAgICB7IGtleTogJzInLCBsYWJlbDogJ0ltcG9ydGFudCcsIHZhbHVlOiAnaW1wb3J0YW50JyB9LFxuICAgICAgICB7IGtleTogJzMnLCBsYWJlbDogJ0NyaXRpY2FsJywgdmFsdWU6ICdjcml0aWNhbCcgfSxcbiAgICAgICAgeyBrZXk6ICc0JywgbGFiZWw6ICdOb25lJywgdmFsdWU6ICdub25lJyB9XG4gICAgICBdLFxuICAgICAgcHJlZmVyZW5jZXMubm90aWZpY2F0aW9uTGV2ZWwgPT09ICdhbGwnXG4gICAgICAgID8gJzEnXG4gICAgICAgIDogcHJlZmVyZW5jZXMubm90aWZpY2F0aW9uTGV2ZWwgPT09ICdpbXBvcnRhbnQnXG4gICAgICAgICAgPyAnMidcbiAgICAgICAgICA6IHByZWZlcmVuY2VzLm5vdGlmaWNhdGlvbkxldmVsID09PSAnY3JpdGljYWwnXG4gICAgICAgICAgICA/ICczJ1xuICAgICAgICAgICAgOiAnNCdcbiAgICApO1xuXG4gICAgYXdhaXQgdGhpcy5wcmVmZXJlbmNlTWFuYWdlci5zYXZlUHJlZmVyZW5jZXMocHJlZmVyZW5jZXMpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVUZWxlbWV0cnlTZXR0aW5ncyhwcmVmZXJlbmNlczogVXNlclByZWZlcmVuY2VzKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcHJlZmVyZW5jZXMuZW5hYmxlVGVsZW1ldHJ5ID0gYXdhaXQgdGhpcy5hc2tZZXNObygnRW5hYmxlIHRlbGVtZXRyeT8nLCBwcmVmZXJlbmNlcy5lbmFibGVUZWxlbWV0cnkpO1xuXG4gICAgYXdhaXQgdGhpcy5wcmVmZXJlbmNlTWFuYWdlci5zYXZlUHJlZmVyZW5jZXMocHJlZmVyZW5jZXMpO1xuICB9XG59XG5cbi8qKlxuICogRGVmYXVsdCBjb25maWcgd2l6YXJkIGluc3RhbmNlIChzaW5nbGV0b24pXG4gKiBMYXp5LWxvYWRlZCB0byBhdm9pZCBzdGRpbiBpc3N1ZXMgaW4gdGVzdCBlbnZpcm9ubWVudHNcbiAqL1xubGV0IF9kZWZhdWx0Q29uZmlnV2l6YXJkOiBDb25maWdXaXphcmQgfCBudWxsID0gbnVsbDtcbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0Q29uZmlnV2l6YXJkKCk6IENvbmZpZ1dpemFyZCB7XG4gIGlmICghX2RlZmF1bHRDb25maWdXaXphcmQpIHtcbiAgICBfZGVmYXVsdENvbmZpZ1dpemFyZCA9IG5ldyBDb25maWdXaXphcmQoKTtcbiAgfVxuICByZXR1cm4gX2RlZmF1bHRDb25maWdXaXphcmQ7XG59XG4iXSwidmVyc2lvbiI6M30=