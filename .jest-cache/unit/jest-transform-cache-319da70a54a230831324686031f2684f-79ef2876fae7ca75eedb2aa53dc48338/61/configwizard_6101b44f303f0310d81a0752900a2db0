9e121b2a56e5f309ed46499cd8efbef7
"use strict";
/**
 * VERSATIL SDLC Framework - Configuration Wizard
 * Interactive setup wizard for first-time users
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.defaultConfigWizard = exports.ConfigWizard = void 0;
const readline = __importStar(require("readline"));
const preference_manager_js_1 = require("./preference-manager.js");
const config_profiles_js_1 = require("./config-profiles.js");
class ConfigWizard {
    constructor() {
        this.rl = readline.createInterface({
            input: process.stdin,
            output: process.stdout
        });
        this.preferenceManager = new preference_manager_js_1.PreferenceManager();
        this.profileManager = new config_profiles_js_1.ConfigProfileManager();
    }
    /**
     * Run the setup wizard
     */
    async run() {
        console.log('\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó');
        console.log('‚ïë   üöÄ VERSATIL SDLC Framework - First-Time Setup   üöÄ   ‚ïë');
        console.log('‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n');
        console.log('Welcome! Let\'s configure your framework preferences.\n');
        console.log('You can change these settings anytime using: versatil config\n');
        // Ask if user wants quick setup or custom
        const setupType = await this.askChoice('Choose setup type:', [
            { key: '1', label: 'Quick Setup (use recommended defaults)', value: 'quick' },
            { key: '2', label: 'Custom Setup (choose your preferences)', value: 'custom' },
            { key: '3', label: 'Use Profile (conservative/balanced/aggressive)', value: 'profile' }
        ], '1');
        let preferences;
        if (setupType === 'quick') {
            preferences = await this.quickSetup();
        }
        else if (setupType === 'profile') {
            preferences = await this.profileSetup();
        }
        else {
            preferences = await this.customSetup();
        }
        // Save preferences
        await this.preferenceManager.savePreferences(preferences);
        console.log('\n‚úÖ Setup complete! Your preferences have been saved.\n');
        console.log('To view your preferences: versatil config show');
        console.log('To modify preferences: versatil config set <key> <value>\n');
        this.rl.close();
        return preferences;
    }
    /**
     * Quick setup with recommended defaults
     */
    async quickSetup() {
        console.log('\nüì¶ Quick Setup - Using Recommended Defaults\n');
        const preferences = this.preferenceManager.getDefaultPreferences();
        console.log('Your configuration:');
        console.log('  ‚Ä¢ Update Behavior: Notify (you approve updates)');
        console.log('  ‚Ä¢ Update Channel: Stable (production-ready only)');
        console.log('  ‚Ä¢ Safety Level: Balanced (good balance of safety and speed)');
        console.log('  ‚Ä¢ Auto-install Security Updates: Yes');
        console.log('  ‚Ä¢ Backup Before Update: Yes');
        console.log('  ‚Ä¢ Auto-rollback on Failure: Yes');
        console.log('  ‚Ä¢ Telemetry: Yes (helps improve the framework)');
        const confirm = await this.askYesNo('\nContinue with these settings?', true);
        if (!confirm) {
            console.log('\nLet\'s try custom setup instead...\n');
            return await this.customSetup();
        }
        return preferences;
    }
    /**
     * Profile-based setup
     */
    async profileSetup() {
        console.log('\nüìã Profile-Based Setup\n');
        const profiles = this.profileManager.getAvailableProfiles();
        console.log('Available profiles:\n');
        profiles.forEach(profile => {
            console.log(`${profile.emoji} ${profile.name}:`);
            console.log(`   ${profile.description}`);
            console.log(`   Best for: ${profile.bestFor}`);
            console.log('');
        });
        const profileChoice = await this.askChoice('Choose a profile:', [
            { key: '1', label: 'Conservative (maximum safety)', value: 'conservative' },
            { key: '2', label: 'Balanced (recommended)', value: 'balanced' },
            { key: '3', label: 'Aggressive (latest features)', value: 'aggressive' }
        ], '2');
        const profile = this.profileManager.getProfile(profileChoice);
        if (!profile) {
            throw new Error('Invalid profile');
        }
        console.log(`\n‚úÖ Using ${profile.name} profile\n`);
        return profile.preferences;
    }
    /**
     * Custom setup with user choices
     */
    async customSetup() {
        console.log('\n‚öôÔ∏è  Custom Setup\n');
        const preferences = this.preferenceManager.getDefaultPreferences();
        // Update behavior
        console.log('‚ïê‚ïê‚ïê Update Behavior ‚ïê‚ïê‚ïê\n');
        preferences.updateBehavior = await this.askChoice('How should updates be handled?', [
            { key: '1', label: 'Auto - Install updates automatically', value: 'auto' },
            { key: '2', label: 'Notify - Notify me, I approve (recommended)', value: 'notify' },
            { key: '3', label: 'Manual - I check for updates manually', value: 'manual' }
        ], '2');
        // Update channel
        console.log('\n‚ïê‚ïê‚ïê Update Channel ‚ïê‚ïê‚ïê\n');
        preferences.updateChannel = await this.askChoice('Which update channel?', [
            { key: '1', label: 'Stable - Production-ready releases only (recommended)', value: 'stable' },
            { key: '2', label: 'Beta - Early access to new features', value: 'beta' },
            { key: '3', label: 'Alpha - Bleeding edge (may be unstable)', value: 'alpha' }
        ], '1');
        // Safety level
        console.log('\n‚ïê‚ïê‚ïê Safety Level ‚ïê‚ïê‚ïê\n');
        preferences.safetyLevel = await this.askChoice('Choose safety level:', [
            { key: '1', label: 'Conservative - Maximum safety, slower updates', value: 'conservative' },
            { key: '2', label: 'Balanced - Good balance (recommended)', value: 'balanced' },
            { key: '3', label: 'Fast - Faster updates, less validation', value: 'fast' }
        ], '2');
        // Security updates
        console.log('\n‚ïê‚ïê‚ïê Security Updates ‚ïê‚ïê‚ïê\n');
        preferences.autoInstallSecurity = await this.askYesNo('Auto-install security updates? (recommended: yes)', true);
        // Backup
        console.log('\n‚ïê‚ïê‚ïê Backup ‚ïê‚ïê‚ïê\n');
        preferences.backupBeforeUpdate = await this.askYesNo('Create backup before each update? (recommended: yes)', true);
        if (preferences.backupBeforeUpdate) {
            const maxBackupsStr = await this.askInput('Maximum number of backups to keep:', '5');
            preferences.maxRollbackPoints = parseInt(maxBackupsStr, 10) || 5;
        }
        // Rollback
        console.log('\n‚ïê‚ïê‚ïê Rollback ‚ïê‚ïê‚ïê\n');
        preferences.rollbackOnFailure = await this.askYesNo('Auto-rollback if update fails? (recommended: yes)', true);
        // Notifications
        console.log('\n‚ïê‚ïê‚ïê Notifications ‚ïê‚ïê‚ïê\n');
        preferences.notificationLevel = await this.askChoice('Notification level:', [
            { key: '1', label: 'All - Show all notifications', value: 'all' },
            { key: '2', label: 'Important - Important updates only (recommended)', value: 'important' },
            { key: '3', label: 'Critical - Critical updates only', value: 'critical' },
            { key: '4', label: 'None - No notifications', value: 'none' }
        ], '2');
        // Telemetry
        console.log('\n‚ïê‚ïê‚ïê Telemetry ‚ïê‚ïê‚ïê\n');
        console.log('Telemetry helps us improve the framework by collecting anonymous usage data.');
        console.log('No personal information is collected.\n');
        preferences.enableTelemetry = await this.askYesNo('Enable telemetry?', true);
        if (preferences.enableTelemetry) {
            preferences.shareErrorReports = await this.askYesNo('Share error reports?', true);
            preferences.shareUsageStatistics = await this.askYesNo('Share usage statistics?', false);
        }
        console.log('\n');
        return preferences;
    }
    /**
     * Ask yes/no question
     */
    async askYesNo(question, defaultValue) {
        const defaultStr = defaultValue ? 'Y/n' : 'y/N';
        const answer = await this.askInput(`${question} (${defaultStr}):`, defaultValue ? 'y' : 'n');
        const normalized = answer.toLowerCase().trim();
        if (normalized === '') {
            return defaultValue;
        }
        return normalized === 'y' || normalized === 'yes';
    }
    /**
     * Ask input question
     */
    async askInput(question, defaultValue = '') {
        return new Promise(resolve => {
            this.rl.question(`${question} ${defaultValue ? `[${defaultValue}]` : ''} `, answer => {
                resolve(answer.trim() || defaultValue);
            });
        });
    }
    /**
     * Ask choice question
     */
    async askChoice(question, choices, defaultKey = '1') {
        console.log(question);
        choices.forEach(choice => {
            console.log(`  ${choice.key}. ${choice.label}`);
        });
        const answer = await this.askInput('\nYour choice:', defaultKey);
        const choice = choices.find(c => c.key === answer);
        if (!choice) {
            console.log(`Invalid choice. Using default: ${choices.find(c => c.key === defaultKey)?.label}`);
            return choices.find(c => c.key === defaultKey)?.value;
        }
        return choice.value;
    }
    /**
     * Run minimal wizard (for CI/automated installs)
     */
    async runMinimal() {
        console.log('üöÄ Running automated setup with defaults...');
        const preferences = this.preferenceManager.getDefaultPreferences();
        // Disable interactive features for CI
        preferences.updateBehavior = 'manual';
        preferences.notificationLevel = 'none';
        preferences.enableTelemetry = false;
        await this.preferenceManager.savePreferences(preferences);
        console.log('‚úÖ Automated setup complete');
        return preferences;
    }
    /**
     * Update preferences interactively
     */
    async updatePreferences() {
        console.log('\n‚öôÔ∏è  Update Preferences\n');
        const preferences = await this.preferenceManager.getPreferences();
        console.log('Current preferences:');
        console.log(await this.preferenceManager.getSummary());
        console.log('');
        const category = await this.askChoice('What would you like to change?', [
            { key: '1', label: 'Update settings', value: 'update' },
            { key: '2', label: 'Rollback settings', value: 'rollback' },
            { key: '3', label: 'Notification settings', value: 'notification' },
            { key: '4', label: 'Telemetry settings', value: 'telemetry' },
            { key: '5', label: 'View all settings', value: 'view' },
            { key: '6', label: 'Reset to defaults', value: 'reset' }
        ], '1');
        switch (category) {
            case 'update':
                await this.updateUpdateSettings(preferences);
                break;
            case 'rollback':
                await this.updateRollbackSettings(preferences);
                break;
            case 'notification':
                await this.updateNotificationSettings(preferences);
                break;
            case 'telemetry':
                await this.updateTelemetrySettings(preferences);
                break;
            case 'view':
                console.log(await this.preferenceManager.getSummary());
                break;
            case 'reset':
                const confirm = await this.askYesNo('Reset all preferences to defaults?', false);
                if (confirm) {
                    await this.preferenceManager.resetToDefaults();
                }
                break;
        }
        this.rl.close();
    }
    async updateUpdateSettings(preferences) {
        preferences.updateBehavior = await this.askChoice('Update behavior:', [
            { key: '1', label: 'Auto', value: 'auto' },
            { key: '2', label: 'Notify', value: 'notify' },
            { key: '3', label: 'Manual', value: 'manual' }
        ], preferences.updateBehavior === 'auto' ? '1' : preferences.updateBehavior === 'notify' ? '2' : '3');
        await this.preferenceManager.savePreferences(preferences);
    }
    async updateRollbackSettings(preferences) {
        preferences.rollbackOnFailure = await this.askYesNo('Auto-rollback on failure?', preferences.rollbackOnFailure);
        await this.preferenceManager.savePreferences(preferences);
    }
    async updateNotificationSettings(preferences) {
        preferences.notificationLevel = await this.askChoice('Notification level:', [
            { key: '1', label: 'All', value: 'all' },
            { key: '2', label: 'Important', value: 'important' },
            { key: '3', label: 'Critical', value: 'critical' },
            { key: '4', label: 'None', value: 'none' }
        ], preferences.notificationLevel === 'all'
            ? '1'
            : preferences.notificationLevel === 'important'
                ? '2'
                : preferences.notificationLevel === 'critical'
                    ? '3'
                    : '4');
        await this.preferenceManager.savePreferences(preferences);
    }
    async updateTelemetrySettings(preferences) {
        preferences.enableTelemetry = await this.askYesNo('Enable telemetry?', preferences.enableTelemetry);
        await this.preferenceManager.savePreferences(preferences);
    }
}
exports.ConfigWizard = ConfigWizard;
/**
 * Default config wizard instance
 */
exports.defaultConfigWizard = new ConfigWizard();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL25pc3NpbW1lbmFzaGUvVkVSU0FUSUwgU0RMQyBGVy9zcmMvY29uZmlnL2NvbmZpZy13aXphcmQudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsbURBQXFDO0FBQ3JDLG1FQUE2RTtBQUM3RSw2REFBNEQ7QUFFNUQsTUFBYSxZQUFZO0lBS3ZCO1FBQ0UsSUFBSSxDQUFDLEVBQUUsR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDO1lBQ2pDLEtBQUssRUFBRSxPQUFPLENBQUMsS0FBSztZQUNwQixNQUFNLEVBQUUsT0FBTyxDQUFDLE1BQU07U0FDdkIsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUkseUNBQWlCLEVBQUUsQ0FBQztRQUNqRCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUkseUNBQW9CLEVBQUUsQ0FBQztJQUNuRCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsR0FBRztRQUNQLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUVBQWlFLENBQUMsQ0FBQztRQUMvRSxPQUFPLENBQUMsR0FBRyxDQUFDLDREQUE0RCxDQUFDLENBQUM7UUFDMUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpRUFBaUUsQ0FBQyxDQUFDO1FBRS9FLE9BQU8sQ0FBQyxHQUFHLENBQUMseURBQXlELENBQUMsQ0FBQztRQUN2RSxPQUFPLENBQUMsR0FBRyxDQUFDLGdFQUFnRSxDQUFDLENBQUM7UUFFOUUsMENBQTBDO1FBQzFDLE1BQU0sU0FBUyxHQUFHLE1BQU0sSUFBSSxDQUFDLFNBQVMsQ0FDcEMsb0JBQW9CLEVBQ3BCO1lBQ0UsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSx3Q0FBd0MsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFO1lBQzdFLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsd0NBQXdDLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRTtZQUM5RSxFQUFF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Q0FBQyxDQUFDO0lBQzVELENBQUM7SUFFTyxLQUFLLENBQUMsdUJBQXVCLENBQUMsV0FBNEI7UUFDaEUsV0FBVyxDQUFDLGVBQWUsR0FBRyxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsbUJBQW1CLEVBQUUsV0FBVyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBRXBHLE1BQU0sSUFBSSxDQUFDLGlCQUFpQixDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUM1RCxDQUFDO0NBQ0Y7QUExWUQsb0NBMFlDO0FBRUQ7O0dBRUc7QUFDVSxRQUFBLG1CQUFtQixHQUFHLElBQUksWUFBWSxFQUFFLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL25pc3NpbW1lbmFzaGUvVkVSU0FUSUwgU0RMQyBGVy9zcmMvY29uZmlnL2NvbmZpZy13aXphcmQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBWRVJTQVRJTCBTRExDIEZyYW1ld29yayAtIENvbmZpZ3VyYXRpb24gV2l6YXJkXG4gKiBJbnRlcmFjdGl2ZSBzZXR1cCB3aXphcmQgZm9yIGZpcnN0LXRpbWUgdXNlcnNcbiAqL1xuXG5pbXBvcnQgKiBhcyByZWFkbGluZSBmcm9tICdyZWFkbGluZSc7XG5pbXBvcnQgeyBQcmVmZXJlbmNlTWFuYWdlciwgVXNlclByZWZlcmVuY2VzIH0gZnJvbSAnLi9wcmVmZXJlbmNlLW1hbmFnZXIuanMnO1xuaW1wb3J0IHsgQ29uZmlnUHJvZmlsZU1hbmFnZXIgfSBmcm9tICcuL2NvbmZpZy1wcm9maWxlcy5qcyc7XG5cbmV4cG9ydCBjbGFzcyBDb25maWdXaXphcmQge1xuICBwcml2YXRlIHJsOiByZWFkbGluZS5JbnRlcmZhY2U7XG4gIHByaXZhdGUgcHJlZmVyZW5jZU1hbmFnZXI6IFByZWZlcmVuY2VNYW5hZ2VyO1xuICBwcml2YXRlIHByb2ZpbGVNYW5hZ2VyOiBDb25maWdQcm9maWxlTWFuYWdlcjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnJsID0gcmVhZGxpbmUuY3JlYXRlSW50ZXJmYWNlKHtcbiAgICAgIGlucHV0OiBwcm9jZXNzLnN0ZGluLFxuICAgICAgb3V0cHV0OiBwcm9jZXNzLnN0ZG91dFxuICAgIH0pO1xuICAgIHRoaXMucHJlZmVyZW5jZU1hbmFnZXIgPSBuZXcgUHJlZmVyZW5jZU1hbmFnZXIoKTtcbiAgICB0aGlzLnByb2ZpbGVNYW5hZ2VyID0gbmV3IENvbmZpZ1Byb2ZpbGVNYW5hZ2VyKCk7XG4gIH1cblxuICAvKipcbiAgICogUnVuIHRoZSBzZXR1cCB3aXphcmRcbiAgICovXG4gIGFzeW5jIHJ1bigpOiBQcm9taXNlPFVzZXJQcmVmZXJlbmNlcz4ge1xuICAgIGNvbnNvbGUubG9nKCdcXG7ilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZcnKTtcbiAgICBjb25zb2xlLmxvZygn4pWRICAg8J+agCBWRVJTQVRJTCBTRExDIEZyYW1ld29yayAtIEZpcnN0LVRpbWUgU2V0dXAgICDwn5qAICAg4pWRJyk7XG4gICAgY29uc29sZS5sb2coJ+KVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVnVxcbicpO1xuXG4gICAgY29uc29sZS5sb2coJ1dlbGNvbWUhIExldFxcJ3MgY29uZmlndXJlIHlvdXIgZnJhbWV3b3JrIHByZWZlcmVuY2VzLlxcbicpO1xuICAgIGNvbnNvbGUubG9nKCdZb3UgY2FuIGNoYW5nZSB0aGVzZSBzZXR0aW5ncyBhbnl0aW1lIHVzaW5nOiB2ZXJzYXRpbCBjb25maWdcXG4nKTtcblxuICAgIC8vIEFzayBpZiB1c2VyIHdhbnRzIHF1aWNrIHNldHVwIG9yIGN1c3RvbVxuICAgIGNvbnN0IHNldHVwVHlwZSA9IGF3YWl0IHRoaXMuYXNrQ2hvaWNlKFxuICAgICAgJ0Nob29zZSBzZXR1cCB0eXBlOicsXG4gICAgICBbXG4gICAgICAgIHsga2V5OiAnMScsIGxhYmVsOiAnUXVpY2sgU2V0dXAgKHVzZSByZWNvbW1lbmRlZCBkZWZhdWx0cyknLCB2YWx1ZTogJ3F1aWNrJyB9LFxuICAgICAgICB7IGtleTogJzInLCBsYWJlbDogJ0N1c3RvbSBTZXR1cCAoY2hvb3NlIHlvdXIgcHJlZmVyZW5jZXMpJywgdmFsdWU6ICdjdXN0b20nIH0sXG4gICAgICAgIHsga2V5OiAnMycsIGxhYmVsOiAnVXNlIFByb2ZpbGUgKGNvbnNlcnZhdGl2ZS9iYWxhbmNlZC9hZ2dyZXNzaXZlKScsIHZhbHVlOiAncHJvZmlsZScgfVxuICAgICAgXSxcbiAgICAgICcxJ1xuICAgICk7XG5cbiAgICBsZXQgcHJlZmVyZW5jZXM6IFVzZXJQcmVmZXJlbmNlcztcblxuICAgIGlmIChzZXR1cFR5cGUgPT09ICdxdWljaycpIHtcbiAgICAgIHByZWZlcmVuY2VzID0gYXdhaXQgdGhpcy5xdWlja1NldHVwKCk7XG4gICAgfSBlbHNlIGlmIChzZXR1cFR5cGUgPT09ICdwcm9maWxlJykge1xuICAgICAgcHJlZmVyZW5jZXMgPSBhd2FpdCB0aGlzLnByb2ZpbGVTZXR1cCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcmVmZXJlbmNlcyA9IGF3YWl0IHRoaXMuY3VzdG9tU2V0dXAoKTtcbiAgICB9XG5cbiAgICAvLyBTYXZlIHByZWZlcmVuY2VzXG4gICAgYXdhaXQgdGhpcy5wcmVmZXJlbmNlTWFuYWdlci5zYXZlUHJlZmVyZW5jZXMocHJlZmVyZW5jZXMpO1xuXG4gICAgY29uc29sZS5sb2coJ1xcbuKchSBTZXR1cCBjb21wbGV0ZSEgWW91ciBwcmVmZXJlbmNlcyBoYXZlIGJlZW4gc2F2ZWQuXFxuJyk7XG4gICAgY29uc29sZS5sb2coJ1RvIHZpZXcgeW91ciBwcmVmZXJlbmNlczogdmVyc2F0aWwgY29uZmlnIHNob3cnKTtcbiAgICBjb25zb2xlLmxvZygnVG8gbW9kaWZ5IHByZWZlcmVuY2VzOiB2ZXJzYXRpbCBjb25maWcgc2V0IDxrZXk+IDx2YWx1ZT5cXG4nKTtcblxuICAgIHRoaXMucmwuY2xvc2UoKTtcblxuICAgIHJldHVybiBwcmVmZXJlbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBRdWljayBzZXR1cCB3aXRoIHJlY29tbWVuZGVkIGRlZmF1bHRzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHF1aWNrU2V0dXAoKTogUHJvbWlzZTxVc2VyUHJlZmVyZW5jZXM+IHtcbiAgICBjb25zb2xlLmxvZygnXFxu8J+TpiBRdWljayBTZXR1cCAtIFVzaW5nIFJlY29tbWVuZGVkIERlZmF1bHRzXFxuJyk7XG5cbiAgICBjb25zdCBwcmVmZXJlbmNlcyA9IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIuZ2V0RGVmYXVsdFByZWZlcmVuY2VzKCk7XG5cbiAgICBjb25zb2xlLmxvZygnWW91ciBjb25maWd1cmF0aW9uOicpO1xuICAgIGNvbnNvbGUubG9nKCcgIOKAoiBVcGRhdGUgQmVoYXZpb3I6IE5vdGlmeSAoeW91IGFwcHJvdmUgdXBkYXRlcyknKTtcbiAgICBjb25zb2xlLmxvZygnICDigKIgVXBkYXRlIENoYW5uZWw6IFN0YWJsZSAocHJvZHVjdGlvbi1yZWFkeSBvbmx5KScpO1xuICAgIGNvbnNvbGUubG9nKCcgIOKAoiBTYWZldHkgTGV2ZWw6IEJhbGFuY2VkIChnb29kIGJhbGFuY2Ugb2Ygc2FmZXR5IGFuZCBzcGVlZCknKTtcbiAgICBjb25zb2xlLmxvZygnICDigKIgQXV0by1pbnN0YWxsIFNlY3VyaXR5IFVwZGF0ZXM6IFllcycpO1xuICAgIGNvbnNvbGUubG9nKCcgIOKAoiBCYWNrdXAgQmVmb3JlIFVwZGF0ZTogWWVzJyk7XG4gICAgY29uc29sZS5sb2coJyAg4oCiIEF1dG8tcm9sbGJhY2sgb24gRmFpbHVyZTogWWVzJyk7XG4gICAgY29uc29sZS5sb2coJyAg4oCiIFRlbGVtZXRyeTogWWVzIChoZWxwcyBpbXByb3ZlIHRoZSBmcmFtZXdvcmspJyk7XG5cbiAgICBjb25zdCBjb25maXJtID0gYXdhaXQgdGhpcy5hc2tZZXNObygnXFxuQ29udGludWUgd2l0aCB0aGVzZSBzZXR0aW5ncz8nLCB0cnVlKTtcblxuICAgIGlmICghY29uZmlybSkge1xuICAgICAgY29uc29sZS5sb2coJ1xcbkxldFxcJ3MgdHJ5IGN1c3RvbSBzZXR1cCBpbnN0ZWFkLi4uXFxuJyk7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5jdXN0b21TZXR1cCgpO1xuICAgIH1cblxuICAgIHJldHVybiBwcmVmZXJlbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9maWxlLWJhc2VkIHNldHVwXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHByb2ZpbGVTZXR1cCgpOiBQcm9taXNlPFVzZXJQcmVmZXJlbmNlcz4ge1xuICAgIGNvbnNvbGUubG9nKCdcXG7wn5OLIFByb2ZpbGUtQmFzZWQgU2V0dXBcXG4nKTtcblxuICAgIGNvbnN0IHByb2ZpbGVzID0gdGhpcy5wcm9maWxlTWFuYWdlci5nZXRBdmFpbGFibGVQcm9maWxlcygpO1xuXG4gICAgY29uc29sZS5sb2coJ0F2YWlsYWJsZSBwcm9maWxlczpcXG4nKTtcbiAgICBwcm9maWxlcy5mb3JFYWNoKHByb2ZpbGUgPT4ge1xuICAgICAgY29uc29sZS5sb2coYCR7cHJvZmlsZS5lbW9qaX0gJHtwcm9maWxlLm5hbWV9OmApO1xuICAgICAgY29uc29sZS5sb2coYCAgICR7cHJvZmlsZS5kZXNjcmlwdGlvbn1gKTtcbiAgICAgIGNvbnNvbGUubG9nKGAgICBCZXN0IGZvcjogJHtwcm9maWxlLmJlc3RGb3J9YCk7XG4gICAgICBjb25zb2xlLmxvZygnJyk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBwcm9maWxlQ2hvaWNlID0gYXdhaXQgdGhpcy5hc2tDaG9pY2UoXG4gICAgICAnQ2hvb3NlIGEgcHJvZmlsZTonLFxuICAgICAgW1xuICAgICAgICB7IGtleTogJzEnLCBsYWJlbDogJ0NvbnNlcnZhdGl2ZSAobWF4aW11bSBzYWZldHkpJywgdmFsdWU6ICdjb25zZXJ2YXRpdmUnIH0sXG4gICAgICAgIHsga2V5OiAnMicsIGxhYmVsOiAnQmFsYW5jZWQgKHJlY29tbWVuZGVkKScsIHZhbHVlOiAnYmFsYW5jZWQnIH0sXG4gICAgICAgIHsga2V5OiAnMycsIGxhYmVsOiAnQWdncmVzc2l2ZSAobGF0ZXN0IGZlYXR1cmVzKScsIHZhbHVlOiAnYWdncmVzc2l2ZScgfVxuICAgICAgXSxcbiAgICAgICcyJ1xuICAgICk7XG5cbiAgICBjb25zdCBwcm9maWxlID0gdGhpcy5wcm9maWxlTWFuYWdlci5nZXRQcm9maWxlKHByb2ZpbGVDaG9pY2UgYXMgYW55KTtcblxuICAgIGlmICghcHJvZmlsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHByb2ZpbGUnKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgXFxu4pyFIFVzaW5nICR7cHJvZmlsZS5uYW1lfSBwcm9maWxlXFxuYCk7XG5cbiAgICByZXR1cm4gcHJvZmlsZS5wcmVmZXJlbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDdXN0b20gc2V0dXAgd2l0aCB1c2VyIGNob2ljZXNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY3VzdG9tU2V0dXAoKTogUHJvbWlzZTxVc2VyUHJlZmVyZW5jZXM+IHtcbiAgICBjb25zb2xlLmxvZygnXFxu4pqZ77iPICBDdXN0b20gU2V0dXBcXG4nKTtcblxuICAgIGNvbnN0IHByZWZlcmVuY2VzID0gdGhpcy5wcmVmZXJlbmNlTWFuYWdlci5nZXREZWZhdWx0UHJlZmVyZW5jZXMoKTtcblxuICAgIC8vIFVwZGF0ZSBiZWhhdmlvclxuICAgIGNvbnNvbGUubG9nKCfilZDilZDilZAgVXBkYXRlIEJlaGF2aW9yIOKVkOKVkOKVkFxcbicpO1xuICAgIHByZWZlcmVuY2VzLnVwZGF0ZUJlaGF2aW9yID0gYXdhaXQgdGhpcy5hc2tDaG9pY2UoXG4gICAgICAnSG93IHNob3VsZCB1cGRhdGVzIGJlIGhhbmRsZWQ/JyxcbiAgICAgIFtcbiAgICAgICAgeyBrZXk6ICcxJywgbGFiZWw6ICdBdXRvIC0gSW5zdGFsbCB1cGRhdGVzIGF1dG9tYXRpY2FsbHknLCB2YWx1ZTogJ2F1dG8nIH0sXG4gICAgICAgIHsga2V5OiAnMicsIGxhYmVsOiAnTm90aWZ5IC0gTm90aWZ5IG1lLCBJIGFwcHJvdmUgKHJlY29tbWVuZGVkKScsIHZhbHVlOiAnbm90aWZ5JyB9LFxuICAgICAgICB7IGtleTogJzMnLCBsYWJlbDogJ01hbnVhbCAtIEkgY2hlY2sgZm9yIHVwZGF0ZXMgbWFudWFsbHknLCB2YWx1ZTogJ21hbnVhbCcgfVxuICAgICAgXSxcbiAgICAgICcyJ1xuICAgICk7XG5cbiAgICAvLyBVcGRhdGUgY2hhbm5lbFxuICAgIGNvbnNvbGUubG9nKCdcXG7ilZDilZDilZAgVXBkYXRlIENoYW5uZWwg4pWQ4pWQ4pWQXFxuJyk7XG4gICAgcHJlZmVyZW5jZXMudXBkYXRlQ2hhbm5lbCA9IGF3YWl0IHRoaXMuYXNrQ2hvaWNlKFxuICAgICAgJ1doaWNoIHVwZGF0ZSBjaGFubmVsPycsXG4gICAgICBbXG4gICAgICAgIHsga2V5OiAnMScsIGxhYmVsOiAnU3RhYmxlIC0gUHJvZHVjdGlvbi1yZWFkeSByZWxlYXNlcyBvbmx5IChyZWNvbW1lbmRlZCknLCB2YWx1ZTogJ3N0YWJsZScgfSxcbiAgICAgICAgeyBrZXk6ICcyJywgbGFiZWw6ICdCZXRhIC0gRWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcycsIHZhbHVlOiAnYmV0YScgfSxcbiAgICAgICAgeyBrZXk6ICczJywgbGFiZWw6ICdBbHBoYSAtIEJsZWVkaW5nIGVkZ2UgKG1heSBiZSB1bnN0YWJsZSknLCB2YWx1ZTogJ2FscGhhJyB9XG4gICAgICBdLFxuICAgICAgJzEnXG4gICAgKTtcblxuICAgIC8vIFNhZmV0eSBsZXZlbFxuICAgIGNvbnNvbGUubG9nKCdcXG7ilZDilZDilZAgU2FmZXR5IExldmVsIOKVkOKVkOKVkFxcbicpO1xuICAgIHByZWZlcmVuY2VzLnNhZmV0eUxldmVsID0gYXdhaXQgdGhpcy5hc2tDaG9pY2UoXG4gICAgICAnQ2hvb3NlIHNhZmV0eSBsZXZlbDonLFxuICAgICAgW1xuICAgICAgICB7IGtleTogJzEnLCBsYWJlbDogJ0NvbnNlcnZhdGl2ZSAtIE1heGltdW0gc2FmZXR5LCBzbG93ZXIgdXBkYXRlcycsIHZhbHVlOiAnY29uc2VydmF0aXZlJyB9LFxuICAgICAgICB7IGtleTogJzInLCBsYWJlbDogJ0JhbGFuY2VkIC0gR29vZCBiYWxhbmNlIChyZWNvbW1lbmRlZCknLCB2YWx1ZTogJ2JhbGFuY2VkJyB9LFxuICAgICAgICB7IGtleTogJzMnLCBsYWJlbDogJ0Zhc3QgLSBGYXN0ZXIgdXBkYXRlcywgbGVzcyB2YWxpZGF0aW9uJywgdmFsdWU6ICdmYXN0JyB9XG4gICAgICBdLFxuICAgICAgJzInXG4gICAgKTtcblxuICAgIC8vIFNlY3VyaXR5IHVwZGF0ZXNcbiAgICBjb25zb2xlLmxvZygnXFxu4pWQ4pWQ4pWQIFNlY3VyaXR5IFVwZGF0ZXMg4pWQ4pWQ4pWQXFxuJyk7XG4gICAgcHJlZmVyZW5jZXMuYXV0b0luc3RhbGxTZWN1cml0eSA9IGF3YWl0IHRoaXMuYXNrWWVzTm8oXG4gICAgICAnQXV0by1pbnN0YWxsIHNlY3VyaXR5IHVwZGF0ZXM/IChyZWNvbW1lbmRlZDogeWVzKScsXG4gICAgICB0cnVlXG4gICAgKTtcblxuICAgIC8vIEJhY2t1cFxuICAgIGNvbnNvbGUubG9nKCdcXG7ilZDilZDilZAgQmFja3VwIOKVkOKVkOKVkFxcbicpO1xuICAgIHByZWZlcmVuY2VzLmJhY2t1cEJlZm9yZVVwZGF0ZSA9IGF3YWl0IHRoaXMuYXNrWWVzTm8oJ0NyZWF0ZSBiYWNrdXAgYmVmb3JlIGVhY2ggdXBkYXRlPyAocmVjb21tZW5kZWQ6IHllcyknLCB0cnVlKTtcblxuICAgIGlmIChwcmVmZXJlbmNlcy5iYWNrdXBCZWZvcmVVcGRhdGUpIHtcbiAgICAgIGNvbnN0IG1heEJhY2t1cHNTdHIgPSBhd2FpdCB0aGlzLmFza0lucHV0KFxuICAgICAgICAnTWF4aW11bSBudW1iZXIgb2YgYmFja3VwcyB0byBrZWVwOicsXG4gICAgICAgICc1J1xuICAgICAgKTtcbiAgICAgIHByZWZlcmVuY2VzLm1heFJvbGxiYWNrUG9pbnRzID0gcGFyc2VJbnQobWF4QmFja3Vwc1N0ciwgMTApIHx8IDU7XG4gICAgfVxuXG4gICAgLy8gUm9sbGJhY2tcbiAgICBjb25zb2xlLmxvZygnXFxu4pWQ4pWQ4pWQIFJvbGxiYWNrIOKVkOKVkOKVkFxcbicpO1xuICAgIHByZWZlcmVuY2VzLnJvbGxiYWNrT25GYWlsdXJlID0gYXdhaXQgdGhpcy5hc2tZZXNObyhcbiAgICAgICdBdXRvLXJvbGxiYWNrIGlmIHVwZGF0ZSBmYWlscz8gKHJlY29tbWVuZGVkOiB5ZXMpJyxcbiAgICAgIHRydWVcbiAgICApO1xuXG4gICAgLy8gTm90aWZpY2F0aW9uc1xuICAgIGNvbnNvbGUubG9nKCdcXG7ilZDilZDilZAgTm90aWZpY2F0aW9ucyDilZDilZDilZBcXG4nKTtcbiAgICBwcmVmZXJlbmNlcy5ub3RpZmljYXRpb25MZXZlbCA9IGF3YWl0IHRoaXMuYXNrQ2hvaWNlKFxuICAgICAgJ05vdGlmaWNhdGlvbiBsZXZlbDonLFxuICAgICAgW1xuICAgICAgICB7IGtleTogJzEnLCBsYWJlbDogJ0FsbCAtIFNob3cgYWxsIG5vdGlmaWNhdGlvbnMnLCB2YWx1ZTogJ2FsbCcgfSxcbiAgICAgICAgeyBrZXk6ICcyJywgbGFiZWw6ICdJbXBvcnRhbnQgLSBJbXBvcnRhbnQgdXBkYXRlcyBvbmx5IChyZWNvbW1lbmRlZCknLCB2YWx1ZTogJ2ltcG9ydGFudCcgfSxcbiAgICAgICAgeyBrZXk6ICczJywgbGFiZWw6ICdDcml0aWNhbCAtIENyaXRpY2FsIHVwZGF0ZXMgb25seScsIHZhbHVlOiAnY3JpdGljYWwnIH0sXG4gICAgICAgIHsga2V5OiAnNCcsIGxhYmVsOiAnTm9uZSAtIE5vIG5vdGlmaWNhdGlvbnMnLCB2YWx1ZTogJ25vbmUnIH1cbiAgICAgIF0sXG4gICAgICAnMidcbiAgICApO1xuXG4gICAgLy8gVGVsZW1ldHJ5XG4gICAgY29uc29sZS5sb2coJ1xcbuKVkOKVkOKVkCBUZWxlbWV0cnkg4pWQ4pWQ4pWQXFxuJyk7XG4gICAgY29uc29sZS5sb2coJ1RlbGVtZXRyeSBoZWxwcyB1cyBpbXByb3ZlIHRoZSBmcmFtZXdvcmsgYnkgY29sbGVjdGluZyBhbm9ueW1vdXMgdXNhZ2UgZGF0YS4nKTtcbiAgICBjb25zb2xlLmxvZygnTm8gcGVyc29uYWwgaW5mb3JtYXRpb24gaXMgY29sbGVjdGVkLlxcbicpO1xuICAgIHByZWZlcmVuY2VzLmVuYWJsZVRlbGVtZXRyeSA9IGF3YWl0IHRoaXMuYXNrWWVzTm8oJ0VuYWJsZSB0ZWxlbWV0cnk/JywgdHJ1ZSk7XG5cbiAgICBpZiAocHJlZmVyZW5jZXMuZW5hYmxlVGVsZW1ldHJ5KSB7XG4gICAgICBwcmVmZXJlbmNlcy5zaGFyZUVycm9yUmVwb3J0cyA9IGF3YWl0IHRoaXMuYXNrWWVzTm8oJ1NoYXJlIGVycm9yIHJlcG9ydHM/JywgdHJ1ZSk7XG4gICAgICBwcmVmZXJlbmNlcy5zaGFyZVVzYWdlU3RhdGlzdGljcyA9IGF3YWl0IHRoaXMuYXNrWWVzTm8oJ1NoYXJlIHVzYWdlIHN0YXRpc3RpY3M/JywgZmFsc2UpO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdcXG4nKTtcblxuICAgIHJldHVybiBwcmVmZXJlbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBBc2sgeWVzL25vIHF1ZXN0aW9uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGFza1llc05vKHF1ZXN0aW9uOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZTogYm9vbGVhbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGRlZmF1bHRTdHIgPSBkZWZhdWx0VmFsdWUgPyAnWS9uJyA6ICd5L04nO1xuICAgIGNvbnN0IGFuc3dlciA9IGF3YWl0IHRoaXMuYXNrSW5wdXQoYCR7cXVlc3Rpb259ICgke2RlZmF1bHRTdHJ9KTpgLCBkZWZhdWx0VmFsdWUgPyAneScgOiAnbicpO1xuXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IGFuc3dlci50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcblxuICAgIGlmIChub3JtYWxpemVkID09PSAnJykge1xuICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gbm9ybWFsaXplZCA9PT0gJ3knIHx8IG5vcm1hbGl6ZWQgPT09ICd5ZXMnO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzayBpbnB1dCBxdWVzdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhc2tJbnB1dChxdWVzdGlvbjogc3RyaW5nLCBkZWZhdWx0VmFsdWU6IHN0cmluZyA9ICcnKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICB0aGlzLnJsLnF1ZXN0aW9uKGAke3F1ZXN0aW9ufSAke2RlZmF1bHRWYWx1ZSA/IGBbJHtkZWZhdWx0VmFsdWV9XWAgOiAnJ30gYCwgYW5zd2VyID0+IHtcbiAgICAgICAgcmVzb2x2ZShhbnN3ZXIudHJpbSgpIHx8IGRlZmF1bHRWYWx1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBc2sgY2hvaWNlIHF1ZXN0aW9uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGFza0Nob2ljZShcbiAgICBxdWVzdGlvbjogc3RyaW5nLFxuICAgIGNob2ljZXM6IEFycmF5PHsga2V5OiBzdHJpbmc7IGxhYmVsOiBzdHJpbmc7IHZhbHVlOiBzdHJpbmcgfT4sXG4gICAgZGVmYXVsdEtleTogc3RyaW5nID0gJzEnXG4gICk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc29sZS5sb2cocXVlc3Rpb24pO1xuICAgIGNob2ljZXMuZm9yRWFjaChjaG9pY2UgPT4ge1xuICAgICAgY29uc29sZS5sb2coYCAgJHtjaG9pY2Uua2V5fS4gJHtjaG9pY2UubGFiZWx9YCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzLmFza0lucHV0KCdcXG5Zb3VyIGNob2ljZTonLCBkZWZhdWx0S2V5KTtcblxuICAgIGNvbnN0IGNob2ljZSA9IGNob2ljZXMuZmluZChjID0+IGMua2V5ID09PSBhbnN3ZXIpO1xuXG4gICAgaWYgKCFjaG9pY2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBJbnZhbGlkIGNob2ljZS4gVXNpbmcgZGVmYXVsdDogJHtjaG9pY2VzLmZpbmQoYyA9PiBjLmtleSA9PT0gZGVmYXVsdEtleSk/LmxhYmVsfWApO1xuICAgICAgcmV0dXJuIGNob2ljZXMuZmluZChjID0+IGMua2V5ID09PSBkZWZhdWx0S2V5KT8udmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNob2ljZS52YWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSdW4gbWluaW1hbCB3aXphcmQgKGZvciBDSS9hdXRvbWF0ZWQgaW5zdGFsbHMpXG4gICAqL1xuICBhc3luYyBydW5NaW5pbWFsKCk6IFByb21pc2U8VXNlclByZWZlcmVuY2VzPiB7XG4gICAgY29uc29sZS5sb2coJ/CfmoAgUnVubmluZyBhdXRvbWF0ZWQgc2V0dXAgd2l0aCBkZWZhdWx0cy4uLicpO1xuXG4gICAgY29uc3QgcHJlZmVyZW5jZXMgPSB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLmdldERlZmF1bHRQcmVmZXJlbmNlcygpO1xuXG4gICAgLy8gRGlzYWJsZSBpbnRlcmFjdGl2ZSBmZWF0dXJlcyBmb3IgQ0lcbiAgICBwcmVmZXJlbmNlcy51cGRhdGVCZWhhdmlvciA9ICdtYW51YWwnO1xuICAgIHByZWZlcmVuY2VzLm5vdGlmaWNhdGlvbkxldmVsID0gJ25vbmUnO1xuICAgIHByZWZlcmVuY2VzLmVuYWJsZVRlbGVtZXRyeSA9IGZhbHNlO1xuXG4gICAgYXdhaXQgdGhpcy5wcmVmZXJlbmNlTWFuYWdlci5zYXZlUHJlZmVyZW5jZXMocHJlZmVyZW5jZXMpO1xuXG4gICAgY29uc29sZS5sb2coJ+KchSBBdXRvbWF0ZWQgc2V0dXAgY29tcGxldGUnKTtcblxuICAgIHJldHVybiBwcmVmZXJlbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgcHJlZmVyZW5jZXMgaW50ZXJhY3RpdmVseVxuICAgKi9cbiAgYXN5bmMgdXBkYXRlUHJlZmVyZW5jZXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coJ1xcbuKame+4jyAgVXBkYXRlIFByZWZlcmVuY2VzXFxuJyk7XG5cbiAgICBjb25zdCBwcmVmZXJlbmNlcyA9IGF3YWl0IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIuZ2V0UHJlZmVyZW5jZXMoKTtcblxuICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHByZWZlcmVuY2VzOicpO1xuICAgIGNvbnNvbGUubG9nKGF3YWl0IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIuZ2V0U3VtbWFyeSgpKTtcbiAgICBjb25zb2xlLmxvZygnJyk7XG5cbiAgICBjb25zdCBjYXRlZ29yeSA9IGF3YWl0IHRoaXMuYXNrQ2hvaWNlKFxuICAgICAgJ1doYXQgd291bGQgeW91IGxpa2UgdG8gY2hhbmdlPycsXG4gICAgICBbXG4gICAgICAgIHsga2V5OiAnMScsIGxhYmVsOiAnVXBkYXRlIHNldHRpbmdzJywgdmFsdWU6ICd1cGRhdGUnIH0sXG4gICAgICAgIHsga2V5OiAnMicsIGxhYmVsOiAnUm9sbGJhY2sgc2V0dGluZ3MnLCB2YWx1ZTogJ3JvbGxiYWNrJyB9LFxuICAgICAgICB7IGtleTogJzMnLCBsYWJlbDogJ05vdGlmaWNhdGlvbiBzZXR0aW5ncycsIHZhbHVlOiAnbm90aWZpY2F0aW9uJyB9LFxuICAgICAgICB7IGtleTogJzQnLCBsYWJlbDogJ1RlbGVtZXRyeSBzZXR0aW5ncycsIHZhbHVlOiAndGVsZW1ldHJ5JyB9LFxuICAgICAgICB7IGtleTogJzUnLCBsYWJlbDogJ1ZpZXcgYWxsIHNldHRpbmdzJywgdmFsdWU6ICd2aWV3JyB9LFxuICAgICAgICB7IGtleTogJzYnLCBsYWJlbDogJ1Jlc2V0IHRvIGRlZmF1bHRzJywgdmFsdWU6ICdyZXNldCcgfVxuICAgICAgXSxcbiAgICAgICcxJ1xuICAgICk7XG5cbiAgICBzd2l0Y2ggKGNhdGVnb3J5KSB7XG4gICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVVwZGF0ZVNldHRpbmdzKHByZWZlcmVuY2VzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyb2xsYmFjayc6XG4gICAgICAgIGF3YWl0IHRoaXMudXBkYXRlUm9sbGJhY2tTZXR0aW5ncyhwcmVmZXJlbmNlcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbm90aWZpY2F0aW9uJzpcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVOb3RpZmljYXRpb25TZXR0aW5ncyhwcmVmZXJlbmNlcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndGVsZW1ldHJ5JzpcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVUZWxlbWV0cnlTZXR0aW5ncyhwcmVmZXJlbmNlcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndmlldyc6XG4gICAgICAgIGNvbnNvbGUubG9nKGF3YWl0IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIuZ2V0U3VtbWFyeSgpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyZXNldCc6XG4gICAgICAgIGNvbnN0IGNvbmZpcm0gPSBhd2FpdCB0aGlzLmFza1llc05vKCdSZXNldCBhbGwgcHJlZmVyZW5jZXMgdG8gZGVmYXVsdHM/JywgZmFsc2UpO1xuICAgICAgICBpZiAoY29uZmlybSkge1xuICAgICAgICAgIGF3YWl0IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIucmVzZXRUb0RlZmF1bHRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgdGhpcy5ybC5jbG9zZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVVcGRhdGVTZXR0aW5ncyhwcmVmZXJlbmNlczogVXNlclByZWZlcmVuY2VzKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcHJlZmVyZW5jZXMudXBkYXRlQmVoYXZpb3IgPSBhd2FpdCB0aGlzLmFza0Nob2ljZShcbiAgICAgICdVcGRhdGUgYmVoYXZpb3I6JyxcbiAgICAgIFtcbiAgICAgICAgeyBrZXk6ICcxJywgbGFiZWw6ICdBdXRvJywgdmFsdWU6ICdhdXRvJyB9LFxuICAgICAgICB7IGtleTogJzInLCBsYWJlbDogJ05vdGlmeScsIHZhbHVlOiAnbm90aWZ5JyB9LFxuICAgICAgICB7IGtleTogJzMnLCBsYWJlbDogJ01hbnVhbCcsIHZhbHVlOiAnbWFudWFsJyB9XG4gICAgICBdLFxuICAgICAgcHJlZmVyZW5jZXMudXBkYXRlQmVoYXZpb3IgPT09ICdhdXRvJyA/ICcxJyA6IHByZWZlcmVuY2VzLnVwZGF0ZUJlaGF2aW9yID09PSAnbm90aWZ5JyA/ICcyJyA6ICczJ1xuICAgICk7XG5cbiAgICBhd2FpdCB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLnNhdmVQcmVmZXJlbmNlcyhwcmVmZXJlbmNlcyk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHVwZGF0ZVJvbGxiYWNrU2V0dGluZ3MocHJlZmVyZW5jZXM6IFVzZXJQcmVmZXJlbmNlcyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHByZWZlcmVuY2VzLnJvbGxiYWNrT25GYWlsdXJlID0gYXdhaXQgdGhpcy5hc2tZZXNObyhcbiAgICAgICdBdXRvLXJvbGxiYWNrIG9uIGZhaWx1cmU/JyxcbiAgICAgIHByZWZlcmVuY2VzLnJvbGxiYWNrT25GYWlsdXJlXG4gICAgKTtcblxuICAgIGF3YWl0IHRoaXMucHJlZmVyZW5jZU1hbmFnZXIuc2F2ZVByZWZlcmVuY2VzKHByZWZlcmVuY2VzKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlTm90aWZpY2F0aW9uU2V0dGluZ3MocHJlZmVyZW5jZXM6IFVzZXJQcmVmZXJlbmNlcyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHByZWZlcmVuY2VzLm5vdGlmaWNhdGlvbkxldmVsID0gYXdhaXQgdGhpcy5hc2tDaG9pY2UoXG4gICAgICAnTm90aWZpY2F0aW9uIGxldmVsOicsXG4gICAgICBbXG4gICAgICAgIHsga2V5OiAnMScsIGxhYmVsOiAnQWxsJywgdmFsdWU6ICdhbGwnIH0sXG4gICAgICAgIHsga2V5OiAnMicsIGxhYmVsOiAnSW1wb3J0YW50JywgdmFsdWU6ICdpbXBvcnRhbnQnIH0sXG4gICAgICAgIHsga2V5OiAnMycsIGxhYmVsOiAnQ3JpdGljYWwnLCB2YWx1ZTogJ2NyaXRpY2FsJyB9LFxuICAgICAgICB7IGtleTogJzQnLCBsYWJlbDogJ05vbmUnLCB2YWx1ZTogJ25vbmUnIH1cbiAgICAgIF0sXG4gICAgICBwcmVmZXJlbmNlcy5ub3RpZmljYXRpb25MZXZlbCA9PT0gJ2FsbCdcbiAgICAgICAgPyAnMSdcbiAgICAgICAgOiBwcmVmZXJlbmNlcy5ub3RpZmljYXRpb25MZXZlbCA9PT0gJ2ltcG9ydGFudCdcbiAgICAgICAgICA/ICcyJ1xuICAgICAgICAgIDogcHJlZmVyZW5jZXMubm90aWZpY2F0aW9uTGV2ZWwgPT09ICdjcml0aWNhbCdcbiAgICAgICAgICAgID8gJzMnXG4gICAgICAgICAgICA6ICc0J1xuICAgICk7XG5cbiAgICBhd2FpdCB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLnNhdmVQcmVmZXJlbmNlcyhwcmVmZXJlbmNlcyk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHVwZGF0ZVRlbGVtZXRyeVNldHRpbmdzKHByZWZlcmVuY2VzOiBVc2VyUHJlZmVyZW5jZXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBwcmVmZXJlbmNlcy5lbmFibGVUZWxlbWV0cnkgPSBhd2FpdCB0aGlzLmFza1llc05vKCdFbmFibGUgdGVsZW1ldHJ5PycsIHByZWZlcmVuY2VzLmVuYWJsZVRlbGVtZXRyeSk7XG5cbiAgICBhd2FpdCB0aGlzLnByZWZlcmVuY2VNYW5hZ2VyLnNhdmVQcmVmZXJlbmNlcyhwcmVmZXJlbmNlcyk7XG4gIH1cbn1cblxuLyoqXG4gKiBEZWZhdWx0IGNvbmZpZyB3aXphcmQgaW5zdGFuY2VcbiAqL1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRDb25maWdXaXphcmQgPSBuZXcgQ29uZmlnV2l6YXJkKCk7XG4iXSwidmVyc2lvbiI6M30=