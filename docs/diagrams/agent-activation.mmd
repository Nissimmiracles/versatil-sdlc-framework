%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#e8f5e9','primaryTextColor':'#1b5e20','primaryBorderColor':'#4caf50','lineColor':'#4caf50','secondaryColor':'#fff3e0','tertiaryColor':'#e3f2fd'}}}%%
flowchart TD
    Start(["ğŸ‘¤ You edit:<br/><b>src/components/Button.tsx</b>"]) --> Save["ğŸ’¾ File Save Event"]

    Save --> Hook["ğŸª Cursor Hook:<br/><b>afterFileEdit</b><br/>â±ï¸ <50ms"]

    Hook --> Pattern["ğŸ” Pattern Match:<br/><b>*.tsx</b> detected<br/>â±ï¸ <500ms"]

    Pattern --> Agent["ğŸ¤– Agent Activation:<br/><b>James-Frontend</b><br/>â±ï¸ <2s"]

    Agent --> Tech{"ğŸ”¬ Tech Detection"}

    Tech -->|"React patterns"| SubReact["ğŸ¨ Sub-Agent:<br/><b>James-React</b>"]
    Tech -->|"Vue patterns"| SubVue["ğŸ¨ Sub-Agent:<br/><b>James-Vue</b>"]
    Tech -->|"Angular patterns"| SubAngular["ğŸ¨ Sub-Agent:<br/><b>James-Angular</b>"]

    SubReact --> RAG["ğŸ’¾ Search RAG:<br/>Similar Button components<br/>â±ï¸ <800ms"]
    SubVue --> RAG
    SubAngular --> RAG

    RAG --> Checks["âœ… Quality Checks"]

    Checks --> C1["ğŸ” Accessibility<br/>(WCAG 2.1 AA)"]
    Checks --> C2["ğŸ“± Responsive Design<br/>(Mobile, Tablet, Desktop)"]
    Checks --> C3["âš¡ Performance<br/>(Bundle size, rendering)"]

    C1 --> Status["ğŸ“Š Update Statusline:<br/><b>ğŸ¤– James-React: Button validation</b><br/>â±ï¸ <100ms"]
    C2 --> Status
    C3 --> Status

    Status --> Result

    Result{{"ğŸ¯ Result"}}

    Result -->|"All checks pass"| Pass["âœ… <b>92% accessible</b><br/>âœ… <b>Responsive</b><br/>âœ… <b>Optimized</b><br/><br/>Total: <2 seconds"]
    Result -->|"Issues found"| Warn["âš ï¸ <b>Missing aria-label</b><br/>âš ï¸ <b>No mobile breakpoint</b><br/><br/>Inline suggestions provided<br/>Total: <2 seconds"]

    classDef user fill:#e0e0e0,stroke:#616161,stroke-width:2px
    classDef hook fill:#fff3e0,stroke:#ff9800,stroke-width:2px
    classDef agent fill:#e8f5e9,stroke:#4caf50,stroke-width:3px
    classDef subagent fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    classDef check fill:#e3f2fd,stroke:#2196f3,stroke-width:2px
    classDef success fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px
    classDef warning fill:#fff9c4,stroke:#f57f17,stroke-width:3px

    class Start,Save user
    class Hook,Pattern hook
    class Agent,Tech agent
    class SubReact,SubVue,SubAngular subagent
    class RAG,Checks,C1,C2,C3,Status check
    class Pass success
    class Warn warning
