%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#e8f5e9','primaryTextColor':'#1b5e20','primaryBorderColor':'#4caf50','lineColor':'#4caf50','secondaryColor':'#fff3e0','tertiaryColor':'#e3f2fd'}}}%%
graph LR
    User["ğŸ‘¤ User Request:<br/>'Add user authentication'"] --> Step1

    Step1["<b>STEP 1: PLAN</b><br/>ğŸ“‹ Alex-BA<br/>â”â”â”â”â”â”â”â”<br/>â€¢ Extract requirements<br/>â€¢ Search RAG for similar features<br/>â€¢ Define API contract<br/>â€¢ Load auth-system template<br/>â±ï¸ 30 minutes"]

    Step2["<b>STEP 2: ASSESS</b><br/>âœ… Sarah-PM<br/>â”â”â”â”â”â”â”â”<br/>â€¢ Framework health â‰¥ 80%<br/>â€¢ Git status clean<br/>â€¢ Dependencies installed<br/>â€¢ Database connected<br/>â±ï¸ 5 minutes"]

    Step3["<b>STEP 3: WORK</b><br/>ğŸš€ Three-Tier Parallel<br/>â”â”â”â”â”â”â”â”"]

    subgraph Parallel["Parallel Execution (60 min max)"]
        Dana["ğŸ—„ï¸ <b>Dana-Database</b><br/>â€¢ Users table<br/>â€¢ Sessions table<br/>â€¢ RLS policies<br/>â±ï¸ 45 min"]
        Marcus["âš™ï¸ <b>Marcus-Backend</b><br/>â€¢ /auth/signup<br/>â€¢ /auth/login<br/>â€¢ JWT tokens<br/>â±ï¸ 60 min"]
        James["ğŸ¨ <b>James-Frontend</b><br/>â€¢ LoginForm<br/>â€¢ AuthProvider<br/>â€¢ Validation<br/>â±ï¸ 50 min"]
    end

    Step4["<b>STEP 4: CODIFY</b><br/>ğŸ’¾ RAG Update<br/>â”â”â”â”â”â”â”â”<br/>â€¢ Extract auth patterns<br/>â€¢ Store JWT examples<br/>â€¢ Update effort estimates<br/>â€¢ Document lessons<br/>â±ï¸ 10 minutes"]

    Quality["ğŸ§ª <b>Maria-QA</b><br/>â”â”â”â”â”â”â”â”<br/>â€¢ Unit tests<br/>â€¢ Integration tests<br/>â€¢ Security scan<br/>â€¢ 80%+ coverage<br/>â±ï¸ 20 minutes"]

    Result[["âœ… <b>Feature Complete</b><br/>Total: 125 minutes<br/>(vs 220 sequential)<br/>â”â”â”â”â”â”â”â”<br/>Next similar feature:<br/><b>40% faster!</b>"]]

    Step1 --> Step2
    Step2 --> Step3
    Step3 --> Dana
    Step3 --> Marcus
    Step3 --> James
    Dana --> Quality
    Marcus --> Quality
    James --> Quality
    Quality --> Step4
    Step4 --> Result

    classDef user fill:#e0e0e0,stroke:#616161,stroke-width:2px,color:#000
    classDef plan fill:#e3f2fd,stroke:#2196f3,stroke-width:3px,color:#000
    classDef assess fill:#fff3e0,stroke:#ff9800,stroke-width:3px,color:#000
    classDef work fill:#e8f5e9,stroke:#4caf50,stroke-width:3px,color:#000
    classDef agent fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px,color:#000
    classDef quality fill:#ffccbc,stroke:#ff5722,stroke-width:2px,color:#000
    classDef codify fill:#fce4ec,stroke:#e91e63,stroke-width:3px,color:#000
    classDef result fill:#c8e6c9,stroke:#2e7d32,stroke-width:4px,color:#000

    class User user
    class Step1 plan
    class Step2 assess
    class Step3 work
    class Dana,Marcus,James agent
    class Quality quality
    class Step4 codify
    class Result result
